"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[604],{5835:function(e,t,a){t.W=function(e,t,a=()=>{}){let r=new TextDecoder("utf8"),n=0,i=0;for(;n<e.length;){let l=e.indexOf(10,n),u=-1===l?e.length:l,c=e.subarray(n,u),o=r.decode(c).trim();if(o&&!1===t(o,i))break;i++%1e4==0&&a(`Loading ${(0,s.getProgressDisplayStr)(n,e.length)}`),n=u+1}};let s=a(42382)},40604:function(e,t,a){a.r(t),a.d(t,{default:function(){return h}});var s=a(29707),r=a(50611),n=a(77207),i=a(42382),l=a(61795),u=a(52427),c=a(80883),o=a(5835);class p extends n.BaseFeatureDataAdapter{constructor(){super(...arguments),this.calculatedIntervalTreeMap={}}async getHeader(){let{header:e}=await this.setup();return e}async getMetadata(){let{parser:e}=await this.setup();return e.getMetadata()}async setupP(e){let{statusCallback:t=()=>{}}=e||{},a=(0,l.openLocation)(this.getConf("vcfLocation"),this.pluginManager),{header:n,featureMap:u}=function(e,t=()=>{}){let a=[],s={};return(0,o.W)(e,e=>{if(e.startsWith("#"))a.push(e);else{let t=e.indexOf("	"),a=e.slice(0,t);s[a]||(s[a]=[]),s[a].push(e)}return!0},t),{header:a.join("\n"),featureMap:s}}(await (0,i.fetchAndMaybeUnzip)(a,e),t),p=new r.Z({header:n}),h=Object.fromEntries(Object.entries(u).map(([e,t])=>[e,a=>{if(!this.calculatedIntervalTreeMap[e]){null==a||a("Parsing VCF data");let r=0,n=new s.ZP;for(let a of t){let t=new c.Z({variant:p.parseLine(a),parser:p,id:`${this.id}-${e}-${r++}`});n.insert([t.get("start"),t.get("end")],t)}this.calculatedIntervalTreeMap[e]=n}return this.calculatedIntervalTreeMap[e]}]));return{header:n,parser:p,intervalTreeMap:h}}async setup(){return this.vcfFeatures||(this.vcfFeatures=this.setupP().catch(e=>{throw this.vcfFeatures=void 0,e})),this.vcfFeatures}async getRefNames(e={}){let{intervalTreeMap:t}=await this.setup();return Object.keys(t)}getFeatures(e,t={}){return(0,u.ObservableCreate)(async a=>{var s;try{let{start:r,end:n,refName:i}=e,{intervalTreeMap:l}=await this.setup();for(let e of(null===(s=l[i])||void 0===s?void 0:s.call(l,t.statusCallback).search([r,n]))||[])a.next(e);a.complete()}catch(e){a.error(e)}},t.stopToken)}async getSources(){let e=this.getConf("samplesTsvLocation");if(""===e.uri||"/path/to/samples.tsv"===e.uri){let{parser:e}=await this.setup();return e.samples.map(e=>({name:e}))}{let t=(await (0,l.openLocation)(e).readFile("utf8")).split(/\n|\r\n|\r/),a=t[0].split("	"),{parser:s}=await this.setup(),r=new Set(s.samples);return t.slice(1).map(e=>{let t=e.split("	");return{name:t[0],...Object.fromEntries(t.slice(1).map((e,t)=>[a[t+1],e]))}}).filter(e=>r.has(e.name))}}}p.capabilities=["getFeatures","getRefNames"];var h=p}}]);