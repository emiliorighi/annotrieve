"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3470],{5835:function(e,t,a){t.W=function(e,t,a=()=>{}){let s=new TextDecoder("utf8"),l=0,i=0;for(;l<e.length;){let n=e.indexOf(10,l),o=-1===n?e.length:n,u=e.subarray(l,o),h=s.decode(u).trim();if(h&&!1===t(h,i))break;i++%1e4==0&&a(`Loading ${(0,r.getProgressDisplayStr)(l,e.length)}`),l=o+1}};let r=a(42382)},53470:function(e,t,a){a.r(t),a.d(t,{default:function(){return u}});var r=a(29707),s=a(77207),l=a(42382),i=a(61795),n=a(5835),o=a(52427);class u extends s.BaseFeatureDataAdapter{constructor(){super(...arguments),this.intervalTrees={}}async getNames(){let{header:e,columnNames:t}=await this.loadData();if(t.length)return t;let a=e.split(/\n|\r\n|\r/).filter(e=>!!e).at(-1);return(null==a?void 0:a.includes("	"))?a.slice(1).split("	").map(e=>e.trim()):void 0}async loadFeatureIntervalTreeHelper(e){var t;let{features:a}=await this.loadData(),s=a[e];if(!s)return;let i=(null===(t=await this.getNames())||void 0===t?void 0:t.slice(3))||[],n=new r.ZP;for(let e=0;e<s.length;e++){let[t,a,r,...o]=s[e].split("	");for(let s=0;s<o.length;s++){let u=`${this.id}-${t}-${e}-${s}`,h=+a,d=+r,c=+o[s],f=i[s]||`col${s}`;c&&n.insert([h,d],new l.SimpleFeature({id:u,data:{refName:t,start:h,end:d,score:c,source:f}}))}}return n}async getRefNames(e={}){let{features:t}=await this.loadData(e);return Object.keys(t)}async loadDataP(e={}){let t=this.pluginManager,a=this.getConf("bedGraphLocation"),r=await (0,l.fetchAndMaybeUnzip)((0,i.openLocation)(a,t),e),s={},o=[];(0,n.W)(r,e=>{if(e.startsWith("#"))o.push(e);else{let t=e.indexOf("	"),a=e.slice(0,t);s[a]||(s[a]=[]),s[a].push(e)}return!0},e.statusCallback);let u=this.getConf("columnNames");return{header:o.join("\n"),features:s,columnNames:u}}async loadFeatureIntervalTree(e){return this.intervalTrees[e]||(this.intervalTrees[e]=this.loadFeatureIntervalTreeHelper(e).catch(t=>{throw this.intervalTrees[e]=void 0,t})),this.intervalTrees[e]}async loadData(e={}){return this.bedFeatures||(this.bedFeatures=this.loadDataP(e).catch(e=>{throw this.bedFeatures=void 0,e})),this.bedFeatures}getFeatures(e,t={}){return(0,o.ObservableCreate)(async t=>{let{start:a,end:r,refName:s}=e,l=await this.loadFeatureIntervalTree(s);for(let e of(null==l?void 0:l.search([a,r]))||[])t.next(e);t.complete()})}}}}]);