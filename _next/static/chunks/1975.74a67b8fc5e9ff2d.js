"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1975],{31975:function(e,t,r){r.r(t),r.d(t,{default:function(){return u}});class i{ixxFile;ixFile;maxResults;constructor(e,t,r=20){this.ixxFile=e,this.ixFile=t,this.maxResults=r}async search(e,t){let r=[],i=e.split(" ")[0].toLowerCase(),n=await this._getBuffer(i,t);if(!n)return[];let{end:l,buffer:s}=n,a=!1,o=new TextDecoder("utf8");for(;!a;){let e=!1,n=o.decode(s),c=n.slice(0,n.lastIndexOf("\n")).split("\n").filter(e=>!!e),u=[];for(let t of c){let r=t.split(" ")[0],n=r.startsWith(i);!e&&n&&(e=!0),r.slice(0,i.length)>i&&(a=!0),n&&u.push(t)}let f=u.flatMap(e=>{let[t,...r]=e.split(" ");return r.map(e=>[t,e.split(",")[0]])});if(r.length+f.length<this.maxResults&&!a){let e=await this.ixFile.read(65536,l,t);if(0===e.length){r=r.concat(f);break}s=function(e){let t=new Uint8Array(function(e){let t=0;for(let r of e)t+=r.length;return t}(e)),r=0;for(let i of e)t.set(i,r),r+=i.length;return t}([s,e]),l+=65536}else if(r.length+f.length>=this.maxResults||a){r=r.concat(f);break}}return(function(e,t=JSON.stringify){let r=[],i=new Set;for(let n of e){let e=t(n);i.has(e)||(r.push(n),i.add(e))}return r})(r,e=>e[1]).slice(0,this.maxResults)}async getIndex(e){return(await this.ixxFile.readFile({encoding:"utf8",...e})).split("\n").filter(e=>!!e).map(e=>{let t=e.length-10;return[e.slice(0,t),Number.parseInt(e.slice(t),16)]})}async _getBuffer(e,t){let r=0,i=65536;for(let[n,l]of(await this.getIndex(t)))n.slice(0,e.length)<e&&(r=l,i=l+65536);let n=i-r;if(!(n<0))return{buffer:await this.ixFile.read(n,r,t),end:i}}}var n=r(25932),l=r(87290),s=r(77207),a=r(61795);function o(e){try{return decodeURIComponent(e)}catch(t){return e}}function c(e,t,r=15){let i=e.toLowerCase().indexOf(t);return e.length<40?e:(Math.max(0,i-r)>0?"...":"")+e.slice(Math.max(0,i-r),i+t.length+r).trim()+(i+t.length<e.length?"...":"")}class u extends s.BaseAdapter{constructor(e,t,r){super(e,t,r);let n=(0,l.readConfObject)(e,"ixFilePath"),s=(0,l.readConfObject)(e,"ixxFilePath");if(!n)throw Error("must provide out.ix");if(!s)throw Error("must provide out.ixx");this.trixJs=new i((0,a.openLocation)(s,r),(0,a.openLocation)(n,r),1500)}async searchIndex(e){let t=e.queryString.toLowerCase(),r=t.split(" "),i=(await this.trixJs.search(t)).filter(([,e])=>r.every(t=>o(e).toLowerCase().includes(t))).map(([e,t])=>{let r=JSON.parse(t.replaceAll("|",",")),[i,l,...s]=r.map(e=>o(e)),a=s.findIndex(e=>!!e),u=s.map(e=>e.toLowerCase()).findIndex(t=>t.includes(e.toLowerCase())),f=s[a],h=s[u],x=-1!==u?c(h,e):void 0,d=c(f,e),p=x&&d.toLowerCase()!==x.toLowerCase()?`${d} (${x})`:d;return new n.ZP({locString:i,label:f,displayString:p,matchedObject:r.map(e=>decodeURIComponent(e)),trackId:l})});return"exact"===e.searchType?i.filter(t=>t.getLabel().toLowerCase()===e.queryString.toLowerCase()):i}}}}]);