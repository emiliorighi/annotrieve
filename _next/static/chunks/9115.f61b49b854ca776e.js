"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9115],{93900:function(e,t,r){r.d(t,{Z:function(){return s}});class i{}class a{constructor(){this.signals=new Set,this.abortController=new AbortController}addSignal(e=new i){if(this.signal.aborted)throw Error("cannot add a signal, already aborted!");this.signals.add(e),e.aborted?this.handleAborted(e):"function"==typeof e.addEventListener&&e.addEventListener("abort",()=>{this.handleAborted(e)})}handleAborted(e){this.signals.delete(e),0===this.signals.size&&this.abortController.abort()}get signal(){return this.abortController.signal}abort(){this.abortController.abort()}}class n{constructor(){this.callbacks=new Set}addCallback(e=()=>{}){this.callbacks.add(e),this.currentMessage&&e(this.currentMessage)}callback(e){for(let t of(this.currentMessage=e,this.callbacks))t(e)}}class s{constructor({fill:e,cache:t}){if("function"!=typeof e)throw TypeError("must pass a fill function");if("object"!=typeof t)throw TypeError("must pass a cache object");if("function"!=typeof t.get||"function"!=typeof t.set||"function"!=typeof t.delete)throw TypeError("cache must implement get(key), set(key, val), and and delete(key)");this.cache=t,this.fillCallback=e}static isAbortException(e){return"AbortError"===e.name||"ERR_ABORTED"===e.code||"AbortError: aborted"===e.message||"Error: aborted"===e.message}evict(e,t){this.cache.get(e)===t&&this.cache.delete(e)}fill(e,t,r,i){let s=new a,l=new n;l.addCallback(i);let o={aborter:s,promise:this.fillCallback(t,s.signal,e=>{l.callback(e)}),settled:!1,statusReporter:l,get aborted(){return this.aborter.signal.aborted}};o.aborter.addSignal(r),o.aborter.signal.addEventListener("abort",()=>{o.settled||this.evict(e,o)}),o.promise.then(()=>{o.settled=!0},()=>{o.settled=!0,this.evict(e,o)}).catch(e=>{throw console.error(e),e}),this.cache.set(e,o)}static checkSinglePromise(e,t){function r(){if(t?.aborted)throw Object.assign(Error("aborted"),{code:"ERR_ABORTED"})}return e.then(e=>(r(),e),e=>{throw r(),e})}has(e){return this.cache.has(e)}get(e,t,r,i){if(!r&&t instanceof AbortSignal)throw TypeError("second get argument appears to be an AbortSignal, perhaps you meant to pass `null` for the fill data?");let a=this.cache.get(e);return a?a.aborted&&!a.settled?(this.evict(e,a),this.get(e,t,r,i)):a.settled?a.promise:(a.aborter.addSignal(r),a.statusReporter.addCallback(i),s.checkSinglePromise(a.promise,r)):(this.fill(e,t,r,i),s.checkSinglePromise(this.cache.get(e).promise,r))}delete(e){let t=this.cache.get(e);t&&(t.settled||t.aborter.abort(),this.cache.delete(e))}clear(){let e=this.cache.keys(),t=0;for(let r=e.next();!r.done;r=e.next())this.delete(r.value),t+=1;return t}}},99115:function(e,t,r){r.d(t,{Q:function(){return E},B:function(){return p}});let i=BigInt(32);"getBigInt64"in DataView||(DataView.prototype.getBigInt64=function(e,t){return function(e,t,r){let a=Number(!!r),n=Number(!r);return BigInt(e.getInt32(t,r)*n+e.getInt32(t+4,r)*a)<<i|BigInt(e.getUint32(t,r)*a+e.getUint32(t+4,r)*n)}(this,e,t)}),"getBigUint64"in DataView||(DataView.prototype.getBigUint64=function(e,t){return function(e,t,r){let a=e.getUint32(t,r),n=e.getUint32(t+4,r),s=Number(!!r),l=Number(!r);return BigInt(a*l+n*s)<<i|BigInt(a*s+n*l)}(this,e,t)});var a=r(9762),n=r(3549),s=r(86553),l=r(47358),o=r(15097),c=r(93900),h=r(51936);class g{constructor(e){this.ranges=e}get min(){return this.ranges[0].min}get max(){return this.ranges.at(-1).max}contains(e){for(let t of this.ranges)if(t.min<=e&&t.max>=e)return!0;return!1}isContiguous(){return this.ranges.length>1}getRanges(){return this.ranges.map(e=>new g([{min:e.min,max:e.max}]))}toString(){return this.ranges.map(e=>`[${e.min}-${e.max}]`).join(",")}union(e){let t=[...this.getRanges(),...e.getRanges()].sort((e,t)=>e.min<t.min?-1:e.min>t.min?1:e.max<t.max?-1:t.max>e.max?1:0),r=[],i=t[0];for(let e of t)e.min>i.max+1?(r.push(i),i=e):e.max>i.max&&(i=new g([{min:i.min,max:e.max}]));return r.push(i),1===r.length?r[0]:new g(r)}}var f=r(44580);class u extends Error{constructor(e){super(e),this.code="ERR_ABORTED"}}function d(e){if(e&&e.aborted){if("undefined"==typeof DOMException){let e=new u("aborted");throw e.code="ERR_ABORTED",e}throw new DOMException("aborted","AbortError")}}let b="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;class m{constructor(e,t,r,i,a){if(this.bbi=e,this.refsByName=t,this.cirTreeOffset=r,this.isCompressed=i,this.blockType=a,this.featureCache=new c.Z({cache:new h({maxSize:1e3}),fill:async({length:e,offset:t},r)=>this.bbi.read(e,t,{signal:r})}),!(r>=0))throw Error("invalid cirTreeOffset!")}async readWigData(e,t,r,i,a){try{let n=this.refsByName[e];void 0===n&&i.complete();let s={chrId:n,start:t,end:r};this.cirTreePromise||(this.cirTreePromise=this.bbi.read(48,this.cirTreeOffset,a));let l=await this.cirTreePromise,o=new DataView(l.buffer).getUint32(4,!0),c=[],h=0,f=(e,t,r)=>{try{let i=e.subarray(t),a=new DataView(i.buffer,i.byteOffset,i.length),n=0,s=a.getUint8(n);n+=2;let l=a.getUint16(n,!0);if(n+=2,1===s){let e=[];for(let t=0;t<l;t++){let t=a.getUint32(n,!0);n+=4;let r=a.getUint32(n,!0);n+=4;let i=a.getUint32(n,!0);n+=4;let s=a.getUint32(n,!0);n+=4;let l=Number(a.getBigUint64(n,!0));n+=8;let o=Number(a.getBigUint64(n,!0));n+=8,e.push({startChrom:t,startBase:r,endBase:s,endChrom:i,blockOffset:l,blockSize:o,offset:n})}c=c.concat(e.filter(e=>u(e)).map(e=>({offset:e.blockOffset,length:e.blockSize})))}else if(0===s){let e=[];for(let t=0;t<l;t++){let t=a.getUint32(n,!0);n+=4;let r=a.getUint32(n,!0);n+=4;let i=a.getUint32(n,!0);n+=4;let s=a.getUint32(n,!0);n+=4;let l=Number(a.getBigUint64(n,!0));n+=8,e.push({startChrom:t,startBase:r,endChrom:i,endBase:s,blockOffset:l,offset:n})}let t=e.filter(e=>u(e)).map(e=>e.blockOffset);t.length>0&&b(t,r+1)}}catch(e){i.error(e)}},u=e=>{let{startChrom:i,startBase:a,endChrom:s,endBase:l}=e;return(i<n||i===n&&a<=r)&&(s>n||s===n&&l>=t)},d=async(e,t,r)=>{try{let n=t.max-t.min,l=t.min,o=await this.featureCache.get(`${n}_${l}`,{length:n,offset:l},a?.signal);for(let n of e)t.contains(n)&&(f(o,n-l,r),h-=1,0===h&&this.readFeatures(i,c,{...a,request:s}).catch(e=>{i.error(e)}))}catch(e){i.error(e)}},b=(e,t)=>{try{h+=e.length;let r=4+32*o,i=new g([{min:e[0],max:e[0]+r}]);for(let t=1;t<e.length;t+=1){let a=new g([{min:e[t],max:e[t]+r}]);i=i.union(a)}i.getRanges().map(r=>d(e,r,t))}catch(e){i.error(e)}};b([Number(this.cirTreeOffset)+48],1);return}catch(e){i.error(e)}}parseSummaryBlock(e,t,r){let i=[],a=t,n=new DataView(e.buffer,e.byteOffset,e.length);for(;a<e.byteLength;){var s;let e=n.getUint32(a,!0);a+=4;let t=n.getUint32(a,!0);a+=4;let l=n.getUint32(a,!0);a+=4;let o=n.getUint32(a,!0);a+=4;let c=n.getFloat32(a,!0);a+=4;let h=n.getFloat32(a,!0);a+=4;let g=n.getFloat32(a,!0);a+=8,(!r||e===r.chrId&&(s=r.start,t<r.end&&l>=s))&&i.push({start:t,end:l,maxScore:h,minScore:c,summary:!0,score:g/(o||1)})}return i}parseBigBedBlock(e,t,r,i){let a=[],n=t,s=new DataView(e.buffer,e.byteOffset,e.length);for(;n<e.byteLength;){let t=n,i=s.getUint32(n,!0);n+=4;let l=s.getInt32(n,!0);n+=4;let o=s.getInt32(n,!0),c=n+=4;for(;c<e.length&&0!==e[c];c++);let h=e.subarray(n,c),g=b?.decode(h)??h.toString();n=c+1,a.push({chromId:i,start:l,end:o,rest:g,uniqueId:`bb-${r+t}`})}return i?a.filter(e=>{var t,r,a;return t=e.start,r=e.end,a=i.start,t<i.end&&r>=a}):a}parseBigWigBlock(e,t,r){let i;let a=e.subarray(t),n=new DataView(a.buffer,a.byteOffset,a.length);i=4;let s=n.getInt32(i,!0);i+=8;let l=n.getUint32(i,!0);i+=4;let o=n.getUint32(i,!0);i+=4;let c=n.getUint8(i);i+=2;let h=n.getUint16(i,!0);i+=2;let g=Array(h);switch(c){case 1:for(let e=0;e<h;e++){let t=n.getInt32(i,!0);i+=4;let r=n.getInt32(i,!0);i+=4;let a=n.getFloat32(i,!0);i+=4,g[e]={start:t,end:r,score:a}}break;case 2:for(let e=0;e<h;e++){let t=n.getInt32(i,!0);i+=4;let r=n.getFloat32(i,!0);i+=4,g[e]={score:r,start:t,end:t+o}}break;case 3:for(let e=0;e<h;e++){let t=n.getFloat32(i,!0);i+=4;let r=s+e*l;g[e]={score:t,start:r,end:r+o}}}return r?g.filter(e=>{var t,i,a;return t=e.start,i=e.end,a=r.start,t<r.end&&i>=a}):g}async readFeatures(e,t,r={}){try{let{blockType:i,isCompressed:a}=this,{signal:n,request:s}=r,l=function(e){let t,r;e.sort((e,t)=>e.offset-t.offset);let i=[];for(let a of e)t&&r&&a.offset-r<=2e3?(t.length=t.length+a.length-r+a.offset,t.blocks.push(a)):i.push(t={blocks:[a],length:a.length,offset:a.offset}),r=t.offset+t.length;return i}(t);d(n),await Promise.all(l.map(async t=>{d(n);let{length:r,offset:l}=t,o=await this.featureCache.get(`${r}_${l}`,t,n);for(let r of t.blocks){d(n);let l=o.subarray(Number(r.offset)-Number(t.offset));if(a){var c;c=l,l=(0,f.Hq)(c.subarray(2))}switch(d(n),i){case"summary":e.next(this.parseSummaryBlock(l,0,s));break;case"bigwig":e.next(this.parseBigWigBlock(l,0,s));break;case"bigbed":e.next(this.parseBigBedBlock(l,0,256*Number(r.offset),s));break;default:console.warn(`Don't know what to do with ${i}`)}}})),e.complete()}catch(t){e.error(t)}}}function w(e){return new DataView(e.buffer,e.byteOffset,e.length)}class y{getHeader(e){return this.headerP||(this.headerP=this._getHeader(e).catch(e=>{throw this.headerP=void 0,e})),this.headerP}constructor(e){let{filehandle:t,renameRefSeqs:r=e=>e,path:i,url:s}=e;if(this.renameRefSeqs=r,t)this.bbi=t;else if(s)this.bbi=new a.Z(s);else if(i)this.bbi=new n.S9(i);else throw Error("no file given")}async _getHeader(e){let t=await this._getMainHeader(e),r=await this._readChromTree(t,e);return{...t,...r}}async _getMainHeader(e,t=2e3){let r;let i=await this.bbi.read(t,0,e),a=w(i),n=a.getInt32(0,!0);if(-2003829722!==n&&-2021002517!==n)throw Error("not a BigWig/BigBed file");let s=0,l=a.getInt32(s,!0);s+=4;let o=a.getUint16(s,!0);s+=2;let c=a.getUint16(s,!0);s+=2;let h=Number(a.getBigUint64(s,!0));s+=8;let g=Number(a.getBigUint64(s,!0));s+=8;let f=Number(a.getBigUint64(s,!0));s+=8;let u=a.getUint16(s,!0);s+=2;let d=a.getUint16(s,!0);s+=2;let b=Number(a.getBigUint64(s,!0));s+=8;let m=Number(a.getBigUint64(s,!0));s+=8;let y=a.getUint32(s,!0);s+=4;let p=Number(a.getBigUint64(s,!0));s+=8;let U=[];for(let e=0;e<c;e++){let e=a.getUint32(s,!0);s+=4;let t=a.getUint32(s,!0);s+=4;let r=Number(a.getBigUint64(s,!0));s+=8;let i=Number(a.getBigUint64(s,!0));s+=8,U.push({reductionLevel:e,reserved:t,dataOffset:r,indexOffset:i})}if(b>t||m>t-40)return this._getMainHeader(e,2*t);if(m){let e=i.subarray(Number(m)),t=0,a=w(e),n=Number(a.getBigUint64(t,!0));t+=8;let s=a.getFloat64(t,!0);t+=8;let l=a.getFloat64(t,!0);t+=8;let o=a.getFloat64(t,!0);t+=8;let c=a.getFloat64(t,!0);t+=8,r={scoreMin:s,scoreMax:l,scoreSum:o,scoreSumSquares:c,basesCovered:n}}else throw Error("no stats");let B=new TextDecoder("utf8");return{zoomLevels:U,magic:l,extHeaderOffset:p,numZoomLevels:c,fieldCount:u,totalSummary:r,definedFieldCount:d,uncompressBufSize:y,asOffset:b,chromTreeOffset:h,totalSummaryOffset:m,unzoomedDataOffset:g,unzoomedIndexOffset:f,fileType:-2021002517===l?"bigbed":"bigwig",version:o,autoSql:b?B.decode(i.subarray(b,i.indexOf(0,b))):""}}async _readChromTree(e,t){let r;let i=[],a={},n=Number(e.chromTreeOffset),s=w(await this.bbi.read(32,n,t));r=8;let l=s.getUint32(r,!0);r+=4;let o=s.getUint32(r,!0);r+=12;let c=new TextDecoder("utf8"),h=async e=>{let t=w(await this.bbi.read(4,e)),r=0,n=t.getUint8(r);r+=2;let s=t.getUint16(r,!0);if(r+=2,n){let t=await this.bbi.read(s*(l+o),e+r),n=w(t);r=0;for(let e=0;e<s;e++){let e=c.decode(t.subarray(r,r+l)).replaceAll("\0","");r+=l;let s=n.getUint32(r,!0);r+=4;let o=n.getUint32(r,!0);r+=4,a[this.renameRefSeqs(e)]=s,i[s]={name:e,id:s,length:o}}}else{let t=[],i=w(await this.bbi.read(s*(l+8),e+r));r=0;for(let e=0;e<s;e++){r+=l;let e=Number(i.getBigUint64(r,!0));r+=8,t.push(h(e))}await Promise.all(t)}};return await h(n+32),{refsByName:a,refsByNumber:i}}async getUnzoomedView(e){let{unzoomedIndexOffset:t,refsByName:r,uncompressBufSize:i,fileType:a}=await this.getHeader(e);return new m(this.bbi,r,t,i>0,a)}async getFeatureStream(e,t,r,i){let a;await this.getHeader(i);let n=this.renameRefSeqs(e),{basesPerSpan:l,scale:o}=i||{};return a=l?await this.getView(1/l,i):o?await this.getView(o,i):await this.getView(1,i),new s.y(e=>{a.readWigData(n,t,r,e,i).catch(t=>{e.error(t)})})}async getFeatures(e,t,r,i){let a=await this.getFeatureStream(e,t,r,i);return(await (0,l.z)(a.pipe((0,o.q)()))).flat()}}class p extends y{async getView(e,t){let{zoomLevels:r,refsByName:i,uncompressBufSize:a}=await this.getHeader(t),n=1/e,s=r.length-1;for(let e=s;e>=0;e-=1){let t=r[e];if(t&&t.reductionLevel<=2*n)return new m(this.bbi,i,t.indexOffset,a>0,"summary")}return this.getUnzoomedView(t)}}var U=r(94953),B=r(48022),x=r(7449);class E extends y{constructor(){super(...arguments),this.readIndicesCache=new c.Z({cache:new h({maxSize:1}),fill:(e,t)=>this._readIndices({...e,signal:t})})}readIndices(e={}){let{signal:t,...r}=e;return this.readIndicesCache.get(JSON.stringify(r),e,t)}async getView(e,t){return this.getUnzoomedView(t)}async _readIndices(e){let t;let{extHeaderOffset:r}=await this.getHeader(e),i=await this.bbi.read(64,Number(r)),a=new DataView(i.buffer,i.byteOffset,i.length);t=2;let n=a.getUint16(t,!0);t+=2;let s=Number(a.getBigUint64(t,!0));if(t+=8,0===n)return[];let l=await this.bbi.read(20*n,Number(s)),o=[];for(let e=0;e<n;e+=1){let t=l.subarray(20*e),r=new DataView(t.buffer,t.byteOffset,t.length),i=0,a=r.getInt16(i,!0);i+=2;let n=r.getInt16(i,!0);i+=2;let s=Number(r.getBigUint64(i,!0));i+=12;let c=r.getInt16(i,!0);o.push({type:a,fieldcount:n,offset:Number(s),field:c})}return o}async searchExtraIndexBlocks(e,t={}){let r=await this.readIndices(t);if(0===r.length)return[];let i=new TextDecoder("utf8"),a=r.map(async r=>{let a;let{offset:n,field:s}=r,l=await this.bbi.read(32,n,t),o=new DataView(l.buffer,l.byteOffset,l.length);a=4;let c=o.getInt32(a,!0);a+=4;let h=o.getInt32(a,!0);a+=4;let g=o.getInt32(a,!0);a+=12;let f=async r=>{let a=Number(r),n=await this.bbi.read(4+c*(h+g),a,t),l=new DataView(n.buffer,n.byteOffset,n.length),o=0,u=l.getInt8(o);o+=2;let d=l.getInt16(o,!0);o+=2;let b=[];if(0===u){let t=[];for(let e=0;e<d;e++){let e=i.decode(n.subarray(o,o+h)).replaceAll("\0","");o+=h;let r=Number(l.getBigUint64(o,!0));o+=8,t.push({key:e,offset:r})}let r=0;for(let{key:i,offset:a}of t){if(0>e.localeCompare(i)&&r)break;r=a}return f(r)}if(1===u){for(let e=0;e<d;e++){let e=i.decode(n.subarray(o,o+h)).replaceAll("\0","");o+=h;let t=Number(l.getBigUint64(o,!0));o+=8;let r=l.getUint32(o,!0);o+=4;let a=l.getUint32(o,!0);o+=4,b.push({key:e,offset:t,length:r,reserved:a})}for(let t of b)if(t.key===e)return{...t,field:s};return}};return f(n+32)});return(await Promise.all(a)).filter(e=>!!e)}async searchExtraIndex(e,t={}){let r=await this.searchExtraIndexBlocks(e,t);if(0===r.length)return[];let i=await this.getUnzoomedView(t),a=r.map(e=>new s.y(r=>{i.readFeatures(r,[e],t).catch(e=>{r.error(e)})}).pipe((0,B.u)((e,t)=>e.concat(t)),(0,x.U)(t=>{for(let r of t)r.field=e.field;return t})));return(await (0,l.z)((0,U.T)(...a))).filter(t=>t.rest?.split("	")[(t.field||0)-3]===e)}}},3549:function(e,t,r){r.d(t,{S9:function(){return i}});class i{readFile(){throw Error("unimplemented")}read(){throw Error("unimplemented")}close(){throw Error("unimplemented")}}},9762:function(e,t,r){function i(e){return("object"==typeof e&&null!==e&&"message"in e?e.message:`${e}`).replace(/\.$/,"")}r.d(t,{Z:function(){return a}});class a{constructor(e,t={}){this.baseOverrides={},this.url=e;let r=t.fetch||globalThis.fetch.bind(globalThis);t.overrides&&(this.baseOverrides=t.overrides),this.fetchImplementation=r}async fetch(e,t){let r;try{r=await this.fetchImplementation(e,t)}catch(a){if(`${a}`.includes("Failed to fetch")){console.warn(`generic-filehandle: refetching ${e} to attempt to work around chrome CORS header caching bug`);try{r=await this.fetchImplementation(e,{...t,cache:"reload"})}catch(t){throw Error(`${i(t)} fetching ${e}`,{cause:t})}}else throw Error(`${i(a)} fetching ${e}`,{cause:a})}return r}async read(e,t,r={}){let{headers:i={},signal:a,overrides:n={}}=r;e<1/0?i.range=`bytes=${t}-${t+e}`:e===1/0&&0!==t&&(i.range=`bytes=${t}-`);let s=await this.fetch(this.url,{...this.baseOverrides,...n,headers:{...i,...n.headers,...this.baseOverrides.headers},method:"GET",redirect:"follow",mode:"cors",signal:a});if(!s.ok)throw Error(`HTTP ${s.status} fetching ${this.url}`);if(200===s.status&&0===t||206===s.status){let t=await s.arrayBuffer(),r=s.headers.get("content-range"),i=/\/(\d+)$/.exec(r||"");return i?.[1]&&(this._stat={size:parseInt(i[1],10)}),new Uint8Array(t.slice(0,e))}if(200===s.status)throw Error(`${this.url} fetch returned status 200, expected 206`);throw Error(`HTTP ${s.status} fetching ${this.url}`)}async readFile(e={}){let t,r;"string"==typeof e?(t=e,r={}):(t=e.encoding,r=e,delete r.encoding);let{headers:i={},signal:a,overrides:n={}}=r,s=await this.fetch(this.url,{headers:i,method:"GET",redirect:"follow",mode:"cors",signal:a,...this.baseOverrides,...n});if(200!==s.status)throw Error(`HTTP ${s.status} fetching ${this.url}`);if("utf8"===t)return s.text();if(!t)return new Uint8Array(await s.arrayBuffer());throw Error(`unsupported encoding: ${t}`)}async stat(){if(!this._stat&&(await this.read(10,0),!this._stat))throw Error(`unable to determine size of file at ${this.url}`);return this._stat}async close(){}}}}]);