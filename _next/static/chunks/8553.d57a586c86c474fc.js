"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8553],{8553:function(e,t,a){a.r(t),a.d(t,{default:function(){return c}});var i=a(19814),n=a(77207),r=a(42382),s=a(61795),o=a(52427);class c extends n.BaseFeatureDataAdapter{async configurePre(){let e=this.pluginManager,t=this.getConf("bedGraphGzLocation"),a=this.getConf(["index","location"]),n=this.getConf(["index","indexType"]),r=(0,s.openLocation)(t,e),o="CSI"===n,c=new i.pC({filehandle:r,csiFilehandle:o?(0,s.openLocation)(a,e):void 0,tbiFilehandle:o?void 0:(0,s.openLocation)(a,e),chunkCacheSize:52428800}),l=this.getConf("columnNames"),u=await c.getHeader();return{columnNames:l,bedGraph:c,header:u}}async configure(){return this.configured||(this.configured=this.configurePre().catch(e=>{throw this.configured=void 0,e})),this.configured}async getNames(){let{bedGraph:e,columnNames:t}=await this.configure();if(t.length)return t;let a=(await e.getHeader()).split(/\n|\r\n|\r/).filter(e=>!!e).at(-1);return(null==a?void 0:a.includes("	"))?a.slice(1).split("	").map(e=>e.trim()):void 0}async getRefNames(e={}){let{bedGraph:t}=await this.configure();return t.getReferenceSequenceNames(e)}async getHeader(){let{bedGraph:e}=await this.configure();return e.getHeader()}getFeatures(e,t={}){return(0,o.ObservableCreate)(async a=>{var i;let{bedGraph:n}=await this.configure(),{columnNumbers:s}=await n.getMetadata(),o=s.ref-1,c=s.start-1,l=s.end-1,u=c===l,d=(null===(i=await this.getNames())||void 0===i?void 0:i.slice(u?2:3))||[];await n.getLines(e.refName,e.start+(u?-1:0),e.end,{lineCallback:(e,t)=>{let i=e.split("	"),n=i[o],s=+i[c],h=+(u?s+1:i[l]),g=i.slice(l+1);if(Number.isNaN(s)||Number.isNaN(h))throw Error(`start/end NaN on line "${e}", with colStart:${c} and colEnd:${l}. run "tabix -p bed" to ensure bed preset`);for(let e=0;e<g.length;e++){let i=`${this.id}-${t}-${e}`,o=Math.abs(+g[e]),c=d[e]||`col${e}`;o&&a.next(new r.SimpleFeature({id:i,data:{refName:n,start:s,end:h,score:o,source:c}}))}},...t}),a.complete()})}}}}]);