(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2028],{22028:function(e,t,A){"use strict";A.r(t),A.d(t,{default:function(){return e$}});var r={CRAM_FLAG_PRESERVE_QUAL_SCORES:1,CRAM_FLAG_DETACHED:2,CRAM_FLAG_MATE_DOWNSTREAM:4,CRAM_FLAG_NO_SEQ:8,BAM_FPAIRED:1,BAM_FPROPER_PAIR:2,BAM_FUNMAP:4,BAM_FMUNMAP:8,BAM_FREVERSE:16,BAM_FMREVERSE:32,BAM_FREAD1:64,BAM_FREAD2:128,BAM_FSECONDARY:256,BAM_FQCFAIL:512,BAM_FDUP:1024,BAM_FSUPPLEMENTARY:2048};let i={a:0,A:0,c:1,C:1,g:2,G:2,t:3,T:3,n:4,N:4};function n(e){let t={};for(let[A,r]of e)t[`is${r}`]=e=>!!(e&A),t[`set${r}`]=e=>e|A;return t}let a=n([[1,"Paired"],[2,"ProperlyPaired"],[4,"SegmentUnmapped"],[8,"MateUnmapped"],[16,"ReverseComplemented"],[32,"MateReverseComplemented"],[64,"Read1"],[128,"Read2"],[256,"Secondary"],[512,"FailedQc"],[1024,"Duplicate"],[2048,"Supplementary"]]),s=n([[1,"PreservingQualityScores"],[2,"Detached"],[4,"WithMateDownstream"],[8,"DecodeSequenceAsStar"]]),o=n([[1,"OnNegativeStrand"],[2,"Unmapped"]]);class g{constructor({flags:e,cramFlags:t,readLength:A,mappingQuality:r,lengthOnRef:i,qualityScores:n,mateRecordNumber:a,readBases:s,readFeatures:o,mateToUse:g,readGroupId:l,readName:C,sequenceId:h,uniqueId:I,templateSize:d,alignmentStart:c,tags:f}){this.flags=e,this.cramFlags=t,this.readLength=A,this.mappingQuality=r,this.lengthOnRef=i,this.qualityScores=n,s&&(this.readBases=s),this.readGroupId=l,this.readName=C,this.sequenceId=h,this.uniqueId=I,this.templateSize=d,this.alignmentStart=c,this.tags=f,o&&(this.readFeatures=o),g&&(this.mate={flags:g.mateFlags,readName:g.mateReadName,sequenceId:g.mateSequenceId,alignmentStart:g.mateAlignmentStart}),a&&(this.mateRecordNumber=a)}isPaired(){return!!(this.flags&r.BAM_FPAIRED)}isProperlyPaired(){return!!(this.flags&r.BAM_FPROPER_PAIR)}isSegmentUnmapped(){return!!(this.flags&r.BAM_FUNMAP)}isMateUnmapped(){return!!(this.flags&r.BAM_FMUNMAP)}isReverseComplemented(){return!!(this.flags&r.BAM_FREVERSE)}isMateReverseComplemented(){return!!(this.flags&r.BAM_FMREVERSE)}isRead1(){return!!(this.flags&r.BAM_FREAD1)}isRead2(){return!!(this.flags&r.BAM_FREAD2)}isSecondary(){return!!(this.flags&r.BAM_FSECONDARY)}isFailedQc(){return!!(this.flags&r.BAM_FQCFAIL)}isDuplicate(){return!!(this.flags&r.BAM_FDUP)}isSupplementary(){return!!(this.flags&r.BAM_FSUPPLEMENTARY)}isDetached(){return!!(this.cramFlags&r.CRAM_FLAG_DETACHED)}hasMateDownStream(){return!!(this.cramFlags&r.CRAM_FLAG_MATE_DOWNSTREAM)}isPreservingQualityScores(){return!!(this.cramFlags&r.CRAM_FLAG_PRESERVE_QUAL_SCORES)}isUnknownBases(){return!!(this.cramFlags&r.CRAM_FLAG_NO_SEQ)}getReadBases(){if(!this.readBases&&this._refRegion){let e=function(e,t){if(!e.lengthOnRef&&!e.readLength||e.isUnknownBases())return null;let A=e.alignmentStart-t.start;if(!e.readFeatures)return t.seq.slice(A,A+(e.lengthOnRef||0)).toUpperCase();let r="",i=A,n=0;for(;r.length<e.readLength;)if(n<e.readFeatures.length){let A=e.readFeatures[n];if("Q"===A.code||"q"===A.code)n+=1;else if(A.pos===r.length+1){if(n+=1,"b"===A.code){let e=A.data;r+=e,i+=e.length}else"B"===A.code?(r+=A.data[0],i+=1):"X"===A.code?(r+=A.sub,i+=1):"I"===A.code?r+=A.data:"D"===A.code?i+=A.data:"i"===A.code?r+=A.data:"N"===A.code?i+=A.data:"S"===A.code?r+=A.data:"P"===A.code||A.code}else if(n<e.readFeatures.length){let e=t.seq.slice(i,i+A.pos-r.length-1);r+=e,i+=e.length}}else{let A=t.seq.slice(i,i+e.readLength-r.length);r+=A,i+=A.length}return r.toUpperCase()}(this,this._refRegion);e&&(this.readBases=e)}return this.readBases}getPairOrientation(){if(!this.isSegmentUnmapped()&&this.isPaired()&&!this.isMateUnmapped()&&this.mate&&this.sequenceId===this.mate.sequenceId){let e=this.isReverseComplemented()?"R":"F",t=this.isMateReverseComplemented()?"R":"F",A=" ",r=" ";this.isRead1()?(A="1",r="2"):this.isRead2()&&(A="2",r="1");let i=[],n=this.templateLength||this.templateSize;if(void 0===n)throw Error("One of templateSize and templateLength must be set");return this.alignmentStart>this.mate.alignmentStart&&n>0&&(n=-n),n>0?(i[0]=e,i[1]=A,i[2]=t,i[3]=r):(i[2]=e,i[3]=A,i[0]=t,i[1]=r),i.join("")}return null}addReferenceSequence(e,t){this.readFeatures&&this.readFeatures.forEach(A=>{"X"===A.code&&function(e,t,A,r){let n=r.refPos-t.start,a=t.seq.charAt(n);a&&(r.ref=a);let s=i[a];void 0===s&&(s=4);let o=A.substitutionMatrix[s][r.data];o&&(r.sub=o)}(0,e,t,A)}),!this.readBases&&e.start<=this.alignmentStart&&e.end>=this.alignmentStart+(this.lengthOnRef||this.readLength)-1&&(this._refRegion=e)}toJSON(){let e={};return Object.keys(this).forEach(t=>{t.startsWith("_")||(e[t]=this[t])}),e.readBases=this.getReadBases(),e}}var l=A(89326),C=A(51936),h=A(8662);class I extends Error{}class d extends Error{}class c extends I{}class f extends I{}let u=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],B=Array(256);for(let e=0;e<256;e++)B[e]=`${u[e>>>4&15]}${u[15&e]}`;let Q=[0,1,3,7,15,31,63,127,255];class E{constructor(e){this.stream=e,this.bitOffset=0,this.curByte=0,this.hasByte=!1}_ensureByte(){this.hasByte||(this.curByte=this.stream.readByte(),this.hasByte=!0)}read(e){let t=0;for(;e>0;){this._ensureByte();let A=8-this.bitOffset;if(e>=A)t<<=A,t|=Q[A]&this.curByte,this.hasByte=!1,this.bitOffset=0,e-=A;else{t<<=e;let r=A-e;t|=(this.curByte&Q[e]<<r)>>r,this.bitOffset+=e,e=0}}return t}seek(e){let t=e%8;this.bitOffset=t,this.stream.seek((e-t)/8),this.hasByte=!1}pi(){let e=new Uint8Array(6);for(let t=0;t<e.length;t++)e[t]=this.read(8);return function(e){let t="";for(let A=0,r=e.length;A<r;A++)t+=B[e[A]];return t}(e)}}let m=new Uint32Array([0,79764919,159529838,222504665,319059676,398814059,445009330,507990021,638119352,583659535,797628118,726387553,890018660,835552979,1015980042,944750013,1276238704,1221641927,1167319070,1095957929,1595256236,1540665371,1452775106,1381403509,1780037320,1859660671,1671105958,1733955601,2031960084,2111593891,1889500026,1952343757,2552477408,2632100695,2443283854,2506133561,2334638140,2414271883,2191915858,2254759653,3190512472,3135915759,3081330742,3009969537,2905550212,2850959411,2762807018,2691435357,3560074640,3505614887,3719321342,3648080713,3342211916,3287746299,3467911202,3396681109,4063920168,4143685023,4223187782,4286162673,3779000052,3858754371,3904687514,3967668269,881225847,809987520,1023691545,969234094,662832811,591600412,771767749,717299826,311336399,374308984,453813921,533576470,25881363,88864420,134795389,214552010,2023205639,2086057648,1897238633,1976864222,1804852699,1867694188,1645340341,1724971778,1587496639,1516133128,1461550545,1406951526,1302016099,1230646740,1142491917,1087903418,2896545431,2825181984,2770861561,2716262478,3215044683,3143675388,3055782693,3001194130,2326604591,2389456536,2200899649,2280525302,2578013683,2640855108,2418763421,2498394922,3769900519,3832873040,3912640137,3992402750,4088425275,4151408268,4197601365,4277358050,3334271071,3263032808,3476998961,3422541446,3585640067,3514407732,3694837229,3640369242,1762451694,1842216281,1619975040,1682949687,2047383090,2127137669,1938468188,2001449195,1325665622,1271206113,1183200824,1111960463,1543535498,1489069629,1434599652,1363369299,622672798,568075817,748617968,677256519,907627842,853037301,1067152940,995781531,51762726,131386257,177728840,240578815,269590778,349224269,429104020,491947555,4046411278,4126034873,4172115296,4234965207,3794477266,3874110821,3953728444,4016571915,3609705398,3555108353,3735388376,3664026991,3290680682,3236090077,3449943556,3378572211,3174993278,3120533705,3032266256,2961025959,2923101090,2868635157,2813903052,2742672763,2604032198,2683796849,2461293480,2524268063,2284983834,2364738477,2175806836,2238787779,1569362073,1498123566,1409854455,1355396672,1317987909,1246755826,1192025387,1137557660,2072149281,2135122070,1912620623,1992383480,1753615357,1816598090,1627664531,1707420964,295390185,358241886,404320391,483945776,43990325,106832002,186451547,266083308,932423249,861060070,1041341759,986742920,613929101,542559546,756411363,701822548,3316196985,3244833742,3425377559,3370778784,3601682597,3530312978,3744426955,3689838204,3819031489,3881883254,3928223919,4007849240,4037393693,4100235434,4180117107,4259748804,2310601993,2373574846,2151335527,2231098320,2596047829,2659030626,2470359227,2550115596,2947551409,2876312838,2788305887,2733848168,3165939309,3094707162,3040238851,2985771188]);class p{constructor(){this.crc=4294967295}getCRC(){return~this.crc>>>0}updateCRC(e){this.crc=this.crc<<8^m[(this.crc>>>24^e)&255]}updateCRCRun(e,t){for(;t-- >0;)this.crc=this.crc<<8^m[(this.crc>>>24^e)&255]}}class w{readByte(){throw Error("abstract method readByte() not implemented")}read(e,t,A){let r=0;for(;r<A;){let A=this.readByte();if(A<0)return 0===r?-1:r;e[t++]=A,r++}return r}writeByte(e){throw Error("abstract method readByte() not implemented")}seek(e){throw Error("abstract method seek() not implemented")}write(e,t,A){let r;for(r=0;r<A;r++)this.writeByte(e[t++]);return A}flush(){}}let y=function(e,t){let A=e[t];for(let A=t;A>0;A--)e[A]=e[A-1];return e[0]=A,A},D={LAST_BLOCK:-1,NOT_BZIP_DATA:-2,UNEXPECTED_INPUT_EOF:-3,UNEXPECTED_OUTPUT_EOF:-4,DATA_ERROR:-5,OUT_OF_MEMORY:-6,OBSOLETE_INPUT:-7},R={};R[D.LAST_BLOCK]="Bad file checksum",R[D.NOT_BZIP_DATA]="Not bzip data",R[D.UNEXPECTED_INPUT_EOF]="Unexpected input EOF",R[D.UNEXPECTED_OUTPUT_EOF]="Unexpected output EOF",R[D.DATA_ERROR]="Data error",R[D.OUT_OF_MEMORY]="Out of memory",R[D.OBSOLETE_INPUT]="Obsolete (pre 0.9.5) bzip format not supported.";let S=function(e,t){let A=R[e]||"unknown error";t&&(A+=": "+t);let r=TypeError(A);throw r.errorCode=e,r};class N{constructor(e,t){this.writePos=this.writeCurrent=this.writeCount=0,this._start_bunzip(e,t)}_init_block(){return this._get_next_block()?(this.blockCRC=new p,!0):(this.writeCount=-1,!1)}_start_bunzip(e,t){let A=new Uint8Array(4);(4!==e.read(A,0,4)||"BZh"!==String.fromCharCode(A[0],A[1],A[2]))&&S(D.NOT_BZIP_DATA,"bad magic");let r=A[3]-48;(r<1||r>9)&&S(D.NOT_BZIP_DATA,"level out of range"),this.reader=new E(e),this.dbufSize=1e5*r,this.nextoutput=0,this.outputStream=t,this.streamCRC=0}_get_next_block(){let e,t,A;let r=this.reader,i=r.pi();if("177245385090"===i)return!1;"314159265359"!==i&&S(D.NOT_BZIP_DATA),this.targetBlockCRC=r.read(32)>>>0,this.streamCRC=(this.targetBlockCRC^(this.streamCRC<<1|this.streamCRC>>>31))>>>0,r.read(1)&&S(D.OBSOLETE_INPUT);let n=r.read(24);n>this.dbufSize&&S(D.DATA_ERROR,"initial position out of bounds");let a=r.read(16),s=new Uint8Array(256),o=0;for(e=0;e<16;e++)if(a&1<<15-e){let i=16*e;for(t=0,A=r.read(16);t<16;t++)A&1<<15-t&&(s[o++]=i+t)}let g=r.read(3);(g<2||g>6)&&S(D.DATA_ERROR);let l=r.read(15);0===l&&S(D.DATA_ERROR);let C=new Uint8Array(256);for(e=0;e<g;e++)C[e]=e;let h=new Uint8Array(l);for(e=0;e<l;e++){for(t=0;r.read(1);t++)t>=g&&S(D.DATA_ERROR);h[e]=y(C,t)}let I=o+2,d=[],c;for(t=0;t<g;t++){var f,u;let t=new Uint8Array(I),A=new Uint16Array(21);for(e=0,a=r.read(5);e<I;e++){for(;(a<1||a>20)&&S(D.DATA_ERROR),r.read(1);)r.read(1)?a--:a++;t[e]=a}for(e=1,f=u=t[0];e<I;e++)t[e]>u?u=t[e]:t[e]<f&&(f=t[e]);c={},d.push(c),c.permute=new Uint16Array(258),c.limit=new Uint32Array(22),c.base=new Uint32Array(21),c.minLen=f,c.maxLen=u;let i=0;for(e=f;e<=u;e++)for(a=0,A[e]=c.limit[e]=0;a<I;a++)t[a]===e&&(c.permute[i++]=a);for(e=0;e<I;e++)A[t[e]]++;for(i=a=0,e=f;e<u;e++)i+=A[e],c.limit[e]=i-1,i<<=1,a+=A[e],c.base[e+1]=i-a;c.limit[u+1]=Number.MAX_VALUE,c.limit[u]=i+A[u]-1,c.base[f]=0}let B=new Uint32Array(256);for(e=0;e<256;e++)C[e]=e;let Q=0,E=0,m=0,p,w=this.dbuf=new Uint32Array(this.dbufSize);for(I=0;;){for(I--||(I=49,m>=l&&S(D.DATA_ERROR),c=d[h[m++]]),e=c.minLen,t=r.read(e);e>c.maxLen&&S(D.DATA_ERROR),!(t<=c.limit[e]);e++)t=t<<1|r.read(1);((t-=c.base[e])<0||t>=258)&&S(D.DATA_ERROR);let A=c.permute[t];if(0===A||1===A){Q||(Q=1,a=0),a+=0===A?Q:2*Q,Q<<=1;continue}if(Q)for(Q=0,E+a>this.dbufSize&&S(D.DATA_ERROR),p=s[C[0]],B[p]+=a;a--;)w[E++]=p;if(A>o)break;E>=this.dbufSize&&S(D.DATA_ERROR),p=s[p=y(C,e=A-1)],B[p]++,w[E++]=p}for((n<0||n>=E)&&S(D.DATA_ERROR),t=0,e=0;e<256;e++)A=t+B[e],B[e]=t,t=A;for(e=0;e<E;e++)p=255&w[e],w[B[p]]|=e<<8,B[p]++;let R=0,N=0,b=0;return E&&(N=255&(R=w[n]),R>>=8,b=-1),this.writePos=R,this.writeCurrent=N,this.writeCount=E,this.writeRun=b,!0}_read_bunzip(e,t){let A,r,i;if(this.writeCount<0)return 0;let n=this.dbuf,a=this.writePos,s=this.writeCurrent,o=this.writeCount;this.outputsize;let g=this.writeRun;for(;o;){for(o--,r=s,s=255&(a=n[a]),a>>=8,3==g++?(A=s,i=r,s=-1):(A=1,i=s),this.blockCRC.updateCRCRun(i,A);A--;)this.outputStream.writeByte(i),this.nextoutput++;s!=r&&(g=0)}return this.writeCount=o,this.blockCRC.getCRC()!==this.targetBlockCRC&&S(D.DATA_ERROR,"Bad block CRC (got "+this.blockCRC.getCRC().toString(16)+" expected "+this.targetBlockCRC.toString(16)+")"),this.nextoutput}}let b=function(e){if("readByte"in e)return e;let t=new w;return t.pos=0,t.readByte=function(){return e[this.pos++]},t.seek=function(e){this.pos=e},t.eof=function(){return this.pos>=e.length},t},F=function(e){let t=new w,A=!0;if(e){if("number"==typeof e)t.buffer=new Uint8Array(e),A=!1;else{if("writeByte"in e)return e;t.buffer=e,A=!1}}else t.buffer=new Uint8Array(16384);return t.pos=0,t.writeByte=function(e){if(A&&this.pos>=this.buffer.length){let e=new Uint8Array(2*this.buffer.length);e.set(this.buffer),this.buffer=e}this.buffer[this.pos++]=e},t.getBuffer=function(){if(this.pos!==this.buffer.length){if(!A)throw TypeError("outputsize does not match decoded input");let e=new Uint8Array(this.pos);e.set(this.buffer.slice(0,this.pos)),this.buffer=e}return this.buffer},t._coerced=!0,t};function k(e,t,A){let r=b(e),i=F(t),n=new N(r,i);for(;!(("eof"in r)&&r.eof());)if(n._init_block())n._read_bunzip();else{let e=n.reader.read(32)>>>0;if(e!==n.streamCRC&&S(D.DATA_ERROR,"Bad stream CRC (got "+n.streamCRC.toString(16)+" expected "+e.toString(16)+")"),A&&"eof"in r&&!r.eof())n._start_bunzip(r,i);else break}if("getBuffer"in i)return i.getBuffer()}class _{constructor(e){this.low=0,this.range=4294967295,this.code=0,this.FFnum=0,this.carry=0,this.cache=0}RangeStartDecode(e){for(let t=0;t<5;t++)this.code=(this.code<<8)+e.ReadByte();this.code&=4294967295,this.code>>>=0}RangeGetFrequency(e){return this.range=Math.floor(this.range/e),Math.floor(this.code/this.range)}RangeDecode(e,t,A,r){for(this.code-=t*this.range,this.range*=A;this.range<16777216;)this.range*=256,this.code=256*this.code+e.ReadByte()}RangeShiftLow(e){if(this.low<4278190080|this.carry){for(e.WriteByte(this.cache+this.carry);this.FFnum;)e.WriteByte(this.carry-1),this.FFnum--;this.cache=this.low>>>24,this.carry=0}else this.FFnum++;this.low<<=8,this.low>>>=0}RangeEncode(e,t,A,r){let i=this.low;for(this.range=Math.floor(this.range/r),this.low+=t*this.range,this.low>>>=0,this.range*=A,this.low<i&&(0!=this.carry&&console.log("ERROR: Multiple carry"),this.carry=1);this.range<16777216;)this.range*=256,this.RangeShiftLow(e)}RangeFinishEncode(e){for(let t=0;t<5;t++)this.RangeShiftLow(e)}}class M{constructor(e=256){this.total_freq=e,this.max_sym=e-1,this.S=[],this.F=[];for(let e=0;e<=this.max_sym;e++)this.S[e]=e,this.F[e]=1}ModelDecode(e,t){let A=t.RangeGetFrequency(this.total_freq),r=0,i=0;for(;r+this.F[i]<=A;)r+=this.F[i++];t.RangeDecode(e,r,this.F[i],this.total_freq),this.F[i]+=16,this.total_freq+=16,this.total_freq>65519&&this.ModelRenormalise();let n=this.S[i];if(i>0&&this.F[i]>this.F[i-1]){let e=this.F[i];this.F[i]=this.F[i-1],this.F[i-1]=e,e=this.S[i],this.S[i]=this.S[i-1],this.S[i-1]=e}return n}ModelRenormalise(){this.total_freq=0;for(let e=0;e<=this.max_sym;e++)this.F[e]-=Math.floor(this.F[e]/2),this.total_freq+=this.F[e]}ModelEncode(e,t,A){let r=0;for(var i=0;this.S[i]!=A;i++)r+=this.F[i];t.RangeEncode(e,r,this.F[i],this.total_freq),this.F[i]+=16,this.total_freq+=16,this.total_freq>65519&&this.ModelRenormalise();var A=this.S[i];if(i>0&&this.F[i]>this.F[i-1]){let e=this.F[i];this.F[i]=this.F[i-1],this.F[i-1]=e,e=this.S[i],this.S[i]=this.S[i-1],this.S[i-1]=e}}}class q{constructor(e,t=0,A=0){0!==A?(this.buf=new Uint8Array(A),this.length=A):(this.buf=e,this.length=e.length),this.dataView=new DataView(this.buf.buffer),this.pos=t}EOF(){return this.pos>=this.length}ReadData(e){let t=this.buf.slice(this.pos,this.pos+e);return this.pos+=e,t}ReadByte(){let e=this.buf[this.pos];return this.pos++,e}ReadChar(){let e=this.buf[this.pos];return this.pos++,String.fromCharCode(e)}ReadUint16(){return this.ReadByte()|this.ReadByte()<<8}ReadUint32(){let e=this.dataView.getInt32(this.pos,!0);return this.pos+=4,e}ReadString(){let e,t="";do(e=this.buf[this.pos++])&&(t+=String.fromCharCode(e));while(e);return t}ReadUint7(){let e,t=0;do t=t<<7|127&(e=this.ReadByte());while(128&e);return t}ReadITF8(){let e=this.buf[this.pos];return this.pos++,e>=240?(e=((15&e)<<28)+((this.buf[this.pos+0]<<20)+(this.buf[this.pos+1]<<12)+(this.buf[this.pos+2]<<4)+(this.buf[this.pos+3]>>4)),this.pos+=4):e>=224?(e=((15&e)<<24)+((this.buf[this.pos+0]<<16)+(this.buf[this.pos+1]<<8)+(this.buf[this.pos+2]<<0)),this.pos+=3):e>=192?(e=((31&e)<<16)+((this.buf[this.pos+0]<<8)+(this.buf[this.pos+1]<<0)),this.pos+=2):e>=128&&(e=((63&e)<<8)+this.buf[this.pos],this.pos++),e}}class v{decode(e){return this.stream=new q(e),this.decodeStream(this.stream)}decodeStream(e,t=0){let A=this.stream.ReadByte();16&A||(t=this.stream.ReadUint7());let r=t,i=1&A;if(8&A)return this.decodeStripe(this.stream,t);if(128&A){var n;[n,r]=this.decodePackMeta(this.stream)}if(32&A)var a=this.decodeCat(this.stream,r);else if(4&A)var a=this.decodeExt(this.stream,r);else if(64&A)var a=i?this.decodeRLE1(this.stream,r):this.decodeRLE0(this.stream,r);else var a=i?this.decode1(this.stream,r):this.decode0(this.stream,r);return 128&A&&(a=this.decodePack(a,n,t)),a}decode0(e,t){let A=new Uint8Array(t),r=e.ReadByte();0==r&&(r=256);let i=new M(r),n=new _(e);n.RangeStartDecode(e);for(let r=0;r<t;r++)A[r]=i.ModelDecode(e,n);return A}decode1(e,t){let A=new Uint8Array(t),r=e.ReadByte();0==r&&(r=256);let i=Array(r);for(var n=0;n<r;n++)i[n]=new M(r);let a=new _(e);a.RangeStartDecode(e);let s=0;for(var n=0;n<t;n++)A[n]=i[s].ModelDecode(e,a),s=A[n];return A}decodeExt(e,t){return k(e.buf.slice(e.pos))}decodeRLE0(e,t){let A=new Uint8Array(t),r=e.ReadByte();0==r&&(r=256);let i=new M(r),n=Array(258);for(var a=0;a<=257;a++)n[a]=new M(4);let s=new _(e);s.RangeStartDecode(e);for(var a=0;a<t;){A[a]=i.ModelDecode(e,s);let t=n[A[a]].ModelDecode(e,s),r=t,o=256;for(;3==t;)t=n[o].ModelDecode(e,s),o=257,r+=t;for(let e=1;e<=r;e++)A[a+e]=A[a];a+=r+1}return A}decodeRLE1(e,t){let A=new Uint8Array(t),r=e.ReadByte();0==r&&(r=256);let i=Array(r);for(var n=0;n<r;n++)i[n]=new M(r);let a=Array(258);for(var n=0;n<=257;n++)a[n]=new M(4);let s=new _(e);s.RangeStartDecode(e);let o=0;for(var n=0;n<t;){A[n]=i[o].ModelDecode(e,s),o=A[n];let t=a[A[n]].ModelDecode(e,s),r=t,g=256;for(;3==t;)t=a[g].ModelDecode(e,s),g=257,r+=t;for(let e=1;e<=r;e++)A[n+e]=A[n];n+=r+1}return A}decodePackMeta(e){this.nsym=e.ReadByte();let t=Array(this.nsym);for(let A=0;A<this.nsym;A++)t[A]=e.ReadByte();return[t,e.ReadUint7()]}decodePack(e,t,A){let r=new Uint8Array(A);if(this.nsym<=1)for(var i=0;i<A;i++)r[i]=t[0];else if(this.nsym<=2)for(var i=0,n=0;i<A;i++){if(i%8==0)var a=e[n++];r[i]=t[1&a],a>>=1}else if(this.nsym<=4)for(var i=0,n=0;i<A;i++){if(i%4==0)var a=e[n++];r[i]=t[3&a],a>>=2}else if(!(this.nsym<=16))return e;else for(var i=0,n=0;i<A;i++){if(i%2==0)var a=e[n++];r[i]=t[15&a],a>>=4}return r}packMeta(e){let t=new q("",0,1024),A=Array(256);for(var r=0;r<e.length;r++)A[e[r]]=1;for(var i=0,r=0;r<256;r++)A[r]&&(A[r]=++i);t.WriteByte(i);for(var r=0;r<256;r++)A[r]&&(t.WriteByte(r),A[r]--);return[t,A,i]}decodeStripe(e,t){let A=e.ReadByte(),r=Array(A),i=Array(A);for(var n=0;n<A;n++)r[n]=e.ReadUint7();let a=Array(A);for(var n=0;n<A;n++)i[n]=Math.floor(t/A)+(t%A>n),a[n]=this.decodeStream(e,i[n]);let s=new Uint8Array(t);for(var n=0;n<A;n++)for(let e=0;e<i[n];e++)s[e*A+n]=a[n][e];return s}decodeCat(e,t){let A=new Uint8Array(t);for(let r=0;r<t;r++)A[r]=e.ReadByte();return A}}function L(e,t,A){let r=0,i=0,n=-1,a=Array(1024);for(;i<A;){let t=e.ReadByte();if(a[r++]=t,i+=t,t==n){let A=e.ReadByte();for(i+=t*A;A--;)a[r++]=t}n=t}let s=0;for(r=0,i=0;i<A;){let e=0;do{var o=a[r++];e+=o}while(255==o);for(;e--;)t[i++]=s;s++}}function U(e,t){let A=1<<t,r=Array(A),i=0;for(let t=0;t<A;t++){for(;t>=e[i+1];)i++;r[t]=i}return r}function x(e,t,A,r){return A*(e>>r)+(e&(1<<r)-1)-t}function P(e,t){return t<32768&&(t=(t<<16)+e.ReadUint16()),t}function H(e){return function e(t,A){let r=t.ReadByte(),i=64&r,n=128&r,a=4&r?32:4;if(16&r||(A=t.ReadUint7()),8&r)return function(t,A){let r=t.ReadByte(),i=Array(r),n=Array(r);for(var a=0;a<r;a++)i[a]=t.ReadUint7();let s=Array(r);for(var a=0;a<r;a++)n[a]=Math.floor(A/r)+(A%r>a),s[a]=e(t,n[a]);let o=new Uint8Array(A);for(var a=0;a<r;a++)for(let e=0;e<n[a];e++)o[e*r+a]=s[a][e];return o}(t,A);if(n)var s=A,[o,g,A]=function(e){let t=e.ReadByte(),A=Array(t);for(let r=0;r<t;r++)A[r]=e.ReadByte();return[A,t,e.ReadUint7()]}(t);if(i)var l=A,[C,h,A]=function(e,t){let A=e.ReadUint7(),r=e.ReadUint7();if(1&A)var i=e.ReadData((A-1)/2);else{let r=e.ReadUint7();var i=e.ReadData(r);i=J(new q(i),A/2,t)}var i=new q(i);let n=Array(256),a=i.ReadByte();0==a&&(a=256);for(let e=0;e<a;e++)n[i.ReadByte()]=1;return[n,i,r]}(t,a);if(32&r)var I=t.ReadData(A);else if(0==(1&r))var I=J(t,A,a);else var I=function(e,t,A){var r=e.ReadByte();let i=r>>4;var n=e;if(1&r){let t=e.ReadUint7(),A=e.ReadUint7();var r=new q(e.ReadData(A)),n=new q(J(r,t,4))}let a=Array(256),s=Array(256);!function(e,t,A,r){for(var i=0;i<256;i++){t[i]=Array(256),A[i]=Array(256);for(var n=0;n<256;n++)t[i][n]=0}let a=T(e);for(var i=0;i<256;i++){if(!a[i])continue;let s=0;for(var n=0;n<256;n++)a[n]&&(s>0?s--:(t[i][n]=e.ReadUint7(),0==t[i][n]&&(s=e.ReadByte())));Y(t[i],r),A[i][0]=0;for(var n=0;n<256;n++)A[i][n+1]=A[i][n]+t[i][n]}}(n,a,s,i);let o=Array(256);for(var g=0;g<256;g++)o[g]=U(s[g],i);let l=Array(A),C=Array(A);for(var h=0;h<A;h++)l[h]=e.ReadUint32(),C[h]=0;let I=new Uint8Array(t),d=Math.floor(t/A);for(var g=0;g<d;g++)for(var h=0;h<A;h++){var c=l[h]&(1<<i)-1,f=o[C[h]][c];I[g+h*d]=f,l[h]=x(l[h],s[C[h]][f],a[C[h]][f],i),l[h]=P(e,l[h]),C[h]=f}for(g*=A;g<t;){var c=l[A-1]&(1<<i)-1,f=function(e,t){let A=0;for(;t>=e[A+1];)A++;return A}(s[C[A-1]],c);I[g++]=f,l[A-1]=x(l[A-1],s[C[A-1]][f],a[C[A-1]][f],i),l[A-1]=P(e,l[A-1]),C[A-1]=f}return I}(t,A,a);return i&&(I=function(e,t,A,r){new q(e);let i=new Uint8Array(r),n=0;for(let a=0;n<r;a++){let r=e[a];if(t[r]){let e=A.ReadUint7();for(let t=0;t<=e;t++)i[n++]=r}else i[n++]=r}return i}(I,C,h,l)),n&&(I=function(e,t,A,r){let i=new Uint8Array(r),n=0;if(A<=1)for(var a=0;a<r;a++)i[a]=t[0];else if(A<=2)for(a=0;a<r;a++){if(a%8==0)var s=e[n++];i[a]=t[1&s],s>>=1}else if(A<=4)for(a=0;a<r;a++){if(a%4==0)var s=e[n++];i[a]=t[3&s],s>>=2}else if(A<=16)for(a=0;a<r;a++){if(a%2==0)var s=e[n++];i[a]=t[15&s],s>>=4}return i}(I,o,g,s)),I}(new q(e),0)}function T(e){let t=Array(256);for(let e=0;e<256;e++)t[e]=0;let A=0,r=e.ReadByte(),i=r;do t[r]=1,A>0?(A--,r++):(r=e.ReadByte())==i+1&&(A=e.ReadByte()),i=r;while(0!=r);return t}function J(e,t,A){let r=Array(256),i=Array(256);!function(e,t,A){for(var r=0;r<256;r++)t[r]=0;let i=T(e);for(var r=0;r<256;r++)i[r]>0&&(t[r]=e.ReadUint7());Y(t,12),A[0]=0;for(var r=0;r<=255;r++)A[r+1]=A[r]+t[r]}(e,r,i);let n=U(i,12),a=Array(A);for(var s=0;s<A;s++)a[s]=e.ReadUint32();let o=new Uint8Array(t);for(var s=0;s<t;s++){let t=s&A-1,g=n[4095&a[t]];o[s]=g,a[t]=x(a[t],i[g],r[g],12),a[t]=P(e,a[t])}return o}function Y(e,t){let A=0;for(var r=0;r<256;r++)A+=e[r];if(0==A||A==1<<t)return;let i=0;for(;A<1<<t;)A*=2,i++;for(var r=0;r<256;r++)e[r]<<=i}let G=new v;function O(e,t){let A=e+"";for(;A.length<t;)A="0"+A;return A}var K=A(9762),z=A(3549);function $(e,t,A){if(A)return A;if(e)return new K.Z(e);if(t)return new z.S9(t);throw Error("no url, path, or filehandle provided, cannot open")}class V{constructor(){this.F=void 0,this.C=void 0}}class X{constructor(){this.fc=Array(256);for(let e=0;e<this.fc.length;e+=1)this.fc[e]=new V;this.R=null}}class W{constructor(){this.start=void 0,this.freq=void 0}}function j(e,t,A,r){return A*(e>>r)+(e&(1<<r)-1)-t}var Z={FC:V,AriDecoder:X,DecodingSymbol:W,symbolInit:function(e,t,A){if(!(t<=65536))throw new c("assertion failed: start <= 1<<16");if(!(A<=65536-t))throw new c("assertion failed: freq <= 1<<16");e.start=t,e.freq=A},advanceStep:j,advanceSymbolStep:function(e,t,A){return j(e,t.start,t.freq,A)},get:function(e,t){return e&(1<<t)-1},advanceSymbol:function(e,t,A,r){return function(e,t,A,r,i){if((e=r*(e>>i)+(e&(1<<i)-1)-A)<8388608)do e=e<<8|255&t.get();while(e<8388608);return e}(e,t,A.start,A.freq,r)},renormalize:function(e,t){if(e<8388608)do e=e<<8|255&t.get();while(e<8388608);return e}};function ee(e){if(!e)throw new c("assertion failed")}class et{constructor(e,t=0){this._buffer=e,this._dataView=new DataView(e.buffer),this._position=t,this.length=e.length}get(){let e=this._buffer[this._position];return this._position+=1,e}getByte(){return this.get()}getByteAt(e){return this._buffer[e]}position(){return this._position}put(e){return this._buffer[this._position]=e,this._position+=1,e}putAt(e,t){return this._buffer[e]=t,t}setPosition(e){return this._position=e,e}getInt(){let e=this._dataView.getInt32(this._position,!0);return this._position+=4,e}remaining(){return this._buffer.length-this._position}}var eA=A(63624);let{inflate:er}=A.t(eA,2);class ei extends Error{}function en(e,t,A){let r=0;if(t.bytePosition+(7-t.bitPosition+A)/8>e.length)throw new ei("read error during decoding. the file seems to be truncated.");for(let i=A;i;i--)r<<=1,r|=e[t.bytePosition]>>t.bitPosition&1,t.bitPosition-=1,t.bitPosition<0&&(t.bytePosition+=1),t.bitPosition&=7;return r}var ea=A(90684);function es(e,t){let A,r=t,i=e[r];return i<128?(A=i,r+=1):i<192?(A=(63&i)<<8|e[r+1],r+=2):i<224?(A=(31&i)<<16|e[r+1]<<8|e[r+2],r+=3):i<240?(A=(15&i)<<24|e[r+1]<<16|e[r+2]<<8|e[r+3],r+=4):(A=(15&i)<<28|e[r+1]<<20|e[r+2]<<12|e[r+3]<<4|15&e[r+4],r+=5),[A,r-t]}function eo(e,t){let A,r=t,i=e[r];return i<128?(A=i,r+=1):i<192?(A=(i<<8|e[r+1])&16383,r+=2):i<224?(A=(63&i)<<16|e[r+1]<<8|e[r+2],r+=3):i<240?(A=(31&i)<<24|e[r+1]<<16|e[r+2]<<8|e[r+3],r+=4):i<248?(A=(15&e[r])*4294967296+(e[r+1]<<24|e[r+2]<<16|e[r+3]<<8|e[r+4]),r+=5):i<252?(A=((7&e[r])<<8|e[r+1])*4294967296+(e[r+2]<<24|e[r+3]<<16|e[r+4]<<8|e[r+5]),r+=6):i<254?(A=((3&e[r])<<16|e[r+1]<<8|e[r+2])*4294967296+(e[r+3]<<24|e[r+4]<<16|e[r+5]<<8|e[r+6]),r+=7):i<255?(A=(e[r+1]<<24|e[r+2]<<16|e[r+3]<<8|e[r+4])*4294967296+(e[r+5]<<24|e[r+6]<<16|e[r+7]<<8|e[r+8]),r+=8):(A=72057594037927940*e[r+1]+(e[r+2]<<24|e[r+3]<<16|e[r+4]<<8|e[r+5])*4294967296+(e[r+6]<<24|e[r+7]<<16|e[r+8]<<8|e[r+9]),r+=9),[A,r-t]}function eg(e,t,A=0,r=0){let{offset:i,value:n}=t(e,A);return{...n,_endPosition:i+r,_size:i-A}}function el(e,t){let A=e.prototype[t],r=`_memo_${t}`;e.prototype[t]=function(){if(!(r in this)){let e=A.call(this);this[r]=e,Promise.resolve(e).catch(()=>{delete this[r]})}return this[r]}}function eC(){return{parser:(e,t=0)=>{let A=new DataView(e.buffer,e.byteOffset,e.length),r=new TextDecoder("utf8"),i=0,n=r.decode(e.subarray(i,i+4));i+=4;let a=A.getUint8(i);i+=1;let s=A.getUint8(i);return i+=1,{value:{magic:n,majorVersion:a,minorVersion:s,fileId:r.decode(e.subarray(i,i+20)).replaceAll("\0","")},offset:i+=20}},maxLength:26}}function eh(e,t,A){let r=new TextDecoder("utf8").decode(e.subarray(t,A)),i=[];for(let e=0;e<r.length;e+=3)i.push(r.slice(e,e+3));return i}function eI(e){let t={};for(let{key:A,value:r}of e.ents)t[A]&&console.warn(`duplicate key ${A} in map`),t[A]=r;return t}function ed(e){return"number"==typeof e.refSeqId}function ec(e,t){let A=new DataView(e.buffer,e.byteOffset,e.length),[r,i]=es(e,t),[n,a]=es(e,t+=i);t+=a;let s={};if(0===r);else if(1===r){let[A,r]=es(e,t);s.blockContentId=A,t+=r}else if(2===r){let[A,r]=es(e,t);s.offset=A;let[i,n]=es(e,t+=r);s.M=i,t+=n}else if(3===r){let A=es(e,t),r=A[0];t+=A[1];let i=[];for(let A=0;A<r;A++){let A=es(e,t);i.push(A[0]),t+=A[1]}s.symbols=i;let n=es(e,t),a=A[0];s.numLengths=a,s.numCodes=r,s.numLengths=a,t+=n[1];let o=[];for(let A=0;A<a;A++){let A=es(e,t);t+=A[1],o.push(A[0])}s.bitLengths=o}else if(4===r){let{value:A,offset:r}=ec(e,t);s.lengthsEncoding=A;let{value:i,offset:n}=ec(e,t=r);s.valuesEncoding=i,t=n}else if(5===r){s.stopByte=A.getUint8(t);let[r,i]=es(e,t+=1);s.blockContentId=r,t+=i}else if(6===r){let[A,r]=es(e,t);s.offset=A;let[i,n]=es(e,t+=r);s.length=i,t+=n}else if(7===r){let[A,r]=es(e,t);s.offset=A;let[i,n]=es(e,t+=r);s.K=i,t+=n}else if(8===r){let[A,r]=es(e,t);s.offset=A;let[i,n]=es(e,t+=r);s.log2m=i,t+=n}else if(9===r){let[A,r]=es(e,t);s.offset=A,t+=r}else throw Error(`unknown codecId ${r}`);return{value:{codecId:r,parametersBytes:n,parameters:s},offset:t}}function ef(){return{parser:(e,t)=>{let[A,r]=es(e,t),[i,n]=es(e,t+=r);t+=n;let a=[];for(let A=0;A<i;A++){let A=String.fromCharCode(e[t])+String.fromCharCode(e[t+1]),{value:r,offset:i}=ec(e,t+=2);t=i,a.push({key:A,value:r})}return{value:{mapSize:A,ents:a,mapCount:i},offset:t}}}}function eu(){return{parser:(e,t)=>{let[A,r]=es(e,t),[i,n]=es(e,t+=r);t+=n;let a=[];for(let A=0;A<i;A++){let[A,r]=es(e,t);t+=r;let i=String.fromCharCode(A>>16&255)+String.fromCharCode(A>>8&255)+String.fromCharCode(255&A),{value:n,offset:s}=ec(e,t);t=s,a.push({key:i,value:n})}return{value:{mapSize:A,ents:a,mapCount:i},offset:t}}}}function eB(e){return{cramFileDefinition:eC(),cramBlockHeader:{parser:(e,t=0)=>{let A=new DataView(e.buffer,e.byteOffset,e.length),r=0,i=A.getUint8(r),n=["raw","gzip","bzip2","lzma","rans","rans4x16","arith","fqzcomp","tok3"][i];if(!n)throw Error(`compression method number ${i} not implemented`);r+=1;let a=A.getUint8(r),s=["FILE_HEADER","COMPRESSION_HEADER","MAPPED_SLICE_HEADER","UNMAPPED_SLICE_HEADER","EXTERNAL_DATA","CORE_DATA"][a];if(!s)throw Error(`invalid block content type id ${a}`);let[o,g]=es(e,r+=1),[l,C]=es(e,r+=g),[h,I]=es(e,r+=C);return{offset:r+=I,value:{uncompressedSize:h,compressedSize:l,contentId:o,contentType:s,compressionMethod:n}}},maxLength:17},cramBlockCrc32:{parser:(e,t)=>{let A=new DataView(e.buffer,e.byteOffset,e.length).getUint32(t,!0);return{offset:t+=4,value:{crc32:A}}},maxLength:4},cramDataSeriesEncodingMap:ef(),cramTagEncodingMap:eu(),cramCompressionHeader:{parser:(e,t)=>{let{value:A,offset:r}=({parser:(e,t)=>{let A=new DataView(e.buffer,e.byteOffset,e.length),[r,i]=es(e,t),[n,a]=es(e,t+=i);t+=a;let s=[];for(let r=0;r<n;r++){let r=String.fromCharCode(e[t])+String.fromCharCode(e[t+1]);if(t+=2,"MI"===r||"UI"===r||"PI"===r||"RN"===r||"AP"===r||"RR"===r)s.push({key:r,value:!!A.getUint8(t)}),t+=1;else if("SM"===r)s.push({key:r,value:[A.getUint8(t),A.getUint8(t+1),A.getUint8(t+2),A.getUint8(t+3),A.getUint8(t+4)]}),t+=5;else if("TD"===r){let{offset:A,value:i}=({parser:(e,t)=>{let[A,r]=es(e,t);t+=r;let i=e.subarray(t,t+A);t+=A;let n=[],a=0,s=0;for(;s<i.length;s++)i[s]||(n.push(eh(i,a,s)),a=s+1);return s>a&&n.push(eh(i,a,s)),{value:{size:A,ents:n},offset:t}}}).parser(e,t);s.push({key:r,value:i.ents}),t=A}else throw Error(`unknown key ${r}`)}return{value:{mapSize:r,mapCount:n,ents:s},offset:t}}}).parser(e,t);t=r;let{value:i,offset:n}=ef().parser(e,t);t=n;let{value:a,offset:s}=eu().parser(e,t);return t=s,{value:{dataSeriesEncoding:eI(i),preservation:eI(A),tagEncoding:eI(a)},offset:t}}},cramEncoding:{parser:(e,t)=>ec(e,t)},cramUnmappedSliceHeader:{parser:(t,A)=>{let r;let[i,n]=es(t,A);A+=n;let a=0;if(e>=3){let[e,r]=eo(t,A);A+=r,a=e}else if(2===e){let[e,r]=es(t,A);A+=r,a=e}else console.warn("recordCounter=0");let[s,o]=es(t,A),[g,l]=es(t,A+=o);A+=l;let C=[];for(let e=0;e<g;e++){let[e,r]=es(t,A);A+=r,C.push(e)}return e>=2&&(r=[...t.subarray(A,A+16)],A+=16),{value:{recordCounter:a,md5:r,contentIds:C,numContentIds:g,numBlocks:s,numRecords:i},offset:A}},maxLength:e=>40+5*e},cramMappedSliceHeader:{parser:(t,A)=>{let r;let[i,n]=es(t,A),[a,s]=es(t,A+=n),[o,g]=es(t,A+=s),[l,C]=es(t,A+=g);A+=C;let h=0;if(e>=3){let[e,r]=eo(t,A);A+=r,h=e}else if(2===e){let[e,r]=es(t,A);A+=r,h=e}else console.warn("majorVersion is <2, recordCounter set to 0");let[I,d]=es(t,A),[c,f]=es(t,A+=d);A+=f;let u=[];for(let e=0;e<c;e++){let[e,r]=es(t,A);A+=r,u.push(e)}let[B,Q]=es(t,A);return A+=Q,e>=2&&(r=[...t.subarray(A,A+16)],A+=16),{value:{md5:r,numBlocks:I,numRecords:l,numContentIds:c,refSeqSpan:o,refSeqId:i,refSeqStart:a,recordCounter:h,refBaseBlockId:B,contentIds:u},offset:A}},maxLength:e=>60+5*e},cramContainerHeader1:{maxLength:52,parser:(t,A)=>{let r;let i=new DataView(t.buffer,t.byteOffset,t.length).getInt32(A,!0),[n,a]=es(t,A+=4),[s,o]=es(t,A+=a),[g,l]=es(t,A+=o),[C,h]=es(t,A+=l);A+=h;let I=0;if(e>=3){let[e,r]=eo(t,A);I=e,A+=r}else if(2===e){let[e,r]=es(t,A);I=e,A+=r}else console.warn("setting recordCounter=0");if(e>1){let[e,i]=eo(t,A);r=e,A+=i}let[d,c]=es(t,A),[f,u]=es(t,A+=c);return{value:{length:i,refSeqId:n,refSeqStart:s,alignmentSpan:g,numBlocks:d,numLandmarks:f,numBases:r,recordCounter:I,numRecords:C},offset:A+=u}}},cramContainerHeader2:{parser:(t,A)=>{let r;let i=new DataView(t.buffer,t.byteOffset,t.length),[n,a]=es(t,A);A+=a;let s=[];for(let e=0;e<n;e++){let[e,r]=es(t,A);A+=r,s.push(e)}return e>=3&&(r=i.getUint32(A,!0),A+=4),{value:{...void 0===r?{}:{crc32:r},numLandmarks:n,landmarks:s},offset:A}},maxLength:e=>5+5*e+4}}}function eQ(e){let t="";for(let A=0;A<e.length&&0!==e[A];A++)t+=String.fromCharCode(e[A]);return t}class eE{constructor(e,t,A){this.container=e,this.containerPosition=t,this.sliceSize=A,this.file=e.file}async getHeader(){let{majorVersion:e}=await this.file.getDefinition(),t=eB(e),A=await this.container.getHeader(),r=await this.file.readBlock(A._endPosition+this.containerPosition);if("MAPPED_SLICE_HEADER"===r.contentType){let e=eg(r.content,t.cramMappedSliceHeader.parser,0,A._endPosition);return{...r,parsedContent:e}}if("UNMAPPED_SLICE_HEADER"===r.contentType){let e=eg(r.content,t.cramUnmappedSliceHeader.parser,0,A._endPosition);return{...r,parsedContent:e}}throw new c(`error reading slice header block, invalid content type ${r.contentType}`)}async getBlocks(){let e=await this.getHeader(),t=e._endPosition,A=Array(e.parsedContent.numBlocks);for(let e=0;e<A.length;e++){let r=await this.file.readBlock(t);A[e]=r,t=A[e]._endPosition}return A}async getCoreDataBlock(){return(await this.getBlocks())[0]}async _getBlocksContentIdIndex(){let e=await this.getBlocks(),t={};return e.forEach(e=>{"EXTERNAL_DATA"===e.contentType&&(t[e.contentId]=e)}),t}async getBlockByContentId(e){return(await this._getBlocksContentIdIndex())[e]}async getReferenceRegion(){let e=new TextDecoder("utf8"),t=(await this.getHeader()).parsedContent;if(!ed(t))throw Error("slice header not mapped");if(t.refSeqId<0)return;let A=await this.container.getCompressionScheme();if(void 0===A)throw Error("compression scheme undefined");if(t.refBaseBlockId>=0){let A=await this.getBlockByContentId(t.refBaseBlockId);if(!A)throw new c("embedded reference specified, but reference block does not exist");return{seq:e.decode(A.data),start:t.refSeqStart,end:t.refSeqStart+t.refSeqSpan-1,span:t.refSeqSpan}}if(A.referenceRequired||this.file.fetchReferenceSequenceCallback){if(!this.file.fetchReferenceSequenceCallback)throw Error("reference sequence not embedded, and seqFetch callback not provided, cannot fetch reference sequence");let e=await this.file.fetchReferenceSequenceCallback(t.refSeqId,t.refSeqStart,t.refSeqStart+t.refSeqSpan-1);if(e.length!==t.refSeqSpan)throw new f("seqFetch callback returned a reference sequence of the wrong length");return{seq:e,start:t.refSeqStart,end:t.refSeqStart+t.refSeqSpan-1,span:t.refSeqSpan}}}getAllRecords(){return this.getRecords(()=>!0)}async _fetchRecords(){let{majorVersion:e}=await this.file.getDefinition(),t=await this.container.getCompressionScheme();if(void 0===t)throw Error("compression scheme undefined");let A=await this.getHeader(),i=await this._getBlocksContentIdIndex();if(e>1&&this.file.options.checkSequenceMD5&&ed(A.parsedContent)&&A.parsedContent.refSeqId>=0&&A.parsedContent.md5?.join("")!=="0000000000000000"){let e=await this.getReferenceRegion();if(e){let{seq:t,start:r,end:i}=e,n=ea(t.toUpperCase().replaceAll(/[^\u0021-\u007e]/g,"")),a=A.parsedContent.md5?.map(e=>(e<16?"0":"")+e.toString(16)).join("");if(n!==a)throw new c(`MD5 checksum reference mismatch for ref ${A.parsedContent.refSeqId} pos ${r}..${i}. recorded MD5: ${a}, calculated MD5: ${n}`)}}let n=await this.getCoreDataBlock(),l={lastAlignmentStart:ed(A.parsedContent)?A.parsedContent.refSeqStart:0,coreBlock:{bitPosition:7,bytePosition:0},externalBlocks:{map:new Map,getCursor(e){let t=this.map.get(e);return void 0===t&&(t={bitPosition:7,bytePosition:0},this.map.set(e,t)),t}}},C=e=>{let A=t.getCodecForDataSeries(e);if(!A)throw new c(`no codec defined for ${e} data series`);return A.decode(this,n,i,l)},h=Array(A.parsedContent.numRecords);for(let r=0;r<h.length;r+=1)try{let I=function(e,t,A,r,i,n,g,l,C){let h,I,d,f,u,B,Q,E,m,p=t("BF"),w=t("CF");if(!ed(r.parsedContent))throw Error("slice header not mapped");let y=l>1&&-2===r.parsedContent.refSeqId?t("RI"):r.parsedContent.refSeqId,D=t("RL"),R=t("AP");A.APdelta&&(R+=g.lastAlignmentStart),g.lastAlignmentStart=R;let S=t("RG");if(A.readNamesIncluded&&(I=eQ(t("RN"))),s.isDetached(w)){let e;let r=t("MF");A.readNamesIncluded||(I=e=eQ(t("RN")));let i=t("NS"),n=t("NP");(r||i>-1)&&(d={mateFlags:r,mateSequenceId:i,mateAlignmentStart:n,mateReadName:e}),f=t("TS"),o.isUnmapped(r)&&(p=a.setMateUnmapped(p)),o.isOnNegativeStrand(r)&&(p=a.setMateReverseComplemented(p))}else s.isWithMateDownstream(w)&&(u=t("NF")+C+1);let N=t("TL");if(N<0)throw new c("invalid TL index");let b={},F=A.getTagNames(N),k=F.length;for(let t=0;t<k;t++){let r=F[t],a=r.slice(0,2),s=r.slice(2,3),o=A.getCodecForTag(r).decode(e,i,n,g);b[a]=void 0===o?void 0:"number"==typeof o?o:function(e,t){if("Z"===e)return eQ(t);if("A"===e)return String.fromCharCode(t[0]);if("I"===e)return new Uint32Array(t.buffer)[0];if("i"===e)return new Int32Array(t.buffer)[0];if("s"===e)return new Int16Array(t.buffer)[0];if("S"===e)return new Uint16Array(t.buffer)[0];if("c"===e)return new Int8Array(t.buffer)[0];if("C"===e)return t[0];if("f"===e)return new Float32Array(t.buffer)[0];if("H"===e)return Number.parseInt(eQ(t).replace(/^0x/,""),16);if("B"===e)return function(e){let t=String.fromCharCode(e[0]),A=new DataView(e.buffer).getUint32(1,!0),r=Array(A);if(e=e.slice(5),"c"===t){let t=new Int8Array(e.buffer);for(let e=0;e<A;e++)r[e]=t[e]}else if("C"===t){let t=new Uint8Array(e.buffer);for(let e=0;e<A;e++)r[e]=t[e]}else if("s"===t){let t=new Int16Array(e.buffer);for(let e=0;e<A;e++)r[e]=t[e]}else if("S"===t){let t=new Uint16Array(e.buffer);for(let e=0;e<A;e++)r[e]=t[e]}else if("i"===t){let t=new Int32Array(e.buffer);for(let e=0;e<A;e++)r[e]=t[e]}else if("I"===t){let t=new Uint32Array(e.buffer);for(let e=0;e<A;e++)r[e]=t[e]}else if("f"===t){let t=new Float32Array(e.buffer);for(let e=0;e<A;e++)r[e]=t[e]}else throw Error(`unknown type: ${t}`);return r}(t);throw new c(`Unrecognized tag type ${e}`)}(s,o)}if(a.isSegmentUnmapped(p)){if(s.isDecodeSequenceAsStar(w))h=null,m=null;else{let e=Array(D);for(let A=0;A<e.length;A++)e[A]=t("BA");if(h=String.fromCharCode(...e),s.isPreservingQualityScores(w)){m=Array(D);for(let A=0;A<e.length;A++)m[A]=t("QS")}}}else{let e=t("FN");if(e&&(B=function(e,t,A,r,i){let n=0,a=e-1,s=Array(t);function o([e,t]){let r=A(t);if("character"===e)return String.fromCharCode(r);if("string"===e){let e="";for(let t=0;t<r.byteLength;t++)e+=String.fromCharCode(r[t]);return e}return"numArray"===e?Array.from(r):r}for(let e=0;e<t;e++){let t=String.fromCharCode(A("FC")),r=A("FP"),g={B:["character","BA"],S:["string",i>1?"SC":"IN"],X:["number","BS"],D:["number","DL"],I:["string","IN"],i:["character","BA"],b:["string","BB"],q:["numArray","QQ"],Q:["number","QS"],H:["number","HC"],P:["number","PD"],N:["number","RS"]}[t];if(!g)throw new c(`invalid read feature code "${t}"`);let l=o(g),C={B:["number","QS"]}[t];C&&(l=[l,o(C)]);let h=n+=r,I=a+=r;"D"===t||"N"===t?a+=l:"I"===t||"S"===t?a-=l.length:"i"===t&&(a-=1),s[e]={code:t,pos:h,refPos:I,data:l}}return s}(R,e,t,0,l)),Q=D,B)for(let{code:e,data:t}of B)"D"===e||"N"===e?Q+=t:"I"===e||"S"===e?Q-=t.length:"i"===e&&(Q-=1);if(Number.isNaN(Q)&&(console.warn(`${I||`${y}:${R}`} record has invalid read features`),Q=D),E=t("MQ"),s.isPreservingQualityScores(w)){m=Array(D);for(let e=0;e<m.length;e++)m[e]=t("QS")}}return{readLength:D,sequenceId:y,cramFlags:w,flags:p,alignmentStart:R,readGroupId:S,readName:I,mateToUse:d,templateSize:f,mateRecordNumber:u,readFeatures:B,lengthOnRef:Q,mappingQuality:E,qualityScores:m,readBases:h,tags:b}}(this,C,t,A,n,i,l,e,r);h[r]=new g({...I,uniqueId:A.contentPosition+A.parsedContent.recordCounter+r+1})}catch(e){if(e instanceof ei){console.warn("read attempted beyond end of buffer, file seems truncated.");break}throw e}for(let e=0;e<h.length;e+=1){let t=h[e];if(t){let{mateRecordNumber:A}=t;void 0!==A&&A>=0&&h[A]&&function(e,t,A,i){let n=!!(i.mate||void 0!==i.mateRecordNumber&&i.mateRecordNumber!==t);A.readName||(A.readName=String(A.uniqueId),i.readName=A.readName),A.mate={sequenceId:i.sequenceId,alignmentStart:i.alignmentStart,uniqueId:i.uniqueId},i.readName&&(A.mate.readName=i.readName),!i.mate&&void 0===i.mateRecordNumber&&(i.mate={sequenceId:A.sequenceId,alignmentStart:A.alignmentStart,uniqueId:A.uniqueId},A.readName&&(i.mate.readName=A.readName)),A.flags|=r.BAM_FPAIRED,i.flags&r.BAM_FUNMAP&&(A.flags|=r.BAM_FMUNMAP),A.flags&r.BAM_FUNMAP&&(i.flags|=r.BAM_FMUNMAP),i.flags&r.BAM_FREVERSE&&(A.flags|=r.BAM_FMREVERSE),A.flags&r.BAM_FREVERSE&&(i.flags|=r.BAM_FMREVERSE),void 0===A.templateLength&&(n?function(e,t,A){let r=function t(A){let r=[A];if(void 0!==A.mateRecordNumber&&A.mateRecordNumber>=0){let i=e[A.mateRecordNumber];if(!i)throw new c("intra-slice mate record not found, this file seems malformed");r.push(...t(i))}return r}(A),i=r.map(e=>e.alignmentStart),n=Math.max(...r.map(e=>e.alignmentStart+e.readLength-1))-Math.min(...i)+1;n>=0&&r.forEach(e=>{if(void 0!==e.templateLength)throw new c("mate pair group has some members that have template lengths already, this file seems malformed");e.templateLength=n})}(e,0,A):function(e,t){let A=Math.min(e.alignmentStart,t.alignmentStart),r=Math.max(e.alignmentStart+e.readLength-1,t.alignmentStart+t.readLength-1)-A+1;e.templateLength=r,t.templateLength=r}(A,i)),A.mateRecordNumber=void 0}(h,e,t,h[A])}}return h}async getRecords(e){let t=this.container.filePosition+this.containerPosition,A=this.file.featureCache.get(t.toString());A||(A=this._fetchRecords(),this.file.featureCache.set(t.toString(),A));let r=(await A).filter(e);if(r.length&&this.file.fetchReferenceSequenceCallback){let e=await this.getHeader();if(ed(e.parsedContent)&&(e.parsedContent.refSeqId>=0||-2===e.parsedContent.refSeqId)){let t=e.parsedContent.refSeqId>=0?e.parsedContent.refSeqId:void 0,A=await this.container.getCompressionScheme();if(void 0===A)throw Error("compression scheme undefined");let i={};for(let e of r){let A=void 0!==t?t:e.sequenceId,r=i[A];r||(r={id:A,start:e.alignmentStart,end:Number.NEGATIVE_INFINITY,seq:null},i[A]=r);let n=e.alignmentStart+(e.lengthOnRef||e.readLength)-1;n>r.end&&(r.end=n),e.alignmentStart<r.start&&(r.start=e.alignmentStart)}for(let e of(await Promise.all(Object.values(i).map(async e=>{-1!==e.id&&e.start<=e.end&&this.file.fetchReferenceSequenceCallback&&(e.seq=await this.file.fetchReferenceSequenceCallback(e.id,e.start,e.end))})),r)){let r=i[void 0!==t?t:e.sequenceId];if(r?.seq){let t=r.seq;e.addReferenceSequence({...r,seq:t},A)}}}}return r}}"getHeader getBlocks _getBlocksContentIdIndex".split(" ").forEach(e=>{el(eE,e)});class em{constructor(e,t){this.parameters=e,this.dataType=t}}class ep extends em{constructor(e,t){if(super(e,t),"int"!==this.dataType)throw new d(`${this.dataType} decoding not yet implemented by BETA codec`)}decode(e,t,A,r){return en(t.content,r.coreBlock,this.parameters.length)-this.parameters.offset}}class ew extends em{constructor(e,t,A){super(e,t),this.instantiateCodec=A}decode(e,t,A,r){let i=this._getLengthCodec().decode(e,t,A,r)||0,n=this._getDataCodec(),a=new Uint8Array(i);for(let s=0;s<i;s+=1)a[s]=n.decode(e,t,A,r)||0;return a}_getLengthCodec(){let e=this.parameters.lengthsEncoding;return this.instantiateCodec(e,"int")}_getDataCodec(){let e=this.parameters.valuesEncoding;return this.instantiateCodec(e,"byte")}}"_getLengthCodec _getDataCodec".split(" ").forEach(e=>{el(ew,e)});class ey extends em{decode(e,t,A,r){let{blockContentId:i}=this.parameters,n=A[i];if(!n)throw new c(`no block found with content ID ${i}`);let a=r.externalBlocks.getCursor(i);return this._decodeByteArray(n,a)}_decodeByteArray(e,t){let A=e.content,{stopByte:r}=this.parameters,i=t.bytePosition,n=t.bytePosition;for(;A[n]!==r&&n<A.length;){if(n===A.length)throw new ei("byteArrayStop reading beyond length of data buffer?");n+=1}return t.bytePosition=n+1,A.subarray(i,n)}}class eD extends em{constructor(e,t){if(super(e,t),"int"===this.dataType)this._decodeData=this._decodeInt;else if("byte"===this.dataType)this._decodeData=this._decodeByte;else throw new d(`${this.dataType} decoding not yet implemented by EXTERNAL codec`)}decode(e,t,A,r){let{blockContentId:i}=this.parameters,n=A[i];return n?this._decodeData(n,r.externalBlocks.getCursor(i)):void 0}_decodeInt(e,t){let[A,r]=es(e.content,t.bytePosition);return t.bytePosition=t.bytePosition+r,A}_decodeByte(e,t){if(t.bytePosition>=e.content.length)throw new ei("attempted to read beyond end of block. this file seems truncated.");return e.content[t.bytePosition++]}}class eR extends em{constructor(e,t){if(super(e,t),"int"!==this.dataType)throw new d(`${this.dataType} decoding not yet implemented by GAMMA codec`)}decode(e,t,A,r){let i=1;for(;0===en(t.content,r.coreBlock,1);)i+=1;return(en(t.content,r.coreBlock,i-1)|1<<i-1)-this.parameters.offset}}class eS extends em{constructor(e,t){if(super(e,t),this.codes={},this.codeBook={},this.sortedCodes=[],this.sortedValuesByBitCode=[],this.sortedBitCodes=[],this.sortedBitLengthsByBitCode=[],this.bitCodeToValue=[],!["byte","int"].includes(this.dataType))throw TypeError(`${this.dataType} decoding not yet implemented by HUFFMAN_INT codec`);this.buildCodeBook(),this.buildCodes(),this.buildCaches(),0===this.sortedCodes[0].bitLength&&(this._decode=this._decodeZeroLengthCode)}buildCodeBook(){let e=Array(this.parameters.numCodes);for(let t=0;t<this.parameters.numCodes;t++)e[t]={symbol:this.parameters.symbols[t],bitLength:this.parameters.bitLengths[t]};e=e.sort((e,t)=>e.bitLength-t.bitLength||e.symbol-t.symbol),this.codeBook={},e.forEach(e=>{this.codeBook[e.bitLength]||(this.codeBook[e.bitLength]=[]),this.codeBook[e.bitLength].push(e.symbol)})}buildCodes(){this.codes={};let e=0,t=-1;Object.entries(this.codeBook).forEach(([A,r])=>{let i=Number.parseInt(A,10);r.forEach(A=>{var r;let n;let a={bitLength:i,value:A,bitCode:0};t+=1;let s=i-e;if(t<<=s,a.bitCode=t,e+=s,((n=(858993459&(n=(r=t)-(r>>1)&1431655765))+(n>>2&858993459))+(n>>4)&252645135)*16843009>>24>i)throw new c("Symbol out of range");this.codes[A]=a})})}buildCaches(){this.sortedCodes=Object.values(this.codes).sort((e,t)=>e.bitLength-t.bitLength||e.bitCode-t.bitCode),this.sortedValuesByBitCode=this.sortedCodes.map(e=>e.value),this.sortedBitCodes=this.sortedCodes.map(e=>e.bitCode),this.sortedBitLengthsByBitCode=this.sortedCodes.map(e=>e.bitLength);let e=Math.max(...this.sortedBitCodes);this.bitCodeToValue=Array(e+1).fill(-1);for(let e=0;e<this.sortedBitCodes.length;e+=1)this.bitCodeToValue[this.sortedCodes[e].bitCode]=e}decode(e,t,A,r){return this._decode(e,t,r.coreBlock)}_decodeZeroLengthCode(){return this.sortedCodes[0].value}_decode(e,t,A){let r=t.content,i=0,n=0;for(let e=0;e<this.sortedCodes.length;e+=1){let t=this.sortedCodes[e].bitLength;n<<=t-i,n|=en(r,A,t-i),i=t;{let A=this.bitCodeToValue[n];if(A>-1&&this.sortedBitLengthsByBitCode[A]===t)return this.sortedValuesByBitCode[A];for(let A=e;this.sortedCodes[A+1].bitLength===t&&A<this.sortedCodes.length;A+=1)e+=1}}throw new c("Huffman symbol not found.")}}class eN extends em{constructor(e,t){if(super(e,t),"int"!==this.dataType)throw new d(`${this.dataType} decoding not yet implemented by SUBEXP codec`)}decode(e,t,A,r){let i,n,a=0;for(;en(t.content,r.coreBlock,1);)a+=1;if(0===a)i=this.parameters.K,n=en(t.content,r.coreBlock,i);else{i=a+this.parameters.K-1;let e=en(t.content,r.coreBlock,i);n=1<<i|e}return n-this.parameters.offset}}let eb={1:eD,3:eS,4:ew,5:ey,6:ep,7:eN,9:eR};function eF(e,t){let A=eb["ignore"===t?0:e.codecId];if(!A)throw new d(`no codec implemented for codec ID ${e.codecId}`);return new A(e.parameters,t,eF)}let ek={BF:"int",CF:"int",RI:"int",RL:"int",AP:"int",RG:"int",MF:"int",NS:"int",NP:"int",TS:"int",NF:"int",TC:"byte",TN:"int",FN:"int",FC:"byte",FP:"int",BS:"byte",IN:"byteArray",SC:"byteArray",DL:"int",BA:"byte",BB:"byteArray",RS:"int",PD:"int",HC:"int",MQ:"int",RN:"byteArray",QS:"byte",QQ:"byteArray",TL:"int"};class e_{constructor(e){this.dataSeriesCodecCache={},this.tagCodecCache={},this.tagEncoding={},this.readNamesIncluded=e.preservation.RN,this.APdelta=e.preservation.AP,this.referenceRequired=!!e.preservation.RR,this.tagIdsDictionary=e.preservation.TD,this.substitutionMatrix=function(e){let t=[,,,,,];for(let e=0;e<5;e+=1)t[e]=[,,,,];return t[0][e[0]>>6&3]="C",t[0][e[0]>>4&3]="G",t[0][e[0]>>2&3]="T",t[0][e[0]>>0&3]="N",t[1][e[1]>>6&3]="A",t[1][e[1]>>4&3]="G",t[1][e[1]>>2&3]="T",t[1][e[1]>>0&3]="N",t[2][e[2]>>6&3]="A",t[2][e[2]>>4&3]="C",t[2][e[2]>>2&3]="T",t[2][e[2]>>0&3]="N",t[3][e[3]>>6&3]="A",t[3][e[3]>>4&3]="C",t[3][e[3]>>2&3]="G",t[3][e[3]>>0&3]="N",t[4][e[4]>>6&3]="A",t[4][e[4]>>4&3]="C",t[4][e[4]>>2&3]="G",t[4][e[4]>>0&3]="T",t}(e.preservation.SM),this.dataSeriesEncoding=e.dataSeriesEncoding,this.tagEncoding=e.tagEncoding}getCodecForTag(e){let t=this.tagCodecCache[e];if(t)return t;{let t=this.tagEncoding[e];if(!t)throw Error("Error, no tag encoding");let A=eF(t,"byteArray");return this.tagCodecCache[e]=A,A}}getTagNames(e){return this.tagIdsDictionary[e]}getCodecForDataSeries(e){let t=this.dataSeriesCodecCache[e];if(void 0===t){let A=this.dataSeriesEncoding[e];if(A){let r=ek[e];if(!r)throw new c(`data series name ${e} not defined in file compression header`);t=eF(A,r),this.dataSeriesCodecCache[e]=t}}return t}toJSON(){let e={};return Object.keys(this).forEach(t=>{t.endsWith("Cache")||(e[t]=this[t])}),e}}class eM{constructor(e,t){this.file=e,this.filePosition=t}getHeader(){return this._readContainerHeader(this.filePosition)}async getCompressionHeaderBlock(){if(!(await this.getHeader()).numRecords)return null;let{majorVersion:e}=await this.file.getDefinition(),t=eB(e),A=await this.getFirstBlock();if("COMPRESSION_HEADER"!==A.contentType)throw new c(`invalid content type ${A.contentType} in compression header block`);let r=eg(A.content,t.cramCompressionHeader.parser,0,A.contentPosition);return{...A,parsedContent:r}}async getFirstBlock(){let e=await this.getHeader();return this.file.readBlock(e._endPosition)}async getCompressionScheme(){let e=await this.getCompressionHeaderBlock();if(e)return new e_(e.parsedContent)}getSlice(e,t){return new eE(this,e,t)}async _readContainerHeader(e){var t;let{majorVersion:A}=await this.file.getDefinition(),{cramContainerHeader1:r,cramContainerHeader2:i}=eB(A),n=eg(await this.file.read(r.maxLength,e),r.parser),a=-128&(t=n.numLandmarks)?-16384&t?-2097152&t?-268435456&t?5:4:3:2:1,s=eg(await this.file.read(i.maxLength(n.numLandmarks),e+n._size-a),i.parser);return this.file.validateChecksums&&void 0!==s.crc32&&await this.file.checkCrc32(e,n._size+s._size-a-4,s.crc32,`container header beginning at position ${e}`),{...n,...s,_size:n._size+s._size-a,_endPosition:n._size+s._size-a+e}}}"getHeader getCompressionHeaderBlock getCompressionScheme".split(" ").forEach(e=>{el(eM,e)});class eq{constructor(e){if(this.file=$(e.url,e.path,e.filehandle),this.validateChecksums=!0,this.fetchReferenceSequenceCallback=e.seqFetch,this.options={checkSequenceMD5:e.checkSequenceMD5,cacheSize:e.cacheSize??2e4},this.featureCache=new C({maxSize:this.options.cacheSize}),function(){let e=new Uint8Array(new Uint32Array([287454020]).buffer);return 68===e[0]?0:17===e[0]?1:2}()>0)throw Error("Detected big-endian machine, may be unable to run")}read(e,t){return this.file.read(e,t)}async getDefinition(){let{maxLength:e,parser:t}=eC(),A=t(await this.file.read(e,0)).value;if("CRAM"!==A.magic)throw Error("Not a CRAM file, does not match magic string");if(2===A.majorVersion||3===A.majorVersion)return A;throw new d(`CRAM version ${A.majorVersion} not supported`)}async getSamHeader(){let e=await this.getContainerById(0);if(!e)throw new c("file contains no containers");let t=(await e.getFirstBlock()).content,A=new DataView(t.buffer).getInt32(0,!0),r=new TextDecoder("utf8").decode(t.subarray(4,4+A));return this.header=r,function(e){let t=e.split(/\r?\n/),A=[];for(let e of t){let[t,...r]=e.split(/\t/);t&&A.push({tag:t.slice(1),data:r.map(e=>{let t=e.indexOf(":");return -1!==t?{tag:e.slice(0,t),value:e.slice(t+1)}:{tag:e,value:""}})})}return A}(r)}async getHeaderText(){return await this.getSamHeader(),this.header}async getContainerById(e){let t;let{majorVersion:A}=await this.getDefinition(),r=eB(A).cramFileDefinition.maxLength;for(let A=0;A<=e;A++){t=this.getContainerAtPosition(r);let e=await t.getHeader();if(0===A){r=e._endPosition;for(let t=0;t<e.numBlocks;t++)r=(await this.readBlock(r))._endPosition}else r+=e._size+e.length}return t}async checkCrc32(e,t,A,r){let i=await this.file.read(t,e),n=(0,l.Z)(i)>>>0;if(n!==A)throw new c(`crc mismatch in ${r}: recorded CRC32 = ${A}, but calculated CRC32 = ${n}`)}async containerCount(){let{majorVersion:e}=await this.getDefinition(),t=eB(e),A=0,r=t.cramFileDefinition.maxLength;try{for(;;){let e=await this.getContainerAtPosition(r).getHeader();if(0===A){r=e._endPosition;for(let t=0;t<e.numBlocks;t++)r=(await this.readBlock(r))._endPosition}else r+=e._size+e.length;A+=1}}catch(e){A--}return A}getContainerAtPosition(e){return new eM(this,e)}async readBlockHeader(e){let{majorVersion:t}=await this.getDefinition(),{cramBlockHeader:A}=eB(t);return eg(await this.file.read(A.maxLength,e),A.parser,0,e)}async _parseSection(e,t,A=e.maxLength,r){let i=eg(r??await this.file.read(A,t),e.parser,0,t);if(i._size!==A)throw new c(`section read error: requested size ${A} does not equal parsed size ${i._size}`);return i}async _uncompressPre(e,t,A){var r;if("gzip"===e)return er(t);if("bzip2"===e)return k(t);if("lzma"===e){let e=new Response(new h.XzReadableStream(new ReadableStream({start(e){e.enqueue(t),e.close()}})));return new Uint8Array(await e.arrayBuffer())}if("rans"===e){let e=new Uint8Array(A);return!function(e,t,A=0){if(0===e.length)return t.fill(0);let r=new et(e,A),i=r.get();if(0!==i&&1!==i)throw new c(`Invalid rANS order ${i}`);if(r.getInt()!==r.remaining()-4)throw new c("Incorrect input length.");let n=r.getInt(),a=new et(t||new Uint8Array(n));if(a.length<n)throw new c(`Output buffer too small to fit ${n} bytes.`);switch(i){case 0:return function(e,t){let A=new Z.AriDecoder,r=Array(256);for(let e=0;e<r.length;e+=1)r[e]=new Z.DecodingSymbol;(function(e,t,A){let r=0,i=0,n=255&e.get();do null==t.fc[n]&&(t.fc[n]=new Z.FC),t.fc[n].F=255&e.get(),t.fc[n].F>=128&&(t.fc[n].F&=-129,t.fc[n].F=(127&t.fc[n].F)<<8|255&e.get()),t.fc[n].C=i,Z.symbolInit(A[n],t.fc[n].C,t.fc[n].F),t.R||(t.R=Array(4096)),t.R.fill(n,i,i+t.fc[n].F),i+=t.fc[n].F,0===r&&n+1===(255&e.getByteAt(e.position()))?(n=255&e.get(),r=255&e.get()):0!==r?(r-=1,n+=1):n=255&e.get();while(0!==n);ee(i<4096)})(e,A,r),function(e,t,A,r){let i,n=e.getInt(),a=e.getInt(),s=e.getInt(),o=e.getInt(),g=r.remaining(),l=-4&g;for(let i=0;i<l;i+=4){let g=t.R[Z.get(n,12)],l=t.R[Z.get(a,12)],C=t.R[Z.get(s,12)],h=t.R[Z.get(o,12)];r.putAt(i,g),r.putAt(i+1,l),r.putAt(i+2,C),r.putAt(i+3,h),n=Z.advanceSymbolStep(n,A[255&g],12),a=Z.advanceSymbolStep(a,A[255&l],12),s=Z.advanceSymbolStep(s,A[255&C],12),o=Z.advanceSymbolStep(o,A[255&h],12),n=Z.renormalize(n,e),a=Z.renormalize(a,e),s=Z.renormalize(s,e),o=Z.renormalize(o,e)}switch(r.setPosition(l),3&g){case 0:break;case 1:i=t.R[Z.get(n,12)],Z.advanceSymbol(n,e,A[255&i],12),r.put(i);break;case 2:i=t.R[Z.get(n,12)],Z.advanceSymbol(n,e,A[255&i],12),r.put(i),i=t.R[Z.get(a,12)],Z.advanceSymbol(a,e,A[255&i],12),r.put(i);break;case 3:i=t.R[Z.get(n,12)],Z.advanceSymbol(n,e,A[255&i],12),r.put(i),i=t.R[Z.get(a,12)],Z.advanceSymbol(a,e,A[255&i],12),r.put(i),i=t.R[Z.get(s,12)],Z.advanceSymbol(s,e,A[255&i],12),r.put(i);break;default:throw new c("invalid output size encountered during rANS decoding")}r.setPosition(0)}(e,A,r,t)}(r,a);case 1:return function(e,t){let A=Array(256);for(let e=0;e<A.length;e+=1)A[e]=new Z.AriDecoder;let r=Array(256);for(let e=0;e<r.length;e+=1){r[e]=Array(256);for(let t=0;t<r[e].length;t+=1)r[e][t]=new Z.DecodingSymbol}(function(e,t,A){let r=0,i=255&e.get();do{let n=0,a=0,s=255&e.get();null==t[i]&&(t[i]=new Z.AriDecoder);do null==t[i].fc[s]&&(t[i].fc[s]=new Z.FC),t[i].fc[s].F=255&e.get(),t[i].fc[s].F>=128&&(t[i].fc[s].F&=-129,t[i].fc[s].F=(127&t[i].fc[s].F)<<8|255&e.get()),t[i].fc[s].C=a,0===t[i].fc[s].F&&(t[i].fc[s].F=4096),null==A[i][s]&&(A[i][s]=new Z.RansDecSymbol),Z.symbolInit(A[i][s],t[i].fc[s].C,t[i].fc[s].F),null==t[i].R&&(t[i].R=Array(4096)),t[i].R.fill(s,a,a+t[i].fc[s].F),ee((a+=t[i].fc[s].F)<=4096),0===n&&s+1===(255&e.getByteAt(e.position()))?(s=255&e.get(),n=255&e.get()):0!==n?(n-=1,s+=1):s=255&e.get();while(0!==s);0===r&&i+1===(255&e.getByteAt(e.position()))?(i=255&e.get(),r=255&e.get()):0!==r?(r-=1,i+=1):i=255&e.get()}while(0!==i)})(e,A,r),function(e,t,A,r){let i=t.remaining(),n=e.getInt(),a=e.getInt(),s=e.getInt(),o=e.getInt(),g=i>>2,l=0,C=g,h=2*g,I=3*g,d=0,c=0,f=0,u=0;for(;l<g;l+=1,C+=1,h+=1,I+=1){let i=255&A[d].R[Z.get(n,12)],g=255&A[c].R[Z.get(a,12)],B=255&A[f].R[Z.get(s,12)],Q=255&A[u].R[Z.get(o,12)];t.putAt(l,i),t.putAt(C,g),t.putAt(h,B),t.putAt(I,Q),n=Z.advanceSymbolStep(n,r[d][i],12),a=Z.advanceSymbolStep(a,r[c][g],12),s=Z.advanceSymbolStep(s,r[f][B],12),o=Z.advanceSymbolStep(o,r[u][Q],12),n=Z.renormalize(n,e),a=Z.renormalize(a,e),s=Z.renormalize(s,e),o=Z.renormalize(o,e),d=i,c=g,f=B,u=Q}for(;I<i;I+=1){let i=255&A[u].R[Z.get(o,12)];t.putAt(I,i),o=Z.advanceSymbol(o,e,r[u][i],12),u=i}}(e,t,A,r)}(r,a);default:throw new c(`Invalid rANS order: ${i}`)}}(t,e),e}if("rans4x16"===e)return H(t);if("arith"===e)return new v().decode(t);if("fqzcomp"===e)return r=[],function(e,t){let A=e.ReadUint7(),r=function(e){let t={max_sym:0};if(5!=e.ReadByte()){console.error("Invalid FQZComp version number");return}let A=e.ReadByte(),r=1&A?e.ReadByte():1,i=A.nparam>1?A.nparam-1:0,n=Array(256);if(2&A)i=e.ReadByte(),L(e,n,256);else{for(var a=0;a<r;a++)n[a]=a;for(;a<256;a++)n[a]=r-1}t.do_rev=4&A,t.stab=n,t.max_sel=i,t.params=Array(t.nparam);for(let A=0;A<r;A++)t.params[A]=function(e){let t={};t.context=e.ReadUint16(),t.pflags=e.ReadByte(),t.do_dedup=2&t.pflags,t.fixed_len=4&t.pflags,t.do_sel=8&t.pflags,t.do_qmap=16&t.pflags,t.do_pos=32&t.pflags,t.do_delta=64&t.pflags,t.do_qtab=128&t.pflags,t.max_sym=e.ReadByte();let A=e.ReadByte();if(t.qbits=A>>4,t.qshift=15&A,A=e.ReadByte(),t.qloc=A>>4,t.sloc=15&A,A=e.ReadByte(),t.ploc=A>>4,t.dloc=15&A,t.qmap=Array(256),16&t.pflags)for(var r=0;r<t.max_sym;r++)t.qmap[r]=e.ReadByte();else for(var r=0;r<256;r++)t.qmap[r]=r;if(t.qtab=Array(1024),t.qbits>0&&128&t.pflags)L(e,t.qtab,256);else for(var r=0;r<256;r++)t.qtab[r]=r;return t.ptab=Array(1024),32&t.pflags&&L(e,t.ptab,1024),t.dtab=Array(256),64&t.pflags&&L(e,t.dtab,256),t}(e),t.max_sym<t.params[A].max_sym&&(t.max_sym=t.params[A].max_sym);return t}(e);if(!r)return;var i=r.params;let n=Array(t.length),a=function(e){let t={};t.qual=Array(65536);for(var A=0;A<65536;A++)t.qual[A]=new M(e.max_sym+1);t.len=[,,,,];for(var A=0;A<4;A++)t.len[A]=new M(256);return t.rev=new M(2),t.dup=new M(2),e.max_sel>0&&(t.sel=new M(e.max_sel+1)),t}(r),s=new _(e);s.RangeStartDecode(e);let o=new Uint8Array(A),g={qctx:0,prevq:0,delta:0,p:0,s:0,x:0,len:0,is_dup:0,rec:0},l=0;for(;l<A;){if(0==g.p){if(function(e,t,A,r,i,n){i.s=A.max_sel>0?r.sel.ModelDecode(e,t):0,i.x=A.stab[i.s];let a=A.params[i.x];if(a.fixed_len>=0){var s=r.len[0].ModelDecode(e,t);s|=r.len[1].ModelDecode(e,t)<<8,s|=r.len[2].ModelDecode(e,t)<<16,s|=r.len[3].ModelDecode(e,t)<<24,a.fixed_len>0&&(a.fixed_len=-s)}else s=-a.fixed_len;i.len=s,A.do_rev&&(n[i.rec]=r.rev.ModelDecode(e,t)),i.is_dup=0,2&a.pflags&&r.dup.ModelDecode(e,t)&&(i.is_dup=1),i.p=s,i.delta=0,i.qctx=0,i.prevq=0,i.rec++}(e,s,r,a,g,n),g.is_dup>0&&a.dup.ModelDecode(e,s)){for(let e=0;e<len;e++)o[l+e]=o[l+e-g.len];l+=g.len,g.p=0;continue}t.push(g.len);var i=r.params[g.x],C=i.context}let A=a.qual[C].ModelDecode(e,s);o[l++]=i.qmap[A],C=function(e,t,A){let r=e.context;return t.qctx=(t.qctx<<e.qshift)+e.qtab[A],r+=(t.qctx&(1<<e.qbits)-1)<<e.qloc,e.do_pos&&(r+=e.ptab[Math.min(t.p,1023)]<<e.ploc),e.do_delta&&(r+=e.dtab[Math.min(t.delta,255)]<<e.dloc,t.delta+=t.prevq!=A?1:0,t.prevq=A),e.do_sel&&(r+=t.s<<e.sloc),t.p--,65535&r}(i,g,A)}return r.do_rev&&function(e,t,A,r){let i=0,n=0;for(;n<t;){if(A[i]){let t=0,A=r[i]-1;for(;t<A;){let r=e[n+t];e[n+t]=e[n+A],e[n+A]=r,t++,A--}}n+=r[i++]}}(o,A,n,t),o}(new q(t),r);else if("tok3"===e)return function(e){let t=function(e,t,A){var e=new q(e);e.ReadUint32();let r=e.ReadUint32(),i=e.ReadByte(),n=function(e,t,A,r){let i=-1,n=Array(256);for(;!e.EOF();){let t=e.ReadByte(),a=128&t,s=64&t,o=63&t;if(a&&(n[++i]=Array(13)),0!=o&&a){let e=Array(r-1).fill(10);n[i][0]=new q(function(e){let t=new Uint8Array(function(e){let t=0;for(let A of e)t+=A.length;return t}(e)),A=0;for(let r of e)t.set(r,A),A+=r.length;return t}([new Uint8Array(o),e]))}if(s){let t=e.ReadByte(),A=e.ReadByte();n[i][o]=new q(n[t][A].buf)}else{let t=e.ReadUint7(),r=e.ReadData(t);n[i][o]=A?G.decode(r):H(r),n[i][o]=new q(n[i][o])}}return n}(e,0,i,r),a=Array(r),s=Array(r),o="";void 0===A&&(A="\n");for(let e=0;e<r;e++)o+=function(e,t,A,r){let i=e[0][0].ReadByte(),n=r-e[0][i].ReadUint32();if(5==i)return t[r]=t[n],A[r]=A[n],t[r];let a=1;t[r]="",A[r]=Array(256);do{switch(i=e[a][0].ReadByte()){case 2:A[r][a]=e[a][2].ReadChar();break;case 1:A[r][a]=e[a][1].ReadString();break;case 7:A[r][a]=e[a][7].ReadUint32();break;case 3:var s=e[a][3].ReadUint32(),o=e[a][4].ReadByte();A[r][a]=O(s,o);break;case 8:A[r][a]=(A[n][a]>>0)+e[a][8].ReadByte();break;case 9:var s=(A[n][a]>>0)+e[a][9].ReadByte(),o=A[n][a].length;A[r][a]=O(s,o);break;case 10:A[r][a]=A[n][a];break;default:A[r][a]=""}t[r]+=A[r][a++]}while(12!=i);return t[r]}(n,a,s,e)+A;return o}(e,0,"\0");return Uint8Array.from(Array.from(t).map(e=>e.charCodeAt(0)))}(t);else throw new d(`${e} decompression not yet implemented`)}async _uncompress(e,t,A){let r=await this._uncompressPre(e,t,A);if(r.length!==A){let e=new Uint8Array(A);return e.set(r,0),e}return r}async readBlock(e){let{majorVersion:t}=await this.getDefinition(),A=eB(t),r=await this.readBlockHeader(e),i=r._endPosition,n=await this.file.read(r.compressedSize,i),a="raw"!==r.compressionMethod?await this._uncompress(r.compressionMethod,n,r.uncompressedSize):n,s={...r,_endPosition:i,contentPosition:i,content:a};if(t>=3){let t=await this._parseSection(A.cramBlockCrc32,i+r.compressedSize);s.crc32=t.crc32,this.validateChecksums&&await this.checkCrc32(e,r._size+r.compressedSize,t.crc32,"block data"),s._endPosition=t._endPosition,s._size=s.compressedSize+A.cramBlockCrc32.maxLength}else s._endPosition=i+s.compressedSize,s._size=s.compressedSize;return s}}function ev(e,t){let[A,r,i,n,a,s]=t;e[A]||(e[A]=[]),e[A].push({start:r,span:i,containerStart:n,sliceStart:a,sliceBytes:s})}"getDefinition getSectionParsers getSamHeader".split(" ").forEach(e=>{el(eq,e)});class eL{constructor(e){this.filehandle=$(e.url,e.path,e.filehandle)}async parseIndex(){var e;let t={},A=31===(e=await this.filehandle.readFile())[0]&&139===e[1]?er(e):e,r=new DataView(A.buffer);if(A.length>4&&21578050===r.getUint32(0,!0))throw new c("invalid .crai index file. note: file appears to be a .bai index. this is technically legal but please open a github issue if you need support");let i=[],n="";for(let e of A)if(e>=48&&e<=57||!n&&45===e)n+=String.fromCharCode(e);else if(9===e)i.push(Number.parseInt(n,10)),n="";else if(10===e)i.push(Number.parseInt(n,10)),n="",ev(t,i),i=[];else if(13!==e&&32!==e)throw new c("invalid .crai index file");return n&&i.push(Number.parseInt(n,10)),6===i.length&&ev(t,i),Object.entries(t).forEach(([e,A])=>{t[e]=A.sort((e,t)=>e.start-t.start||e.span-t.span)}),t}getIndex(){return this.parseIndexP||(this.parseIndexP=this.parseIndex().catch(e=>{throw this.parseIndexP=void 0,e})),this.parseIndexP}async hasDataForReferenceSequence(e){return!!(await this.getIndex())[e]}async getEntriesForRange(e,t,A){let r=(await this.getIndex())[e];if(!r)return[];let i=e=>{let r=e.start,i=e.start+e.span;return r>A?-1:i<=t?1:0},n=[];for(let e of r)0===i(e)&&n.push(e);return n}}class eU{constructor(e){if(this.cram=e.cram??new eq({url:e.cramUrl,path:e.cramPath,filehandle:e.cramFilehandle,seqFetch:e.seqFetch,checkSequenceMD5:e.checkSequenceMD5,cacheSize:e.cacheSize}),!(this.cram instanceof eq))throw Error("invalid arguments: no cramfile");this.index=e.index}async getRecordsForRange(e,t,A,r={}){if(r.viewAsPairs=r.viewAsPairs||!1,r.pairAcrossChr=r.pairAcrossChr||!1,r.maxInsertSize=r.maxInsertSize||2e5,"string"==typeof e)throw new d("string sequence names not yet supported");let i=await this.index.getEntriesForRange(e,t,A),n=await Promise.all(i.map(r=>this.getRecordsInSlice(r,r=>r.sequenceId===e&&r.alignmentStart<=A&&void 0!==r.lengthOnRef&&r.alignmentStart+r.lengthOnRef-1>=t))),a=Array.prototype.concat(...n);if(r.viewAsPairs){let t={},A={};for(let e of a){let r=e.readName;if(void 0===r)throw Error("readName undefined");let i=e.uniqueId;t[r]||(t[r]=0),t[r]+=1,A[i]=1}let i={};Object.entries(t).forEach(([e,t])=>{1===t&&(i[e]=!0)});let n=[];for(let t of a){let A=t.readName;if(void 0===A)throw Error("readName undefined");if(i[A]&&t.mate&&(t.mate.sequenceId===e||r.pairAcrossChr)&&Math.abs(t.alignmentStart-t.mate.alignmentStart)<r.maxInsertSize){let e=this.index.getEntriesForRange(t.mate.sequenceId,t.mate.alignmentStart,t.mate.alignmentStart+1);n.push(e)}}let s=await Promise.all(n),o=[];for(let e of s)o.push(...e);o=o.sort((e,t)=>e.toString().localeCompare(t.toString())).filter((e,t,A)=>!t||e.toString()!==A[t-1].toString());let g=[],l=[];for(let e of o){let t=this.cram.featureCache.get(e.toString());t||(t=this.getRecordsInSlice(e,()=>!0),this.cram.featureCache.set(e.toString(),t)),g.push(t);let r=t.then(e=>{let t=[];for(let r of e){if(void 0===r.readName)throw Error("readName undefined");i[r.readName]&&!A[r.uniqueId]&&t.push(r)}return t});l.push(r)}let C=await Promise.all(l);if(C.length){let e=C.reduce((e,t)=>e.concat(t));a=a.concat(e)}}return a}getRecordsInSlice({containerStart:e,sliceStart:t,sliceBytes:A},r){return this.cram.getContainerAtPosition(e).getSlice(t,A).getRecords(r)}hasDataForReferenceSequence(e){return this.index.hasDataForReferenceSequence(e)}}var ex=A(77207),eP=A(42382),eH=A(47858),eT=A(61795),eJ=A(52427),eY=A(47368),eG=A(47358),eO=A(15097),eK=A(96764);class ez{constructor(e,t){this.record=e,this._store=t}get name(){return this.record.readName}get start(){return this.record.alignmentStart-1}get end(){var e;return this.start+(null!==(e=this.record.lengthOnRef)&&void 0!==e?e:1)}get score(){return this.record.mappingQuality}get flags(){return this.record.flags}get strand(){return this.record.isReverseComplemented()?-1:1}get qual(){return(this.record.qualityScores||[]).join(" ")}get qualRaw(){return this.record.qualityScores}get refName(){return this._store.refIdToName(this.record.sequenceId)}get pair_orientation(){return this.record.isPaired()?this.record.getPairOrientation():void 0}get template_length(){return this.record.templateLength||this.record.templateSize}get next_ref(){return this.record.mate?this._store.refIdToName(this.record.mate.sequenceId):void 0}get next_segment_position(){return this.record.mate?`${this._store.refIdToName(this.record.mate.sequenceId)}:${this.record.mate.alignmentStart}`:void 0}get is_paired(){return!!this.record.mate}get next_pos(){var e;return null===(e=this.record.mate)||void 0===e?void 0:e.alignmentStart}get tags(){var e;let t=null===(e=this._store.samHeader.readGroups)||void 0===e?void 0:e[this.record.readGroupId];return void 0!==t?{...this.record.tags,RG:t}:this.record.tags}get seq(){return this.record.getReadBases()}get CIGAR(){return function(e,t,A,r){let i="",n="",a="M",s=0;if(!r)return"";let o=r.seq,g=r.start,l=t,C=0,h=0;if(void 0!==e)for(let{code:t,refPos:A,sub:r,data:I}of e)if(C=A-l,i+=o.slice(l-g,A-g),l=A,h>0&&C&&(n+=`${h}I`,h=0),s&&"M"!==a&&(n+=`${s}${a}`,s=0),C&&(a="M",s+=C),"b"===t){let e=String.fromCharCode(...I.split(","));i+=e,l+=e.length,s+=e.length}else"B"===t?(i+=r,l++,s++):"X"===t?(i+=r,l++,s++):"D"===t||"N"===t?(l+=I,s&&(n+=`${s}${a}`),n+=I+t,s=0):"I"===t||"S"===t?(i+=I,s&&(n+=`${s}${a}`),n+=I.length+t,s=0):"i"===t?(s&&(n+=`${s}${a}`),h++,i+=I,s=0):"P"===t?(s&&(n+=`${s}${a}`),n+=`${I}P`):"H"===t&&(s&&(n+=`${s}${a}`),n+=`${I}H`,s=0);else C=A-i.length;return i.length!==A&&(C=A-i.length,i+=o.slice(l-g,l-g+C),s&&"M"!==a&&(n+=`${s}${a}`,s=0),a="M",s+=C),C&&h>0&&(n+=`${h}I`),s&&(n+=`${s}${a}`),n}(this.record.readFeatures,this.record.alignmentStart,this.record.readLength,this.record._refRegion)}id(){return`${this._store.id}-${this.record.uniqueId}`}get(e){return"mismatches"===e?this.mismatches:"qual"===e?this.qual:"CIGAR"===e?this.CIGAR:this.fields[e]}parent(){}children(){}get mismatches(){return function(e,t,A){if(!e)return[];let r=Array(e.length),i=0,n=0,a=0,s=0,o=t;for(let{refPos:g,code:l,pos:C,data:h,sub:I,ref:d}of e)if(s=a-o,o=a,s&&n>0&&(r[i++]={start:a,type:"insertion",base:`${n}`,length:0},n=0),a=g-1-t,"X"===l)r[i++]={start:a,length:1,base:I,qual:null==A?void 0:A[C-1],altbase:null==d?void 0:d.toUpperCase(),type:"mismatch"};else if("I"===l)r[i++]={start:a,type:"insertion",base:`${h.length}`,length:0};else if("N"===l)r[i++]={type:"skip",length:h,start:a,base:"N"};else if("S"===l){let e=h.length;r[i++]={start:a,type:"softclip",base:`S${e}`,cliplen:e,length:1}}else"P"===l||("H"===l?r[i++]={start:a,type:"hardclip",base:`H${h}`,cliplen:h,length:1}:"D"===l?r[i++]={type:"deletion",length:h,start:a,base:"*"}:"b"===l||"q"===l||"B"===l||"i"===l&&n++);return s&&n>0&&(r[i++]={start:a,type:"insertion",base:`${n}`,length:0},n=0),r.slice(0,i)}(this.record.readFeatures,this.start,this.qualRaw)}get fields(){return{start:this.start,name:this.name,end:this.end,score:this.score,strand:this.strand,template_length:this.template_length,flags:this.flags,tags:this.tags,refName:this.refName,seq:this.seq,type:"match",pair_orientation:this.pair_orientation,next_ref:this.next_ref,next_pos:this.next_pos,next_segment_position:this.next_segment_position,uniqueId:this.id()}}toJSON(){return{...this.fields,CIGAR:this.CIGAR,qual:this.qual}}}(0,eK.Cv)(ez,"fields"),(0,eK.Cv)(ez,"CIGAR"),(0,eK.Cv)(ez,"mismatches");class e$ extends ex.BaseFeatureDataAdapter{constructor(){super(...arguments),this.samHeader={},this.ultraLongFeatureCache=new eH.default({maxSize:500}),this.seqIdToOriginalRefName=[]}async configurePre(){let e=this.getConf("cramLocation"),t=this.getConf("craiLocation"),A=this.pluginManager,r=new eU({cramFilehandle:(0,eT.openLocation)(e,A),index:new eL({filehandle:(0,eT.openLocation)(t,A)}),seqFetch:(...e)=>this.seqFetch(...e),checkSequenceMD5:!1});if(!this.getSubAdapter)throw Error("Error getting subadapter");let i=this.getConf("sequenceAdapter");if(!i)throw Error("no sequenceAdapter supplied to CramAdapter config");return{cram:r,sequenceAdapter:(await this.getSubAdapter(i)).dataAdapter}}async configure(){return this.configureP||(this.configureP=this.configurePre().catch(e=>{throw this.configureP=void 0,e})),this.configureP}async getHeader(e){let{cram:t}=await this.configure();return t.cram.getHeaderText()}async seqFetch(e,t,A){t-=1;let{sequenceAdapter:r}=await this.configure(),i=this.refIdToOriginalName(e)||this.refIdToName(e);if(!i)throw Error("unknown");let n=(await (0,eG.z)(r.getFeatures({refName:i,start:t,end:A,assemblyName:""}).pipe((0,eO.q)()))).sort((e,t)=>e.get("start")-t.get("start")).map(e=>{let r=e.get("start"),i=e.get("end"),n=Math.max(t-r,0),a=Math.min(A-r,i-r)-n;return(e.get("seq")||e.get("residues")).slice(n,n+a)}).join(""),a=A-t;if(n.length!==a)throw Error(`fetching ${i}:${(0,eP.toLocale)(t-1)}-${(0,eP.toLocale)(A)} returned ${(0,eP.toLocale)(n.length)} bases, should have returned ${(0,eP.toLocale)(a)}`);return n}async setupPre(e){let t=await this.configure(),{cram:A}=t,r=await A.cram.getSamHeader(),i=[],n={};for(let[e,t]of r.filter(e=>"SQ"===e.tag).entries()){let A=t.data.find(e=>"SN"===e.tag);if(A){let t=A.value;n[t]=e,i[e]=t}}let a={idToName:i,nameToId:n,readGroups:r.filter(e=>"RG"===e.tag).map(e=>{var t;return null===(t=e.data.find(e=>"ID"===e.tag))||void 0===t?void 0:t.value})};return this.samHeader=a,{samHeader:a,...t}}async setupPre2(e){return this.setupP||(this.setupP=this.setupPre(e).catch(e=>{throw this.setupP=void 0,e})),this.setupP}async setup(e){let{statusCallback:t=()=>{}}=e||{};return(0,eP.updateStatus)("Downloading index",t,()=>this.setupPre2(e))}async getRefNames(e){let{samHeader:t}=await this.setup(e);if(!t.idToName)throw Error("CRAM file has no header lines");return t.idToName}refNameToId(e){return this.samHeader.nameToId?this.samHeader.nameToId[e]:this.seqIdToRefName?this.seqIdToRefName.indexOf(e):void 0}refIdToName(e){var t,A;return(null===(t=this.samHeader.idToName)||void 0===t?void 0:t[e])||(null===(A=this.seqIdToRefName)||void 0===A?void 0:A[e])}refIdToOriginalName(e){return this.seqIdToOriginalRefName[e]}getFeatures(e,t){let{stopToken:A,filterBy:r,statusCallback:i=()=>{}}=t||{},{refName:n,start:a,end:s,originalRefName:o}=e;return(0,eJ.ObservableCreate)(async e=>{let{cram:g,samHeader:l}=await this.setup(t),C=this.refNameToId(n);if(void 0===C){console.warn("Unknown refName",n),e.complete();return}o&&(this.seqIdToOriginalRefName[C]=o);let h=await (0,eP.updateStatus)("Downloading alignments",i,()=>g.getRecordsForRange(C,a,s));(0,eY.checkStopToken)(A),await (0,eP.updateStatus)("Processing alignments",i,()=>{var t;let{flagInclude:A=0,flagExclude:i=0,tagFilter:n,readName:a}=r||{};for(let r of h){if((0,eK.qy)(r.flags,A,i)||n&&(0,eK.Gk)("RG"===n.tag?null===(t=l.readGroups)||void 0===t?void 0:t[r.readGroupId]:r.tags[n.tag],n.value)||a&&r.readName!==a)continue;let s=this.ultraLongFeatureCache.get(`${r.uniqueId}`);if(s)e.next(s);else{let t=this.cramRecordToFeature(r);this.ultraLongFeatureCache.set(`${r.uniqueId}`,t),e.next(t)}}e.complete()})},A)}cramRecordToFeature(e){return new ez(e,this)}async getMultiRegionFeatureDensityStats(e,t){return{bytes:await this.bytesForRegions(e,t),fetchSizeLimit:this.getConf("fetchSizeLimit")}}async bytesForRegions(e,t){let{cram:A}=await this.configure();return(await Promise.all(e.map(e=>{let{refName:t,start:r,end:i}=e,n=this.refNameToId(t);return void 0!==n?A.index.getEntriesForRange(n,r,i):[{sliceBytes:0}]}))).flat().reduce((e,t)=>e+t.sliceBytes,0)}}},90442:function(e){var t={utf8:{stringToBytes:function(e){return t.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(t.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],A=0;A<e.length;A++)t.push(255&e.charCodeAt(A));return t},bytesToString:function(e){for(var t=[],A=0;A<e.length;A++)t.push(String.fromCharCode(e[A]));return t.join("")}}};e.exports=t},79625:function(e){var t,A;t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",A={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&A.rotl(e,8)|4278255360&A.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=A.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],A=0,r=0;A<e.length;A++,r+=8)t[r>>>5]|=e[A]<<24-r%32;return t},wordsToBytes:function(e){for(var t=[],A=0;A<32*e.length;A+=8)t.push(e[A>>>5]>>>24-A%32&255);return t},bytesToHex:function(e){for(var t=[],A=0;A<e.length;A++)t.push((e[A]>>>4).toString(16)),t.push((15&e[A]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],A=0;A<e.length;A+=2)t.push(parseInt(e.substr(A,2),16));return t},bytesToBase64:function(e){for(var A=[],r=0;r<e.length;r+=3)for(var i=e[r]<<16|e[r+1]<<8|e[r+2],n=0;n<4;n++)8*r+6*n<=8*e.length?A.push(t.charAt(i>>>6*(3-n)&63)):A.push("=");return A.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/ig,"");for(var A=[],r=0,i=0;r<e.length;i=++r%4)0!=i&&A.push((t.indexOf(e.charAt(r-1))&Math.pow(2,-2*i+8)-1)<<2*i|t.indexOf(e.charAt(r))>>>6-2*i);return A}},e.exports=A},29985:function(e){function t(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}e.exports=function(e){return null!=e&&(t(e)||"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&t(e.slice(0,0))||!!e._isBuffer)}},90684:function(e,t,A){var r,i,n,a,s;r=A(79625),i=A(90442).utf8,n=A(29985),a=A(90442).bin,(s=function(e,t){e.constructor==String?e=t&&"binary"===t.encoding?a.stringToBytes(e):i.stringToBytes(e):n(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||e.constructor===Uint8Array||(e=e.toString());for(var A=r.bytesToWords(e),o=8*e.length,g=1732584193,l=-271733879,C=-1732584194,h=271733878,I=0;I<A.length;I++)A[I]=(A[I]<<8|A[I]>>>24)&16711935|(A[I]<<24|A[I]>>>8)&4278255360;A[o>>>5]|=128<<o%32,A[(o+64>>>9<<4)+14]=o;for(var d=s._ff,c=s._gg,f=s._hh,u=s._ii,I=0;I<A.length;I+=16){var B=g,Q=l,E=C,m=h;g=d(g,l,C,h,A[I+0],7,-680876936),h=d(h,g,l,C,A[I+1],12,-389564586),C=d(C,h,g,l,A[I+2],17,606105819),l=d(l,C,h,g,A[I+3],22,-1044525330),g=d(g,l,C,h,A[I+4],7,-176418897),h=d(h,g,l,C,A[I+5],12,1200080426),C=d(C,h,g,l,A[I+6],17,-1473231341),l=d(l,C,h,g,A[I+7],22,-45705983),g=d(g,l,C,h,A[I+8],7,1770035416),h=d(h,g,l,C,A[I+9],12,-1958414417),C=d(C,h,g,l,A[I+10],17,-42063),l=d(l,C,h,g,A[I+11],22,-1990404162),g=d(g,l,C,h,A[I+12],7,1804603682),h=d(h,g,l,C,A[I+13],12,-40341101),C=d(C,h,g,l,A[I+14],17,-1502002290),l=d(l,C,h,g,A[I+15],22,1236535329),g=c(g,l,C,h,A[I+1],5,-165796510),h=c(h,g,l,C,A[I+6],9,-1069501632),C=c(C,h,g,l,A[I+11],14,643717713),l=c(l,C,h,g,A[I+0],20,-373897302),g=c(g,l,C,h,A[I+5],5,-701558691),h=c(h,g,l,C,A[I+10],9,38016083),C=c(C,h,g,l,A[I+15],14,-660478335),l=c(l,C,h,g,A[I+4],20,-405537848),g=c(g,l,C,h,A[I+9],5,568446438),h=c(h,g,l,C,A[I+14],9,-1019803690),C=c(C,h,g,l,A[I+3],14,-187363961),l=c(l,C,h,g,A[I+8],20,1163531501),g=c(g,l,C,h,A[I+13],5,-1444681467),h=c(h,g,l,C,A[I+2],9,-51403784),C=c(C,h,g,l,A[I+7],14,1735328473),l=c(l,C,h,g,A[I+12],20,-1926607734),g=f(g,l,C,h,A[I+5],4,-378558),h=f(h,g,l,C,A[I+8],11,-2022574463),C=f(C,h,g,l,A[I+11],16,1839030562),l=f(l,C,h,g,A[I+14],23,-35309556),g=f(g,l,C,h,A[I+1],4,-1530992060),h=f(h,g,l,C,A[I+4],11,1272893353),C=f(C,h,g,l,A[I+7],16,-155497632),l=f(l,C,h,g,A[I+10],23,-1094730640),g=f(g,l,C,h,A[I+13],4,681279174),h=f(h,g,l,C,A[I+0],11,-358537222),C=f(C,h,g,l,A[I+3],16,-722521979),l=f(l,C,h,g,A[I+6],23,76029189),g=f(g,l,C,h,A[I+9],4,-640364487),h=f(h,g,l,C,A[I+12],11,-421815835),C=f(C,h,g,l,A[I+15],16,530742520),l=f(l,C,h,g,A[I+2],23,-995338651),g=u(g,l,C,h,A[I+0],6,-198630844),h=u(h,g,l,C,A[I+7],10,1126891415),C=u(C,h,g,l,A[I+14],15,-1416354905),l=u(l,C,h,g,A[I+5],21,-57434055),g=u(g,l,C,h,A[I+12],6,1700485571),h=u(h,g,l,C,A[I+3],10,-1894986606),C=u(C,h,g,l,A[I+10],15,-1051523),l=u(l,C,h,g,A[I+1],21,-2054922799),g=u(g,l,C,h,A[I+8],6,1873313359),h=u(h,g,l,C,A[I+15],10,-30611744),C=u(C,h,g,l,A[I+6],15,-1560198380),l=u(l,C,h,g,A[I+13],21,1309151649),g=u(g,l,C,h,A[I+4],6,-145523070),h=u(h,g,l,C,A[I+11],10,-1120210379),C=u(C,h,g,l,A[I+2],15,718787259),l=u(l,C,h,g,A[I+9],21,-343485551),g=g+B>>>0,l=l+Q>>>0,C=C+E>>>0,h=h+m>>>0}return r.endian([g,l,C,h])})._ff=function(e,t,A,r,i,n,a){var s=e+(t&A|~t&r)+(i>>>0)+a;return(s<<n|s>>>32-n)+t},s._gg=function(e,t,A,r,i,n,a){var s=e+(t&r|A&~r)+(i>>>0)+a;return(s<<n|s>>>32-n)+t},s._hh=function(e,t,A,r,i,n,a){var s=e+(t^A^r)+(i>>>0)+a;return(s<<n|s>>>32-n)+t},s._ii=function(e,t,A,r,i,n,a){var s=e+(A^(t|~r))+(i>>>0)+a;return(s<<n|s>>>32-n)+t},s._blocksize=16,s._digestsize=16,e.exports=function(e,t){if(null==e)throw Error("Illegal argument "+e);var A=r.wordsToBytes(s(e,t));return t&&t.asBytes?A:t&&t.asString?a.bytesToString(A):r.bytesToHex(A)}},8662:function(e,t,A){var r;r=e=>(()=>{"use strict";var t=[,e=>{e.exports="data:application/wasm;base64,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ACABQX9qIgENAAsgAkJ/hSECCyACC8oQAgx/An4CQAJAIAAoAiRFDQAgACgCACECDAELQQAhAiAAQQA6ACggAEIANwMAIABCADcDGCAAQcgAakEAQeQAEIaAgIAAGiAAQawBakEMNgIACyAAIAEoAgQiAzYCECAAQeAAaiEEIABByABqIQUgAEG2AWohBiAAQbABaiEHIABBqAFqIQggASgCECEJAkACQAJAAkADQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQCACDgoBAgAEBQYHCAkKDwsgASgCACEKIAAoAqgBIQIgACgCrAEhCyABKAIEIQwgASgCCCENDAILIAcgACgCqAEiDGogASgCACABKAIEIgJqIAEoAgggAmsiAiAAKAKsASAMayIMIAIgDEkbIgIQh4CAgAAaIAEgASgCBCACajYCBEEAIQwgAEEAIAAoAqgBIAJqIgIgAiAAKAKsASILRhs2AqgBIAIgC0cNESAAQQE2AgACQCAHQaiIgIAAQQYQhICAgABFDQBBBSEMDBILIAZBAkEAEI2AgIAAIAAoALgBRw0QQQYhDCAGLQAADREgACAALQC3ASICNgIgIAJBBEsNEUEBIAJ0QRNxRQ0RCyABKAIEIgwgASgCCCINRg0OAkAgASgCACIKIAxqLQAAIgsNACAAIAw2AhAgASAMQQFqNgIEQQYhAgwMC0EAIQIgAEEANgKoASAAQQI2AgAgACALQQJ0QQRqIgs2AqwBIAAgCzYCQAsgByACaiAKIAxqIA0gDGsiDCALIAJrIgIgDCACSRsiAhCHgICAABogASABKAIEIAJqNgIEQQAhDCAAQQAgACgCqAEgAmoiAiACIAAoAqwBIgtGGzYCqAEgAiALRw0PIAAgAkF8aiICNgKsAUEHIQwgByACQQAQjYCAgAAgByAAKAKsASICaigAAEcNDyAAQQI2AqgBIAAtALEBIgtBP3ENDAJAAkAgC0HAAHFFDQAgACAHIAggAhCRgICAAEEBRw0RIAAgACkDCDcDMCAAKAKsASECIAAtALEBIQsMAQsgAEJ/NwMwC0J/IQ4CQCALwEF/Sg0AIAAgByAIIAIQkYCAgABBAUcNECAAKAKsASECIAApAwghDgsgACAONwM4IAIgACgCqAEiC2tBAkkNDyAAIAtBAWoiCjYCqAEgCCALakEI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AA8LIAEgA0EBaiIFNgIEAkAgASgCACADai0AACAAKQMYIAAoAgQiA62Ip0H/AXFGDQBBBw8LIAAgA0EIaiIGNgIEIAUhAyAGIAJJDQALIABBADYCBCAAQgA3AxhBAQtvAQF/QQchAQJAIABBugFqLwAAQdm0AUcNACAAQbQBakEGQQAQjYCAgAAgAEGwAWooAABHDQAgAEGAAWopAwBCAoggADUAtAFSDQAgAEG4AWotAAANAEEBQQcgACgCICAAQbkBai0AAEYbIQELIAELwAIBA38CQAJAAkAgACgCJA0AIABBADoAKCAAQQA2AgBBASECDAELAkAgACgCAEEKRw0AQQAhAwwCC0ECIQMMAQtBASEDCwJAAkADQAJAAkACQAJAIAMOAwABAwMLIAEoAgQiAyABKAIIIgRGDQQgASgCACEFAkADQCAFIANqLQAADQEgASADQQFqIgM2AgQgACAAKAIEQQFqQQNxNgIEIAQgA0YNBgwACwsCQCAAKAIERQ0AQQcPCyAAKAIkRQ0BIABBADoAKCAAQQA2AgBBASEDDAMLIABCADcDGCAAQQA2AgQgAEHIAGpBAEHkABCGgICAABogAEGsAWpBDDYCAAtBAiEDDAELIAAgARCQgICAACIDQQFHDQIgAEEKNgIAQQAhAwwACwsCQCACDQBBAA8LQQdBASAAKAIEGyEDCyADC3UBAX8CQEG4CRCAgICAACICRQ0AIAIgADYCJCACIAAgARCbgICAACIANgKwCQJAIABFDQAgAkEAOgAoIAJCADcDACACQgA3AxggAkHIAGpBAEHkABCGgICAABogAkGsAWpBDDYCACACDwsgAhCCgICAAAtBAAseAAJAIABFDQAgACgCsAkQnYCAgAAgABCCgICAAAsL3RABCn8gAEHo3QFqIQIgAEHUAGohAyAAQRxqIgRBCGohBQJAAkADQCAAKAJAIQYCQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAgASgCBCIHIAEoAghJDQAgBkEHRg0BDBELIAYOCQECAwQFBgcACQ4LIAAoAkwhBgwHC0EBIQYgASAHQQFqNgIEIAEoAgAgB2otAAAiB0UNCAJAAkAgB0HfAUsNACAHQQFHDQELIABBgAI7AVACQCAAKAI8DQAgACABKAIMIAEoAhAiBmo2AhggACABKAIUIAZr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"},t=>{t.exports=e}],A={};function r(e){var i=A[e];if(void 0!==i)return i.exports;var n=A[e]={exports:{}};return t[e](n,n.exports,r),n.exports}r.d=(e,t)=>{for(var A in t)r.o(t,A)&&!r.o(e,A)&&Object.defineProperty(e,A,{enumerable:!0,get:t[A]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return(()=>{r.r(i),r.d(i,{XzReadableStream:()=>a});var e=r(1);let t=globalThis.ReadableStream||r(2).ReadableStream;class A{constructor(e){this.exports=e.exports,this.memory=this.exports.memory,this.ptr=this.exports.create_context(),this._refresh(),this.bufSize=this.mem32[0],this.inStart=this.mem32[1]-this.ptr,this.inEnd=this.inStart+this.bufSize,this.outStart=this.mem32[4]-this.ptr}supplyInput(e){this._refresh(),this.mem8.subarray(this.inStart,this.inEnd).set(e,0),this.exports.supply_input(this.ptr,e.byteLength),this._refresh()}getNextOutput(){let e=this.exports.get_next_output(this.ptr);if(this._refresh(),0!==e&&1!==e)throw Error(`get_next_output failed with error code ${e}`);return{outChunk:this.mem8.slice(this.outStart,this.outStart+this.mem32[5]),finished:1===e}}needsMoreInput(){return this.mem32[2]===this.mem32[3]}outputBufferIsFull(){return this.mem32[5]===this.bufSize}resetOutputBuffer(){this.outPos=this.mem32[5]=0}dispose(){this.exports.destroy_context(this.ptr),this.exports=null}_refresh(){this.memory.buffer!==this.mem8?.buffer&&(this.mem8=new Uint8Array(this.memory.buffer,this.ptr),this.mem32=new Uint32Array(this.memory.buffer,this.ptr))}}class n{constructor(){this.locked=!1,this.waitQueue=[]}async acquire(){if(!this.locked){this.locked=!0;return}return new Promise(e=>{this.waitQueue.push(e)})}release(){this.waitQueue.length>0?this.waitQueue.shift()():this.locked=!1}}class a extends t{static _moduleInstancePromise;static _moduleInstance;static _contextMutex=new n;static async _getModuleInstance(){let t=e.replace("data:application/wasm;base64,",""),A=Uint8Array.from(atob(t),e=>e.charCodeAt(0)).buffer,r=await WebAssembly.instantiate(A,{});a._moduleInstance=r.instance}constructor(e){let t;let r=null,i=e.getReader();super({async start(e){await a._contextMutex.acquire();try{a._moduleInstance||await (a._moduleInstancePromise||(a._moduleInstancePromise=a._getModuleInstance())),t=new A(a._moduleInstance)}catch(e){throw a._contextMutex.release(),e}},async pull(e){try{if(t.needsMoreInput()){if(null===r||0===r.byteLength){let{done:e,value:t}=await i.read();e||(r=t)}let e=Math.min(t.bufSize,r.byteLength);t.supplyInput(r.subarray(0,e)),r=r.subarray(e)}let A=t.getNextOutput();e.enqueue(A.outChunk),t.resetOutputBuffer(),A.finished&&(t.dispose(),a._contextMutex.release(),e.close())}catch(e){throw t&&t.dispose(),a._contextMutex.release(),e}},cancel(){try{return t&&t.dispose(),i.cancel()}finally{a._contextMutex.release()}}})}}})(),i})(),e.exports=r(A(83534))},89326:function(e,t){"use strict";let A=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];"undefined"!=typeof Int32Array&&(A=new Int32Array(A)),t.Z=(e,t)=>{let r=0===t?0:-1^~~t;for(let t=0;t<e.length;t++)r=A[(r^e[t])&255]^r>>>8;return -1^r}},3549:function(e,t,A){"use strict";A.d(t,{S9:function(){return r}});class r{readFile(){throw Error("unimplemented")}read(){throw Error("unimplemented")}close(){throw Error("unimplemented")}}},9762:function(e,t,A){"use strict";function r(e){return("object"==typeof e&&null!==e&&"message"in e?e.message:`${e}`).replace(/\.$/,"")}A.d(t,{Z:function(){return i}});class i{constructor(e,t={}){this.baseOverrides={},this.url=e;let A=t.fetch||globalThis.fetch.bind(globalThis);t.overrides&&(this.baseOverrides=t.overrides),this.fetchImplementation=A}async fetch(e,t){let A;try{A=await this.fetchImplementation(e,t)}catch(i){if(`${i}`.includes("Failed to fetch")){console.warn(`generic-filehandle: refetching ${e} to attempt to work around chrome CORS header caching bug`);try{A=await this.fetchImplementation(e,{...t,cache:"reload"})}catch(t){throw Error(`${r(t)} fetching ${e}`,{cause:t})}}else throw Error(`${r(i)} fetching ${e}`,{cause:i})}return A}async read(e,t,A={}){let{headers:r={},signal:i,overrides:n={}}=A;e<1/0?r.range=`bytes=${t}-${t+e}`:e===1/0&&0!==t&&(r.range=`bytes=${t}-`);let a=await this.fetch(this.url,{...this.baseOverrides,...n,headers:{...r,...n.headers,...this.baseOverrides.headers},method:"GET",redirect:"follow",mode:"cors",signal:i});if(!a.ok)throw Error(`HTTP ${a.status} fetching ${this.url}`);if(200===a.status&&0===t||206===a.status){let t=await a.arrayBuffer(),A=a.headers.get("content-range"),r=/\/(\d+)$/.exec(A||"");return r?.[1]&&(this._stat={size:parseInt(r[1],10)}),new Uint8Array(t.slice(0,e))}if(200===a.status)throw Error(`${this.url} fetch returned status 200, expected 206`);throw Error(`HTTP ${a.status} fetching ${this.url}`)}async readFile(e={}){let t,A;"string"==typeof e?(t=e,A={}):(t=e.encoding,A=e,delete A.encoding);let{headers:r={},signal:i,overrides:n={}}=A,a=await this.fetch(this.url,{headers:r,method:"GET",redirect:"follow",mode:"cors",signal:i,...this.baseOverrides,...n});if(200!==a.status)throw Error(`HTTP ${a.status} fetching ${this.url}`);if("utf8"===t)return a.text();if(!t)return new Uint8Array(await a.arrayBuffer());throw Error(`unsupported encoding: ${t}`)}async stat(){if(!this._stat&&(await this.read(10,0),!this._stat))throw Error(`unable to determine size of file at ${this.url}`);return this._stat}async close(){}}}}]);