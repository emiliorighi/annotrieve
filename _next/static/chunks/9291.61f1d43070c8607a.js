"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9291],{19291:function(e,o,l){l.d(o,{drawDensity:function(){return a}});var r=l(87290),t=l(42382),n=l(47368),c=l(35057);function a(e,o){let{stopToken:l,features:a,regions:f,bpPerPx:i,scaleOpts:p,height:u,config:s}=o,C=f[0],b=(0,r.readConfObject)(s,"bicolorPivot"),d=(0,r.readConfObject)(s,"bicolorPivotValue"),g=(0,r.readConfObject)(s,"negColor"),S=(0,r.readConfObject)(s,"posColor"),h=(0,r.readConfObject)(s,"color"),k=(0,r.readConfObject)(s,"clipColor"),m="none"!==b&&"log"!==p.scaleType,v=(0,c.getScale)({...p,pivotValue:m?d:void 0,range:m?[g,"#eee",S]:["#eee",S]}),w=(0,c.getScale)({...p,range:[0,u]}),j="#f0f"===h?(e,o)=>v(o):(e,o)=>(0,r.readConfObject)(s,"color",{feature:e,score:o}),O=w.domain(),y=O[0],N=O[1],T=Number.NEGATIVE_INFINITY,_=!1,x=[],E=performance.now();for(let o of a.values()){performance.now()-E>400&&((0,n.checkStopToken)(l),E=performance.now());let[r,c]=(0,t.featureSpanPx)(o,C,i);(Math.floor(r)!==Math.floor(T)||c-r>1)&&(x.push(o),T=r);let a=o.get("score");_=_||a>N||a<y;let f=c-r+.3;a>=p.domain[0]?e.fillStyle=j(o,a):e.fillStyle="#eee",e.fillRect(r,0,f,u)}if(e.save(),_)for(let o of(e.fillStyle=k,a.values())){performance.now()-E>400&&((0,n.checkStopToken)(l),E=performance.now());let[r,a]=(0,t.featureSpanPx)(o,C,i),f=a-r+.3,u=o.get("score");u>N?(0,c.fillRectCtx)(r,0,f,2,e):u<y&&"log"!==p.scaleType&&(0,c.fillRectCtx)(r,0,f,2,e)}return e.restore(),{reducedFeatures:x}}}}]);