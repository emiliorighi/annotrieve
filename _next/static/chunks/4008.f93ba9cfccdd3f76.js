"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4008],{64008:function(e,t,a){a.r(t);var s=a(33224),n=a(19814),i=a(77207),r=a(42382),o=a(61795),c=a(52427),u=a(47368),l=a(91666);class h extends i.BaseFeatureDataAdapter{constructor(e,t,a){super(e,t,a);let i=this.getConf("bedGzLocation"),r=this.getConf(["index","indexType"]),c=this.getConf(["index","location"]),u=this.getConf("autoSql"),l=this.pluginManager;this.bed=new n.pC({filehandle:(0,o.openLocation)(i,l),csiFilehandle:"CSI"===r?(0,o.openLocation)(c,l):void 0,tbiFilehandle:"CSI"!==r?(0,o.openLocation)(c,l):void 0,chunkCacheSize:52428800}),this.columnNames=this.getConf("columnNames"),this.scoreColumn=this.getConf("scoreColumn"),this.parser=new s.Z({autoSql:u})}async getRefNames(e={}){return this.bed.getReferenceSequenceNames(e)}async getHeader(e){return this.bed.getHeader(e)}async getMetadataPre2(e){return this.setupP||(this.setupP=this.getMetadataPre().catch(e=>{throw this.setupP=void 0,e})),this.setupP}async getMetadataPre(){return{meta:await this.bed.getMetadata()}}async getMetadata(e){let{statusCallback:t=()=>{}}=e||{};return(0,r.updateStatus)("Downloading index",t,()=>this.getMetadataPre2(e))}async getNames(){if(this.columnNames.length)return this.columnNames;let e=(await this.getHeader()).split(/\n|\r\n|\r/).filter(e=>!!e).at(-1);return(null==e?void 0:e.includes("	"))?e.slice(1).split("	").map(e=>e.trim()):void 0}getFeatures(e,t){let{stopToken:a,statusCallback:s=()=>{}}=t||{};return(0,c.ObservableCreate)(async t=>{let{meta:n}=await this.getMetadata(),{columnNumbers:i}=n,o=i.ref-1,c=i.start-1,h=i.end-1,d=await this.getNames(),p=performance.now();(0,u.checkStopToken)(a),await (0,r.updateStatus)("Downloading features",s,()=>this.bed.getLines(e.refName,e.start,e.end,{lineCallback:(e,s)=>{performance.now()-p>200&&((0,u.checkStopToken)(a),p=performance.now()),t.next(new r.SimpleFeature((0,l.PT)({line:e,colRef:o,colStart:c,colEnd:h,scoreColumn:this.scoreColumn,parser:this.parser,uniqueId:`${this.id}-${s}`,names:d})))},stopToken:a})),t.complete()},a)}}h.capabilities=["getFeatures","getRefNames"],t.default=h}}]);