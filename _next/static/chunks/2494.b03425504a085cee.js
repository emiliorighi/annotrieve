"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2494],{92494:function(e,t,n){n.r(t),n.d(t,{default:function(){return c}});var i=n(19814),a=n(77207),s=n(42382),r=n(61795),l=n(91951),o=n(52427),d=n(12307),u=n(61338),f=n(82073);class c extends a.BaseFeatureDataAdapter{async configurePre(e){let t=this.getConf("gffGzLocation"),n=this.getConf(["index","indexType"]),a=this.getConf(["index","location"]),s=this.getConf("dontRedispatch"),l=new i.pC({filehandle:(0,r.openLocation)(t,this.pluginManager),csiFilehandle:"CSI"===n?(0,r.openLocation)(a,this.pluginManager):void 0,tbiFilehandle:"CSI"!==n?(0,r.openLocation)(a,this.pluginManager):void 0,chunkCacheSize:52428800,renameRefSeqs:e=>e});return{gff:l,dontRedispatch:s,header:await l.getHeader()}}async configurePre2(){return this.configured||(this.configured=this.configurePre().catch(e=>{throw this.configured=void 0,e})),this.configured}async configure(e){let{statusCallback:t=()=>{}}=e||{};return(0,s.updateStatus)("Downloading index",t,()=>this.configurePre2())}async getRefNames(e={}){let{gff:t}=await this.configure(e);return t.getReferenceSequenceNames(e)}async getHeader(e={}){let{gff:t}=await this.configure(e);return t.getHeader()}getFeatures(e,t={}){return(0,o.ObservableCreate)(async n=>{let{gff:i}=await this.configure(t),a=await i.getMetadata();await this.getFeaturesHelper(e,t,a,n,!0)},t.stopToken)}async getFeaturesHelper(e,t,n,i,a,r=e){var o,c;let{statusCallback:h=()=>{}}=t;try{let g=[],{dontRedispatch:p,gff:w}=await this.configure(t);if(await (0,s.updateStatus)("Downloading features",h,()=>w.getLines(e.refName,e.start,e.end,(e,t)=>{g.push(this.parseLine(n.columnNumbers,e,t))})),a&&g.length){let a=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;for(let e of g){let t=e.fields[2];if(!p.includes(t)){let t=e.start-1;t<a&&(a=t),e.end>s&&(s=e.end)}}if(s>e.end||a<e.start){await this.getFeaturesHelper({...e,start:a,end:s},t,n,i,!1,e);return}}let H=g.map(e=>(e.fields[8]&&"."!==e.fields[8]?e.fields[8].includes("_lineHash")||(e.fields[8]+=`;_lineHash=${e.lineHash}`):e.fields[8]=`_lineHash=${e.lineHash}`,e.fields.join("	"))).join("\n");for(let e of(0,u.X)(H))for(let t of e){let e=new d.default({data:(0,f.P)(t),id:`${this.id}-offset-${null===(c=null===(o=t.attributes)||void 0===o?void 0:o._lineHash)||void 0===c?void 0:c[0]}`});(0,l.doesIntersect2)(e.get("start"),e.get("end"),r.start,r.end)&&i.next(e)}i.complete()}catch(e){i.error(e)}}parseLine(e,t,n){let i=t.split("	");return{start:+i[e.start-1],end:+i[e.end-1],lineHash:n,fields:i}}}}}]);