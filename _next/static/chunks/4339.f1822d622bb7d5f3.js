"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4339],{34339:function(e,t,o){o.r(t),o.d(t,{default:function(){return ee}});var n=o(57437),r=o(2265),l=o(50611),i=o(98746),a=o.n(i),s=o(88654),d=o(47198),u=o(67790);function c({value:e,ref:t}){let[o,l]=(0,r.useState)(!1);return(0,u.ai)(t,e)!==e?(0,n.jsxs)("div",{children:[(0,n.jsx)("button",{onClick:()=>{l(!o)},children:o?"Show simplified ALT":"Show raw ALT"})," ",o?e:(0,u.ai)(t,e)]}):e}var f=o(49211),p=o.n(f);function h({value:e}){let[t,o]=(0,r.useState)(!1),[l,i]=(0,r.useState)(!1),a=String(e);return a.length>100?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{type:"button",onClick:()=>{p()(a),i(!0),setTimeout(()=>{i(!1)},700)},children:l?"Copied to clipboard":"Copy"}),(0,n.jsx)("button",{type:"button",onClick:()=>{o(e=>!e)},children:t?"Show less":"Show more"}),(0,n.jsx)("div",{children:t?a:`${a.slice(0,100)}...`})]}):(0,n.jsx)("div",{children:a})}var m=o(15219),g=o.n(m),v=o(98833),x=o(45347),b=o(23230),j=o(42382),y=o(90658),T=o(61994),B=o(7609),w=o(1589),S=o(1190),N=o(42318),Z=o(51661),C=o(15245),O=o(95916);function R(e){return(0,O.ZP)("MuiToggleButtonGroup",e)}let G=(0,C.Z)("MuiToggleButtonGroup",["root","selected","horizontal","vertical","disabled","grouped","groupedHorizontal","groupedVertical","fullWidth","firstButton","lastButton","middleButton"]);var F=o(45559),$=o(28435),k=o(35554);let L=e=>{let{classes:t,orientation:o,fullWidth:n,disabled:r}=e,l={root:["root",o,n&&"fullWidth"],grouped:["grouped","grouped".concat((0,Z.Z)(o)),r&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return(0,B.Z)(l,R,t)},A=(0,w.ZP)("div",{name:"MuiToggleButtonGroup",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:o}=e;return[{["& .".concat(G.grouped)]:t.grouped},{["& .".concat(G.grouped)]:t["grouped".concat((0,Z.Z)(o.orientation))]},{["& .".concat(G.firstButton)]:t.firstButton},{["& .".concat(G.lastButton)]:t.lastButton},{["& .".concat(G.middleButton)]:t.middleButton},t.root,"vertical"===o.orientation&&t.vertical,o.fullWidth&&t.fullWidth]}})((0,S.Z)(e=>{let{theme:t}=e;return{display:"inline-flex",borderRadius:(t.vars||t).shape.borderRadius,variants:[{props:{orientation:"vertical"},style:{flexDirection:"column",["& .".concat(G.grouped)]:{["&.".concat(G.selected," + .").concat(G.grouped,".").concat(G.selected)]:{borderTop:0,marginTop:0}},["& .".concat(G.firstButton,",& .").concat(G.middleButton)]:{borderBottomLeftRadius:0,borderBottomRightRadius:0},["& .".concat(G.lastButton,",& .").concat(G.middleButton)]:{marginTop:-1,borderTop:"1px solid transparent",borderTopLeftRadius:0,borderTopRightRadius:0},["& .".concat(G.lastButton,".").concat(k.Z.disabled,",& .").concat(G.middleButton,".").concat(k.Z.disabled)]:{borderTop:"1px solid transparent"}}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{orientation:"horizontal"},style:{["& .".concat(G.grouped)]:{["&.".concat(G.selected," + .").concat(G.grouped,".").concat(G.selected)]:{borderLeft:0,marginLeft:0}},["& .".concat(G.firstButton,",& .").concat(G.middleButton)]:{borderTopRightRadius:0,borderBottomRightRadius:0},["& .".concat(G.lastButton,",& .").concat(G.middleButton)]:{marginLeft:-1,borderLeft:"1px solid transparent",borderTopLeftRadius:0,borderBottomLeftRadius:0},["& .".concat(G.lastButton,".").concat(k.Z.disabled,",& .").concat(G.middleButton,".").concat(k.Z.disabled)]:{borderLeft:"1px solid transparent"}}}]}})),E=r.forwardRef(function(e,t){let o=(0,N.i)({props:e,name:"MuiToggleButtonGroup"}),{children:l,className:i,color:a="standard",disabled:s=!1,exclusive:d=!1,fullWidth:u=!1,onChange:c,orientation:f="horizontal",size:p="medium",value:h,...m}=o,g={...o,disabled:s,fullWidth:u,orientation:f,size:p},v=L(g),x=r.useCallback((e,t)=>{let o;if(!c)return;let n=h&&h.indexOf(t);h&&n>=0?(o=h.slice()).splice(n,1):o=h?h.concat(t):[t],c(e,o)},[c,h]),b=r.useCallback((e,t)=>{c&&c(e,h===t?null:t)},[c,h]),j=r.useMemo(()=>({className:v.grouped,onChange:d?b:x,value:h,size:p,fullWidth:u,color:a,disabled:s}),[v.grouped,d,b,x,h,p,u,a,s]),y=r.Children.toArray(l).filter(e=>r.isValidElement(e)),B=y.length,w=e=>{let t=0===e,o=e===B-1;return t&&o?"":t?v.firstButton:o?v.lastButton:v.middleButton};return(0,n.jsx)(A,{role:"group",className:(0,T.Z)(v.root,i),ref:t,ownerState:g,...m,children:(0,n.jsx)(F.Z.Provider,{value:j,children:y.map((e,t)=>(0,n.jsx)($.Z.Provider,{value:w(t),children:e},t))})})});var I=o(21561),q=o(28729),H=o(37926),M=o(793);function P({checked:e,disabled:t,label:o,onChange:r}){return(0,n.jsx)(H.Z,{disabled:t,control:(0,n.jsx)(M.Z,{checked:e,onChange:r}),label:(0,n.jsx)(y.Z,{variant:"body2",children:o})})}function z({rows:e}){let[t,o]=(0,r.useState)(!1),l={};if(t)for(let t of e){let e={};for(let o of t.GT.split(/[/|]/))e[o]=(e[o]||0)+1;let o=Object.entries(e).map(([e,t])=>`${e}:${t}`).join(";");l[o]||(l[o]={count:0,GT:o,genotype:t.genotype}),l[o].count++}else for(let t of e){let e=t.GT;l[e]||(l[e]={count:0,GT:t.GT,genotype:t.genotype}),l[e].count++}let i=Object.entries(l).map(([t,o])=>({id:t,...o,count:`${o.count} / ${e.length}`,frequency:`${(o.count/e.length*100).toPrecision(3)}%`})),a=(i[0]?Object.keys(i[0]):[]).map(e=>(0,j.measureGridWidth)(i.map(t=>`${t[e]}`)));return(0,n.jsxs)("div",{children:[(0,n.jsx)(H.Z,{control:(0,n.jsx)(M.Z,{checked:t}),label:(0,n.jsx)(y.Z,{variant:"body2",children:"Use allele counts instead of exact GT"}),onChange:(e,t)=>{o(t)}}),(0,n.jsx)(x.default,{children:(0,n.jsx)(q._,{rows:i,hideFooter:!0,rowHeight:25,columnHeaderHeight:35,columns:[{field:"GT",width:a[0]},{field:"count",width:a[1]},{field:"frequency",width:a[2]},{field:"genotype",width:a[3]}]})})]})}var W=o(31835);function _({columns:e,filter:t,setFilter:o}){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(y.Z,{children:"These filters can use a plain text search or regex style query, e.g. in the genotype field, entering 1 will query for all genotypes that include the first alternate allele e.g. 0|1 or 1|1, entering [1-9]\\d* will find any non-zero allele e.g. 0|2 or 2/33"}),e.map(({field:e})=>(0,n.jsx)(W.Z,{placeholder:`Filter ${e}`,value:t[e]||"",onChange:n=>{o({...t,[e]:n.target.value})}},`filter-${e}`))]})}function D(e){let{feature:t,descriptions:o={}}=e,[l,i]=(0,r.useState)({}),[a,s]=(0,r.useState)("all"),[d,c]=(0,r.useState)(!1),f=t.samples||{},p=t.ALT,{rows:h,error:m}=function(e,t,o,n){let r;let l=Object.entries(e).map(([e,n])=>{var r;let l=null===(r=n.GT)||void 0===r?void 0:r[0];return[e,{...n,...l?{GT:`${l}`,genotype:(0,u.wQ)(`${l}`,t,o)}:{}}]}),i=[],a=Object.keys(n);try{i=l.map(([e,t])=>({...Object.fromEntries(Object.entries(t).map(([e,t])=>[e,t])),sample:e,id:e})).filter(e=>!a.length||a.every(t=>{let o=n[t];return!o||RegExp(o,"i").exec(e[t])}))}catch(e){console.error(e),r=e}return{rows:i,error:r}}(f,t.REF,p,l),T=new Set(["sample",...Object.keys(h[0]||{})]);T.delete("id");let B=[...T],w=B.map(e=>(0,j.measureGridWidth)(h.map(t=>t[e]))),S=B.map((e,t)=>{var n,r;return{field:e,description:null===(r=null===(n=null==o?void 0:o.FORMAT)||void 0===n?void 0:n[e])||void 0===r?void 0:r.Description,width:w[t]}}),N=new Set(["sample","GT"]),Z=new Set(["sample","GT","genotype"]);return h.length?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(g(),{...e,title:"Genotype frequencies",children:(0,n.jsx)(b.ErrorBoundary,{FallbackComponent:v.ErrorMessage,children:(0,n.jsx)(z,{rows:h})})}),(0,n.jsxs)(g(),{...e,title:"Samples",children:[m?(0,n.jsx)(y.Z,{color:"error",children:`${m}`}):null,(0,n.jsxs)("div",{children:[(0,n.jsx)(P,{label:"Show filters",checked:d,onChange:e=>{c(e.target.checked)}}),(0,n.jsxs)(E,{value:a,exclusive:!0,size:"small",onChange:(e,t)=>{null!==t&&s(t)},children:[(0,n.jsx)(I.Z,{value:"all",children:"All"}),(0,n.jsx)(I.Z,{value:"gtOnly",children:"GT only"}),(0,n.jsx)(I.Z,{value:"genotypeOnly",children:"GT+resolved genotype"})]})]}),d?(0,n.jsx)(_,{setFilter:i,columns:S,filter:l}):null,(0,n.jsx)(x.default,{children:(0,n.jsx)(q._,{rows:h,hideFooter:h.length<100,columns:"gtOnly"===a?S.filter(e=>N.has(e.field)):"genotypeOnly"===a?S.filter(e=>Z.has(e.field)):S,rowHeight:25,columnHeaderHeight:35,showToolbar:!0})})]})]}):null}let Q={CHROM:"chromosome: An identifier from the reference genome",POS:"position: The reference position, with the 1st base having position 1",ID:"identifier: Semi-colon separated list of unique identifiers where available",REF:"reference base(s): Each base must be one of A,C,G,T,N (case insensitive).",ALT:"alternate base(s): Comma-separated list of alternate non-reference alleles",QUAL:"quality: Phred-scaled quality score for the assertion made in ALT",FILTER:"filter status: PASS if this position has passed all filters, otherwise a semicolon-separated list of codes for filters that fail"},V=(0,r.lazy)(()=>o.e(4717).then(o.bind(o,24717))),J=(0,r.lazy)(()=>o.e(7775).then(o.bind(o,57775)));function U({descriptions:e,feature:t}){var o,r,l,i,a;let s=null===(r=null===(o=null==e?void 0:e.INFO)||void 0===o?void 0:o.ANN)||void 0===r?void 0:r.Description,d=(null===(i=null===(l=null==s?void 0:s.match(/.*Functional annotations:'(.*)'$/))||void 0===l?void 0:l[1])||void 0===i?void 0:i.split("|"))||[],u=(null===(a=t.INFO)||void 0===a?void 0:a.ANN)||[];return(0,n.jsx)(J,{fields:d,data:u,title:"Variant ANN field"})}function K({descriptions:e,feature:t}){var o,r,l,i,a;let s=null===(r=null===(o=null==e?void 0:e.INFO)||void 0===o?void 0:o.CSQ)||void 0===r?void 0:r.Description,d=(null===(i=null===(l=null==s?void 0:s.match(/.*Format: (.*)/))||void 0===l?void 0:l[1])||void 0===i?void 0:i.split("|"))||[],u=(null===(a=t.INFO)||void 0===a?void 0:a.CSQ)||[];return(0,n.jsx)(J,{fields:d,data:u,title:"Variant CSQ field"})}function X({model:e}){let{featureData:t}=e,o=JSON.parse(JSON.stringify(t)),{type:r=""}=o;return"breakend"===r?(0,n.jsx)(V,{feature:o,locStrings:o.ALT.map(e=>{var t;return(null===(t=(0,l.I)(e))||void 0===t?void 0:t.MatePosition)||""}),model:e}):"translocation"===r?(0,n.jsx)(V,{feature:o,model:e,locStrings:[`${o.INFO.CHR2[0]}:${o.INFO.END}`]}):"paired_feature"===r?(0,n.jsx)(V,{feature:o,model:e,locStrings:[`${o.mate.refName}:${o.mate.start}`]}):r.includes("inversion")||r.includes("deletion")||r.includes("duplication")||r.includes("cnv")||r.includes("sv")?(0,n.jsx)(V,{feature:{uniqueId:"random",refName:o.refName,start:o.start,end:o.start+1,mate:{refName:o.refName,start:o.end,end:o.end+1}},model:e,locStrings:[`${o.refName}:${o.end}`]}):null}let Y=(0,d.observer)(function(e){let{feat:t,model:o}=e,{descriptions:l}=o,{samples:i,...d}=t,{REF:u}=d;return(0,n.jsxs)(s.Z,{"data-testid":"variant-side-drawer",children:[(0,n.jsx)(a(),{feature:d,descriptions:{...Q,...l},formatter:(e,t)=>"ALT"===t?(0,n.jsx)(c,{value:`${e}`,ref:u}):(0,n.jsx)(h,{value:e}),...e}),(0,n.jsxs)(r.Suspense,{fallback:null,children:[(0,n.jsx)(K,{feature:d,descriptions:l}),(0,n.jsx)(U,{feature:d,descriptions:l}),(0,n.jsx)(X,{model:o})]}),(0,n.jsx)(D,{feature:t,...e,descriptions:l})]})});var ee=(0,d.observer)(function(e){let{model:t}=e,{featureData:o}=t,r=structuredClone(o);return r?(0,n.jsx)(Y,{feat:r,...e}):(0,n.jsx)("div",{children:"No feature loaded, may not be available after page refresh because it was too large for localStorage"})})}}]);