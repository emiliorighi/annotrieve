"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2766],{62766:function(e,t,n){n.r(t),n.d(t,{default:function(){return R}});var l=n(57437),r=n(2265),i=n(13889),o=n.n(i),s=n(42382),a=n(17725),c=n(77639),d=n(17764),h=n(3905),u=n(98833),m=n(90658),p=n(31835);let x=(0,h.makeStyles)()({textAreaFont:{fontFamily:"Courier New"}});function f({onClose:e,currLayout:t}){let{classes:n}=x(),[i,o]=(0,r.useState)(""),[s,h]=(0,r.useState)();return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(a.Z,{children:[(0,l.jsx)(m.Z,{children:'Paste CSV or TSV. If a header column is present. First line is a header. If a column called "name" is present, it uses that to connect to IDs in the table, otherwise it uses the first column no.'}),s?(0,l.jsx)(u.ErrorMessage,{error:s}):null,(0,l.jsx)(p.Z,{variant:"outlined",multiline:!0,minRows:5,placeholder:"name,population\nHG00098,GBR\nHG00101,GBR\nHG00459,CHS\n...",maxRows:10,fullWidth:!0,value:i,onChange:e=>{o(e.target.value)},slotProps:{input:{classes:{input:n.textAreaFont}}}})]}),(0,l.jsxs)(d.Z,{children:[(0,l.jsx)(c.Z,{variant:"contained",color:"secondary",onClick:()=>{let n=i.split("\n").map(e=>e.trim()).filter(e=>!!e),l=n[0].split(/[,\t]/gm);if(l.includes("name")){h("");let r=Object.fromEntries(t.map(e=>[e.name,e])),i=Object.fromEntries(n.slice(1).map(e=>{let t=Object.fromEntries(e.split(/[,\t]/gm).map((e,t)=>[l[t],e]));return[t.name,{...t,...r[t.name]}]}));e(t.map(e=>({...e,...i[e.name]})))}else h(Error('No "name" column found on line 1'))},children:"Update rows"}),(0,l.jsx)(c.Z,{variant:"contained",color:"primary",onClick:()=>{let n=i.split("\n").map(e=>e.trim()).filter(e=>!!e),l=n[0].split(/[,\t]/gm);if(l.includes("name")){h("");let r=Object.fromEntries(t.map(e=>[e.name,e])),i=Object.fromEntries(n.slice(1).map(e=>{let t=Object.fromEntries(e.split(/[,\t]/gm).map((e,t)=>[l[t],e]));return[t.name,{...t,...r[t.name]}]}));e(t.map(e=>({...i[e.name]})))}else h(Error('No "name" column found on line 1'))},children:"Replace rows"}),(0,l.jsx)(c.Z,{variant:"contained",color:"inherit",onClick:()=>{e()},children:"Cancel"})]})]})}function j(){return(0,l.jsxs)(l.Fragment,{children:["Helpful tips",(0,l.jsxs)("ul",{children:[(0,l.jsx)("li",{children:"You can select rows in the table with the checkboxes"}),(0,l.jsx)("li",{children:"Multi-select is enabled with shift-click and control-click"}),(0,l.jsx)("li",{children:'The "Move selected items up/down" can re-arrange subtracks'}),(0,l.jsx)("li",{children:"Sorting the data grid itself can also re-arrange subtracks"}),(0,l.jsx)("li",{children:"Changes are applied when you hit Submit"}),(0,l.jsx)("li",{children:"You can click and drag the dialog box to move it on the screen"}),(0,l.jsx)("li",{children:"Columns in the table can be hidden using a vertical '...' menu on the right side of each column"})]})]})}var g=n(95),C=n(40241);function b({setCurrLayout:e,currLayout:t}){var n;return(0,l.jsxs)("div",{children:["Create color palette based on...",Object.keys(null!==(n=t[0])&&void 0!==n?n:[]).filter(e=>"name"!==e&&"color"!==e&&"label"!==e&&"id"!==e&&"HP"!==e).map(n=>(0,l.jsx)(c.Z,{variant:"contained",color:"inherit",onClick:()=>{let l=new Map;for(let e of t){let t=l.get(e[n]);t?l.set(e[n],t+1):l.set(e[n],1)}let r=Object.fromEntries([...l.entries()].sort((e,t)=>e[1]-t[1]).map((e,t)=>[e[0],g.set1[t]||(0,C.p)(e[0])]));e(t.map(e=>({...e,color:r[e[n]]})))},children:n},n)),(0,l.jsx)(c.Z,{onClick:()=>{e(t.map(e=>({...e,color:void 0})))},children:"Clear colors"})]})}var v=n(14478),w=n.n(v),k=n(28729);let S=(0,h.makeStyles)()({cell:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}});function Z({rows:e,onChange:t,setSelected:n}){let{classes:i}=S(),{id:o,name:a,label:c,color:d,baseUri:h,HP:m,...p}=e[0],[x,f]=(0,r.useState)({idx:0,field:null});return(0,l.jsx)("div",{style:{height:400,width:"100%"},children:(0,l.jsx)(k._,{checkboxSelection:!0,disableRowSelectionOnClick:!0,onRowSelectionModelChange:e=>{n([...e.ids])},rows:e,rowHeight:25,columnHeaderHeight:33,columns:[{field:"color",headerName:"Color",renderCell:n=>{let{value:r,id:i}=n;return(0,l.jsx)(w(),{color:r||"blue",onChange:n=>{let l=e.find(e=>e.name===i);l&&(l.color=n),t([...e])}})}},{field:"label",headerName:"Name",width:(0,s.measureGridWidth)(e.map(e=>e.label))},...Object.keys(p).map(t=>({field:t,renderCell:({value:e})=>(0,l.jsx)("div",{className:i.cell,children:(0,l.jsx)(u.SanitizedHTML,{html:(0,s.getStr)(e)})}),width:(0,s.measureGridWidth)(e.map(e=>`${e[t]}`))}))],sortModel:[],onSortModelChange:n=>{let l=n[0],r=(x.idx+1)%2,i=l.field||x.field;f({idx:r,field:i}),t(i?[...e].sort((e,t)=>{let n=(0,s.getStr)(e[i]),l=(0,s.getStr)(t[i]);return 1===r?n.localeCompare(l):l.localeCompare(n)}):e)}})})}var y=n(93982),M=n(50797),E=n(20168),N=n(79916);function H(e,t,n=1){let l=t.map(t=>e.findIndex(e=>e.name===t)).sort((e,t)=>e-t),r=0;for(let t of l){let l=Math.max(r,t-n);l>=r&&e.splice(l,0,e.splice(t,1)[0]),r+=1}return e}function O(e,t,n=1){let l=t.map(t=>e.findIndex(e=>e.name===t)).sort((e,t)=>t-e),r=e.length-1;for(let t of l){let l=Math.min(r,t+n);l<=r&&e.splice(l,0,e.splice(t,1)[0]),r-=1}return e}function F({selected:e,onChange:t,rows:n,showTips:i}){let[o,s]=(0,r.useState)(null),[a,d]=(0,r.useState)("blue");return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(c.Z,{disabled:!e.length,onClick:e=>{s(e.currentTarget)},children:"Change color of selected items"}),(0,l.jsxs)(c.Z,{onClick:()=>{t(H([...n],e))},disabled:!e.length,children:[(0,l.jsx)(M.Z,{}),i?"Move selected items up":null]}),(0,l.jsxs)(c.Z,{onClick:()=>{t(O([...n],e))},disabled:!e.length,children:[(0,l.jsx)(y.Z,{}),i?"Move selected items down":null]}),(0,l.jsxs)(c.Z,{onClick:()=>{t(H([...n],e,n.length))},disabled:!e.length,children:[(0,l.jsx)(N.Z,{}),i?"Move selected items to top":null]}),(0,l.jsxs)(c.Z,{onClick:()=>{t(O([...n],e,n.length))},disabled:!e.length,children:[(0,l.jsx)(E.Z,{}),i?"Move selected items to bottom":null]}),(0,l.jsx)(v.ColorPopover,{anchorEl:o,color:a,onChange:l=>{for(let t of(d(l),e)){let e=n.find(e=>e.name===t);e&&(e.color=l)}t([...n])},onClose:()=>{s(null)}})]})}var G=function({rows:e,onChange:t,showTips:n}){let[i,o]=(0,r.useState)([]);return(0,l.jsxs)("div",{children:[(0,l.jsx)(F,{selected:i,rows:e,showTips:n,onChange:t}),e.length?(0,l.jsx)(Z,{rows:e,onChange:t,setSelected:o}):(0,l.jsx)("div",{children:"No rows"})]})};let L=(0,h.makeStyles)()({content:{minWidth:800},fr:{float:"right",display:"flex",gap:8},textAreaFont:{fontFamily:"Courier New"}});function R({model:e,handleClose:t}){let{classes:n}=L(),{sources:i}=e,[h,u]=(0,r.useState)(!1),[m,p]=(0,r.useState)(i||[]),[x,g]=(0,s.useLocalStorage)("multivariant-showTips",!1);return(0,l.jsx)(o(),{open:!0,onClose:t,maxWidth:"xl",title:"Multi-sample variant display - Color/arrangement editor",children:h?(0,l.jsx)(f,{currLayout:m,onClose:e=>{e&&p(e),u(!1)}}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(a.Z,{className:n.content,children:[(0,l.jsxs)("div",{className:n.fr,children:[(0,l.jsx)(c.Z,{variant:"contained",onClick:()=>{g(!x)},children:x?"Hide tips":"Show tips"}),(0,l.jsx)(c.Z,{color:"secondary",variant:"contained",onClick:()=>{u(!h)},children:"Show Bulk row editor"})]}),x?(0,l.jsx)(j,{}):null,(0,l.jsx)("br",{}),(0,l.jsx)(b,{currLayout:m,setCurrLayout:p}),(0,l.jsx)(G,{rows:m,onChange:p,showTips:x})]}),(0,l.jsxs)(d.Z,{children:[(0,l.jsx)(c.Z,{variant:"contained",type:"submit",color:"inherit",onClick:()=>{e.clearLayout(),p(e.sources||[])},children:"Clear custom settings"}),(0,l.jsx)(c.Z,{variant:"contained",color:"secondary",onClick:()=>{t(),p([...e.sources||[]])},children:"Cancel"}),(0,l.jsx)(c.Z,{variant:"contained",color:"primary",type:"submit",onClick:()=>{e.setLayout(m),t()},children:"Submit"})]})]})})}},40241:function(e,t,n){function l(e){let t=0;for(let n=0;n<e.length;n++)t+=e.charCodeAt(n);return r(10*t)}function r(e){return`hsl(${e%255}, 50%, 50%)`}n.d(t,{Qm:function(){return r},p:function(){return l}})}}]);