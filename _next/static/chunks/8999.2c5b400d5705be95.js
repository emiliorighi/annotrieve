"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8999],{68999:function(e,t,a){a.r(t),a.d(t,{default:function(){return l}});var n=a(19814),i=a(50611),s=a(77207),r=a(42382),o=a(61795),c=a(52427),u=a(80883);class l extends s.BaseFeatureDataAdapter{async configurePre(e){let t=this.getConf("indexType"),a=this.getConf("vcfGzLocationMap")[e],s=this.getConf("indexLocationMap")[e]||{uri:`${a.uri}.${t.toLowerCase()}`},r=(0,o.openLocation)(a,this.pluginManager),c="CSI"===t,u=new n.pC({filehandle:r,csiFilehandle:c?(0,o.openLocation)(s,this.pluginManager):void 0,tbiFilehandle:c?void 0:(0,o.openLocation)(s,this.pluginManager),chunkCacheSize:52428800});return{vcf:u,parser:new i.Z({header:await u.getHeader()})}}async configure(e,t){let{statusCallback:a=()=>{}}=t||{};return(0,r.updateStatus)("Downloading index",a,()=>this.configurePre(e))}async getRefNames(){return Object.keys(this.getConf("vcfGzLocationMap"))}getFeatures(e,t={}){return(0,c.ObservableCreate)(async a=>{let{refName:n,start:i,end:s}=e,{statusCallback:o=()=>{}}=t,{vcf:c,parser:l}=await this.configure(e.refName,t);await (0,r.updateStatus)("Downloading variants",o,()=>c.getLines(n,i,s,{lineCallback:(e,t)=>{a.next(new u.Z({variant:l.parseLine(e),parser:l,id:`${this.id}-vcf-${t}`}))},...t})),a.complete()},t.stopToken)}async getSources(){let e=this.getConf("samplesTsvLocation"),t=Object.keys(this.getConf("vcfGzLocationMap"))[0];if(""===e.uri||"/path/to/samples.tsv"===e.uri){let{parser:e}=await this.configure(t);return e.samples.map(e=>({name:e}))}{let a=(await (0,r.fetchAndMaybeUnzipText)((0,o.openLocation)(e,this.pluginManager))).split(/\n|\r\n|\r/),n=a[0].split("	"),{parser:i}=await this.configure(t),s=new Set(i.samples);return a.slice(1).map(e=>{let t=e.split("	");return{name:t[0],...Object.fromEntries(t.slice(1).map((e,t)=>[n[t+1],e]))}}).filter(e=>s.has(e.name))}}}}}]);