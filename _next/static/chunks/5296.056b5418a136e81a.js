"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5296],{25296:function(t,e,n){n.d(e,{makeImageData:function(){return s}});var l=n(42382),i=n(47368),f=n(41977),o=n.n(f),r=n(25648),a=n(72667),c=n(69558),u=n(11347);async function s(t,e){let{scrollTop:n,minorAlleleFrequencyFilter:f,sources:s,rowHeight:d,features:h,regions:m,bpPerPx:p,renderingMode:g,stopToken:k,lengthCutoffFilter:v,referenceDrawingMode:x}=e,S=m[0],{statusCallback:b=()=>{}}=e;(0,i.checkStopToken)(k);let T=await (0,l.updateStatus)("Calculating stats",b,()=>(0,u.qS)({stopToken:k,features:h.values(),minorAlleleFrequencyFilter:f,lengthCutoffFilter:v}));(0,i.checkStopToken)(k);let w=new(o());return await (0,l.updateStatus)("Drawing variants",b,()=>{(0,l.forEachWithStopTokenCheck)(T,k,({mostFrequentAlt:e,feature:i})=>{let[f,o]=(0,l.featureSpanPx)(i,S,p),u=i.get("end")-i.get("start"),h=Math.max(Math.round(o-f),2),m=i.get("genotypes"),k=-n,v=s.length;if("phased"===g)for(let e=0;e<v;e++){let{name:n,HP:l}=s[e],o=m[n],a=Math.floor(f),u=Math.max(d,1);if(o){if(o.includes("|")){let e=o.split("|");(0,c.r)(e,t,a,k,h,u,l,void 0,"draw"===x)&&w.insert({minX:a,maxX:a+h,minY:k,maxY:k+u,genotype:o,name:n,featureId:i.id()})}else t.fillStyle="black",t.fillRect(a-r.f2,k-r.f2,h+r.f2,u+r.f2)}k+=d}else{let n={};for(let l=0;l<v;l++){let{name:o}=s[l],r=m[o],c=Math.floor(f),p=Math.max(d,1);if(r){let l=n[r];if(void 0===l){let t=0,i=0,f=0,o=0,c=r.split(/[/|]/),u=c.length;for(let n=0;n<u;n++){let l=c[n];l===e?t++:"0"===l?o++:"."===l?i++:f++}l=(0,a.I)(o,t,f,i,u,"draw"===x),n[r]=l}l&&((0,a.G)(l,t,c,k,h,p,i.get("type"),i.get("strand"),u>5?.75:1),w.insert({minX:c,maxX:c+h,minY:k,maxY:k+p,genotype:r,name:o,featureId:i.id()}))}k+=d}}})}),{rbush:w.toJSON(),featureGenotypeMap:Object.fromEntries(T.map(({feature:t})=>[t.id(),{alt:t.get("ALT"),ref:t.get("REF"),name:t.get("name"),description:t.get("description"),length:t.get("end")-t.get("start")}]))}}},25648:function(t,e,n){n.d(e,{f2:function(){return l}});let l=.3},72667:function(t,e,n){n.d(e,{G:function(){return o},I:function(){return f}});var l=n(22216),i=n(25648);function f(t,e,n,i,f,o=!0){if(t===f)return o?"#ccc":"";{let t;if(e&&(t=(0,l.colord)(`hsl(200,50%,${80-e/f*50}%)`)),n){let e=`hsla(0,100%,20%,${n/f})`;t=t?t.mix(e):(0,l.colord)(e)}if(i){let e=`hsl(50,50%,50%,${i/f})`;t=t?t.mix(e):(0,l.colord)(e)}return(null==t?void 0:t.toHex())||"black"}}function o(t,e,n,f,o,r,a="",c,u=1){e.fillStyle=1!==u?(0,l.colord)(t).alpha(u).toHex():t,"inversion"===a?(1===c?(e.beginPath(),e.moveTo(n-i.f2,f-i.f2),e.lineTo(n-i.f2,f+r+i.f2),e.lineTo(n+o+i.f2,f+r/2)):(e.beginPath(),e.moveTo(n+o+i.f2,f-i.f2),e.lineTo(n+o+i.f2,f+r+i.f2),e.lineTo(n-i.f2,f+r/2)),e.closePath(),e.fill()):e.fillRect(n-i.f2,f-i.f2,o+i.f2,r+i.f2)}},69558:function(t,e,n){n.d(e,{r:function(){return r}});var l=n(95),i=n(22216),f=n(25648),o=n(40241);function r(t,e,n,r,a,c,u,s,d=!0,h=1){let m=void 0!==s?function(t,e,n,l=!0){return+t[e]?(0,o.Qm)(+n)||"black":l?"#ccc":void 0}(t,u,s,d):function(t,e,n=!0){let i=+t[e];return i?l.set1[i-1]||"black":n?"#ccc":void 0}(t,u,d);return m&&(e.fillStyle=1!==h?(0,i.colord)(m).alpha(h).toHex():m,e.fillRect(n-f.f2,r-f.f2,a+f.f2,c+f.f2)),m}},40241:function(t,e,n){function l(t){let e=0;for(let n=0;n<t.length;n++)e+=t.charCodeAt(n);return i(10*e)}function i(t){return`hsl(${t%255}, 50%, 50%)`}n.d(e,{Qm:function(){return i},p:function(){return l}})}}]);