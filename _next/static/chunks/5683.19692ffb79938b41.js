"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5683],{85683:function(e,t,a){a.r(t),a.d(t,{default:function(){return et}});var r=a(57437),n=a(2265),s=a(42382),l=a(22347),o=a(73088),i=a(95280),c=a(25761),d=a(47198),p=a(90658),u=a(64703),h=a(42386),m=a(83310),x=a(11814),f=a(77639),g=a(3905),k=a(98833),v=a(63168),j=a(31835),b=a(37926),y=a(793);let Z=(0,g.makeStyles)()(e=>({spacing:{marginBottom:e.spacing(3)}}));function S({trackAdapter:e,trackType:t}){let{classes:a}=Z(),{type:n,subadapter:s}=e;return"SNPCoverageAdapter"===n?(0,r.jsxs)(p.Z,{className:a.spacing,children:["Selected ",(0,r.jsx)("code",{children:t}),". Using adapter ",(0,r.jsx)("code",{children:n})," with subadapter ",(0,r.jsx)("code",{children:null==s?void 0:s.type}),". Please enter a track name and, if necessary, update the track type."]}):(0,r.jsxs)(p.Z,{className:a.spacing,children:["Using adapter ",(0,r.jsx)("code",{children:n})," and guessing track type"," ",(0,r.jsx)("code",{children:t}),". Please enter a track name and, if necessary, update the track type."]})}var w=a(25470);let C=(0,d.observer)(({model:e})=>{let{trackAdapter:t}=e,{pluginManager:a}=(0,s.getEnv)(e);return(0,r.jsx)(j.Z,{value:(null==t?void 0:t.type)!=="UNKNOWN"?null==t?void 0:t.type:"",label:"Adapter type",variant:"outlined",select:!0,fullWidth:!0,onChange:t=>{e.setAdapterHint(t.target.value)},slotProps:{select:{SelectDisplayProps:{"data-testid":"adapterTypeSelect"}}},children:Object.entries(function(e){var t;let a={};for(let r of e){let e=(null===(t=r.adapterMetadata)||void 0===t?void 0:t.category)||"Default";a[e]||(a[e]=[]),a[e].push(r)}return a}(a.getAdapterElements().filter(e=>{var t;return!(null===(t=e.adapterMetadata)||void 0===t?void 0:t.hiddenFromGUI)}))).map(([e,t])=>[(0,r.jsx)(w.Z,{children:e},e),t.map(e=>(0,r.jsx)(i.Z,{value:e.name,children:e.displayName},e.name))])})}),N=(0,g.makeStyles)()(e=>({spacing:{marginBottom:e.spacing(3)}}));function T({model:e}){let{classes:t}=N();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(p.Z,{className:t.spacing,children:["JBrowse was not able to guess the adapter type for this data, but it may be in the list below. If not, you can"," ",(0,r.jsx)(k.ExternalLink,{href:"https://github.com/GMOD/jbrowse-components/releases",children:"check for new releases"})," ","of JBrowse to see if they support this data type or"," ",(0,r.jsx)(k.ExternalLink,{href:"https://github.com/GMOD/jbrowse-components/issues/new",children:"file an issue"})," ","and add a feature request for this data type."]}),(0,r.jsx)(C,{model:e})]})}var E=a(89470),P=a(20599),D=a(88654),A=a(9391),I=a(41563),M=a(61002),O=a(61888),B=a(84874),z=a(1214),W=a(9685);let F=(0,g.makeStyles)()(e=>({paper:{display:"flex",flexDirection:"column",padding:e.spacing(1)},card:{marginTop:e.spacing(1)}})),R=(0,d.observer)(function({model:e}){let{classes:t}=F(),[a,s]=(0,n.useState)(""),[l,o]=(0,n.useState)(""),[i,c]=(0,n.useState)(["Name","ID"]),[d,p]=(0,n.useState)(["CDS","exon"]),u=[{label:"Indexing attributes",values:i},{label:"Feature types to exclude",values:d}];return(0,n.useEffect)(()=>{e.setTextIndexingConf({attributes:i,exclude:d})},[e,i,d]),(0,r.jsxs)(D.Z,{className:t.paper,children:[(0,r.jsx)(A.Z,{children:"Indexing configuration"}),u.map((e,n)=>(0,r.jsx)(I.Z,{raised:!0,className:t.card,children:(0,r.jsxs)(M.Z,{children:[(0,r.jsx)(A.Z,{children:e.label}),(0,r.jsxs)(O.Z,{disablePadding:!0,children:[e.values.map((t,a)=>(0,r.jsx)(B.ZP,{disableGutters:!0,children:(0,r.jsx)(j.Z,{value:t,slotProps:{input:{endAdornment:(0,r.jsx)(z.Z,{position:"end",children:(0,r.jsx)(W.Z,{onClick:()=>{let t=e.values.filter((e,t)=>t!==a);0===n?c(t):p(t)},children:(0,r.jsx)(P.Z,{})})})}}})},`${t}-${a}`)),(0,r.jsx)(B.ZP,{disableGutters:!0,children:(0,r.jsx)(j.Z,{value:0===n?a:l,placeholder:"add new",onChange:e=>{0===n?s(e.target.value):o(e.target.value)},slotProps:{input:{endAdornment:(0,r.jsx)(z.Z,{position:"end",children:(0,r.jsx)(W.Z,{onClick:()=>{0===n?(c([...i,a]),s("")):(p([...d,l]),o(""))},disabled:0===n?""===a:""===l,"data-testid":"stringArrayAdd-Feat",children:(0,r.jsx)(E.Z,{})})})}}})})]})]})},e.label))]})}),L=(0,d.observer)(function({model:e}){let{pluginManager:t}=(0,s.getEnv)(e),{trackType:a}=e,n=t.getTrackElements();return(0,r.jsx)(j.Z,{value:a,variant:"outlined",label:"Track type",select:!0,fullWidth:!0,onChange:t=>{e.setTrackType(t.target.value)},slotProps:{select:{SelectDisplayProps:{"data-testid":"trackTypeSelect"}}},children:n.map(({name:e,displayName:t})=>(0,r.jsx)(i.Z,{value:e,children:t},e))})}),J=(0,g.makeStyles)()(e=>({spacing:{marginBottom:e.spacing(3)}}));function U(){let{classes:e}=J();return(0,r.jsxs)(p.Z,{className:e.spacing,children:["This version of JBrowse cannot display data of this type. It is possible, however, that there is a newer version that can display them. You can"," ",(0,r.jsx)(k.ExternalLink,{href:"https://github.com/GMOD/jbrowse-components/releases",children:"check for new releases"})," ","of JBrowse or"," ",(0,r.jsx)(k.ExternalLink,{href:"https://github.com/GMOD/jbrowse-components/issues/new",children:"file an issue"})," ","and add a feature request for this data type."]})}let G=(0,g.makeStyles)()(e=>({spacing:{marginBottom:e.spacing(3)}})),H=(0,d.observer)(function({model:e}){let{classes:t}=G(),[a,o]=(0,n.useState)(!0),i=(0,s.getSession)(e),{trackName:c,unsupported:d,trackAdapter:u,trackType:h,warningMessage:m,adapterHint:x}=e;if((0,n.useEffect)(()=>{""===x&&u&&e.setAdapterHint(u.type)},[x,u,null==u?void 0:u.type,e]),d)return(0,r.jsx)(U,{});if((null==u?void 0:u.type)===v.UNKNOWN)return(0,r.jsx)(T,{model:e});if(!(null==u?void 0:u.type))return(0,r.jsx)(p.Z,{children:"Could not recognize this data type."});{let d=(0,s.isSupportedIndexingAdapter)(u.type),{pluginManager:x}=(0,s.getEnv)(e),f=x.evaluateExtensionPoint("Core-addTrackComponent",({model:e})=>(0,r.jsx)(k.AssemblySelector,{session:i,helperText:"Select assembly to add track to",selected:e.assembly,onChange:t=>{e.setAssembly(t)},TextFieldProps:{fullWidth:!0,SelectProps:{SelectDisplayProps:{"data-testid":"assemblyNameSelect"}}}}),{model:e});return(0,r.jsxs)("div",{children:[(0,r.jsx)(S,{trackAdapter:u,trackType:h}),m?(0,r.jsx)(p.Z,{color:"warning",children:m}):null,(0,r.jsx)(j.Z,{className:t.spacing,label:"trackName",helperText:"A name for this track",fullWidth:!0,value:c,onChange:t=>{e.setTrackName(t.target.value)},slotProps:{htmlInput:{"data-testid":"trackNameInput"}}}),(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:10},children:[(0,r.jsx)(C,{model:e}),(0,r.jsx)(L,{model:e}),(0,r.jsx)(n.Suspense,{fallback:null,children:(0,r.jsx)(f,{model:e})})]}),s.isElectron&&d&&(0,r.jsx)(l.Z,{children:(0,r.jsx)(b.Z,{label:"Index track for text searching?",control:(0,r.jsx)(y.Z,{checked:a,onChange:t=>{o(t.target.checked),e.setTextIndexTrack(t.target.checked)}})})}),s.isElectron&&a&&d?(0,r.jsx)(R,{model:e}):null]})}});var $=a(91904);let V=(0,g.makeStyles)()(e=>({paper:{padding:e.spacing(2)},spacer:{height:e.spacing(8)}})),_=(0,d.observer)(function({model:e}){let{classes:t}=V(),a=(0,$.getRoot)(e);return(0,r.jsxs)(D.Z,{className:t.paper,children:[(0,r.jsx)(k.FileSelector,{name:"Main file",description:"",location:e.trackData,setLocation:e.setTrackData,setName:e.setTrackName,rootModel:a}),(0,r.jsx)("div",{className:t.spacer}),(0,r.jsx)(k.FileSelector,{name:"Index file",description:"(Optional) The URL of the index file is automatically inferred from the URL of the main file if it is not supplied.",location:e.indexTrackData,setLocation:e.setIndexTrackData,setName:e.setTrackName,rootModel:a})]})}),q=(0,g.makeStyles)()(e=>({root:{marginTop:e.spacing(1)},stepper:{backgroundColor:e.palette.background.default},button:{marginRight:e.spacing(1)},actionsContainer:{marginTop:e.spacing(10),marginBottom:e.spacing(2)},alertContainer:{padding:`${e.spacing(2)}px 0px ${e.spacing(2)}px 0px`}})),K=["Enter track data","Confirm track type"],Y=(0,d.observer)(function({model:e}){let[t,a]=(0,n.useState)(0),{classes:l}=q(),{assembly:o,trackAdapter:i,trackData:c,trackName:d,trackType:g}=e;return(0,r.jsx)("div",{className:l.root,children:(0,r.jsx)(u.Z,{className:l.stepper,activeStep:t,orientation:"vertical",children:K.map((n,u)=>(0,r.jsxs)(h.Z,{children:[(0,r.jsx)(m.Z,{children:n}),(0,r.jsxs)(x.Z,{children:[function(t){switch(t){case 0:return(0,r.jsx)(_,{model:e});case 1:return(0,r.jsx)(H,{model:e});default:return(0,r.jsx)(p.Z,{children:"Unknown step"})}}(u),(0,r.jsxs)("div",{className:l.actionsContainer,children:[(0,r.jsx)(f.Z,{disabled:0===t,className:l.button,onClick:()=>{a(t-1)},"data-testid":"addTrackBackButton",children:"Back"}),(0,r.jsx)(f.Z,{disabled:function(){switch(t){case 0:return!c;case 1:return!(d&&g&&(null==i?void 0:i.type)&&o);default:return!0}}(),variant:"contained",color:"primary",onClick:()=>{if(t!==K.length-1)a(t+1);else try{!function({model:e}){var t;let{textIndexTrack:a,trackAdapter:r,view:n}=e,l=(0,s.getSession)(e),o=e.getTrackConfig(Date.now());if((0,s.isSessionWithAddTracks)(l)){if(o&&r){let{trackId:i}=o;l.addTrackConf(o),null===(t=null==n?void 0:n.showTrack)||void 0===t||t.call(n,i),s.isElectron&&a&&(0,s.isSupportedIndexingAdapter)(r.type)&&function({trackId:e,model:t}){let{textIndexingConf:a,trackName:r,assembly:n}=t,{jobsManager:s}=(0,$.getRoot)(t),l=`${r}-index`;s.queueJob({indexingParams:{...a||{attributes:["Name","ID"],exclude:["CDS","exon"]},assemblies:[n],tracks:[e],indexType:"perTrack",name:l,timestamp:new Date().toISOString()},name:l,cancelCallback:()=>s.abortJob()})}({model:e,trackId:i}),e.clearData(),(0,s.isSessionModelWithWidgets)(l)&&l.hideWidget(e)}else throw Error("Failed to add track.\nThe configuration of this file is not currently supported.")}else throw Error("Can't add tracks to this session")}({model:e})}catch(t){(0,s.getSession)(e).notifyError(`${t}`,t)}},className:l.button,"data-testid":"addTrackNextButton",children:t===K.length-1?"Add":"Next"})]})]})]},n))})})});var Q=a(74679);let X=(0,g.makeStyles)()({textbox:{width:"100%"},submit:{marginTop:25,marginBottom:100,display:"block"}}),ee=(0,d.observer)(function({model:e}){let{classes:t}=X(),[a,l]=(0,n.useState)(""),[o,i]=(0,n.useState)();return(0,r.jsxs)("div",{children:[o?(0,r.jsx)(k.ErrorMessage,{error:o}):null,(0,r.jsx)(j.Z,{multiline:!0,rows:10,value:a,placeholder:"Paste track config or array of track configs in JSON format",variant:"outlined",className:t.textbox,onChange:e=>{l(e.target.value)}}),(0,r.jsx)(f.Z,{variant:"contained",className:t.submit,onClick:()=>{try{i(void 0);let t=(0,s.getSession)(e),r=JSON.parse(a),n=Array.isArray(r)?r:[r];(0,s.isSessionWithAddTracks)(t)&&(0,s.isSessionModelWithWidgets)(t)&&((0,Q.transaction)(()=>{for(let e of n)t.addTrackConf(e);for(let t of n)e.view.showTrack(t.trackId);e.clearData()}),t.hideWidget(e))}catch(e){console.error(e),i(e)}},children:"Submit"})]})});var et=(0,d.observer)(function({model:e}){let[t,a]=(0,n.useState)("Default add track workflow"),d={"Default add track workflow":Y,"Add track JSON":ee,...Object.fromEntries((0,s.getEnv)(e).pluginManager.getAddTrackWorkflowElements().map(e=>[e.name,e.ReactComponent]))},p=d[t]?t:"Default add track workflow",u=d[p];return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(l.Z,{children:[(0,r.jsx)(o.Z,{value:p,onChange:e=>{a(e.target.value)},children:Object.keys(d).map(e=>(0,r.jsx)(i.Z,{value:e,children:e},e))}),(0,r.jsx)(c.Z,{children:"Type of add track workflow"})]}),(0,r.jsx)(n.Suspense,{fallback:null,children:(0,r.jsx)(u,{model:e})})]})})},793:function(e,t,a){a.d(t,{Z:function(){return E}});var r=a(2265),n=a(61994),s=a(7609),l=a(88429),o=a(64059),i=a(57437),c=(0,o.Z)((0,i.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),d=(0,o.Z)((0,i.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),p=(0,o.Z)((0,i.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox"),u=a(51661),h=a(45194),m=a(15245),x=a(95916);function f(e){return(0,x.ZP)("MuiCheckbox",e)}let g=(0,m.Z)("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]);var k=a(1589),v=a(1190),j=a(75913),b=a(42318),y=a(39965),Z=a(69921);let S=e=>{let{classes:t,indeterminate:a,color:r,size:n}=e,l={root:["root",a&&"indeterminate","color".concat((0,u.Z)(r)),"size".concat((0,u.Z)(n))]},o=(0,s.Z)(l,f,t);return{...t,...o}},w=(0,k.ZP)(l.Z,{shouldForwardProp:e=>(0,h.Z)(e)||"classes"===e,name:"MuiCheckbox",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:a}=e;return[t.root,a.indeterminate&&t.indeterminate,t["size".concat((0,u.Z)(a.size))],"default"!==a.color&&t["color".concat((0,u.Z)(a.color))]]}})((0,v.Z)(e=>{let{theme:t}=e;return{color:(t.vars||t).palette.text.secondary,variants:[{props:{color:"default",disableRipple:!1},style:{"&:hover":{backgroundColor:t.alpha((t.vars||t).palette.action.active,(t.vars||t).palette.action.hoverOpacity)}}},...Object.entries(t.palette).filter((0,j.Z)()).map(e=>{let[a]=e;return{props:{color:a,disableRipple:!1},style:{"&:hover":{backgroundColor:t.alpha((t.vars||t).palette[a].main,(t.vars||t).palette.action.hoverOpacity)}}}}),...Object.entries(t.palette).filter((0,j.Z)()).map(e=>{let[a]=e;return{props:{color:a},style:{["&.".concat(g.checked,", &.").concat(g.indeterminate)]:{color:(t.vars||t).palette[a].main},["&.".concat(g.disabled)]:{color:(t.vars||t).palette.action.disabled}}}}),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}]}})),C=(0,i.jsx)(d,{}),N=(0,i.jsx)(c,{}),T=(0,i.jsx)(p,{});var E=r.forwardRef(function(e,t){var a,s,l;let o=(0,b.i)({props:e,name:"MuiCheckbox"}),{checkedIcon:c=C,color:d="primary",icon:p=N,indeterminate:u=!1,indeterminateIcon:h=T,inputProps:m,size:x="medium",disableRipple:f=!1,className:g,slots:k={},slotProps:v={},...j}=o,E=u?h:p,P=u?h:c,D={...o,disableRipple:f,color:d,indeterminate:u,size:x},A=S(D),I=null!==(a=v.input)&&void 0!==a?a:m,[M,O]=(0,Z.Z)("root",{ref:t,elementType:w,className:(0,n.Z)(A.root,g),shouldForwardComponentProp:!0,externalForwardedProps:{slots:k,slotProps:v,...j},ownerState:D,additionalProps:{type:"checkbox",icon:r.cloneElement(E,{fontSize:null!==(s=E.props.fontSize)&&void 0!==s?s:x}),checkedIcon:r.cloneElement(P,{fontSize:null!==(l=P.props.fontSize)&&void 0!==l?l:x}),disableRipple:f,slots:k,slotProps:{input:(0,y.Z)("function"==typeof I?I(D):I,{"data-indeterminate":u})}}});return(0,i.jsx)(M,{...O,classes:A})})}}]);